@using AMR.Models;
@using AMR.Core.Extensions;
@using System.Text;
@model AdminViewModel


@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_LayoutMasterPage.cshtml";
}
<script src="~/Content/js/validator.js"></script>

<script type="text/javascript">
    $(document).ready(function () {
    $("#IndexRemoveClass").addClass("active");

        $("#FaciltySetupRemoveClass").removeClass("active");
        $("#cmbStates").val("-1");
        $("#cmbCountryopt1").val("-1");
        $("#txtHphone").val("");
        $("#txtEmail").val("");
        $("#txtZipCode").val("");
        $("#txtCity").val("");
        $("#txtAdd").val("");
        $("#txtdob").val("");
        $("#txLname").val("");
        $("#txtFname").val("");
        $("#txtid").val("");
        $("#txtFacility").val("");
        $("#txtFacilityId").val("0");
        $("#cmbPartner").val("-1");
        document.getElementById("RenewAccount").disabled = true;
        document.getElementById("UpdateRenewelDate").disabled = true;
        document.getElementById("PrintWelcomeScreen").disabled = true;
        document.getElementById("FamilyLinkId").disabled = true;

        document.getElementById("UpgradeDowngrade").disabled = true;

       // $('#UpgradeDowngrade').hide();
    });
   $(document).ready(function () {
       var page = 0;
       $("#pageindex").change(function () {
           ShowLoaderBig();
           page = $("#pageindex option:selected").val(); //alert(value);
          // ShowLoader();
           var statusvalue = $("#cmbStates option:selected").val();
           var Countryvalue = $("#cmbCountryopt1 option:selected").val();
           var FacilityId = $("#txtFacilityId").val();
           if (FacilityId == "0") {
               FacilityId = null;
           }
           if (Countryvalue == "-1")
           {
               Countryvalue = null;

           }
           var Partner = $("#cmbPartner option:selected").val();
           if (Partner == "-1")
           {
               Partner = null
           }

           if (statusvalue == "-1") {
               statusvalue = null;
           }

           ///  alert("value of status is " + statusvalue);
           var requestData = {
               PatientId: $('#txtid').val(),
               FirstName: $('#txtFname').val(),
               LastName: $('#txLname').val(),
               Address1: $('#txtAdd').val(),
               City: $('#txtCity').val(),
               State: statusvalue,
               Zip: $('#txtZipCode').val(),
               CountryCode: Countryvalue,
               HomePhone: $('#txtHphone').val(),
               EMail: $('#txtEmail').val(),
               dob: $('#txtdob').val(),
               EMRSystemId: Partner,
               PageNumber: page,
               PageSize: 20,
               TotalRecords: 0,
               FacilityId:FacilityId,
           };
           $.ajax({
               type: 'POST',
               url: 'Admin/SearchPatients',
               data: JSON.stringify(requestData),
               dataType: 'json',
               contentType: 'application/json; charset=utf-8',
               success: function (data) {
                   // if success
                   // alert("Success : " + data);
                   // var myCookie = getCookie(".Admin");
                   //alert(myCookie); if (data.error == "The access id was deleted") {
                   if (data.error == "The access id was deleted") {
                       alert("The access id was deleted");
                       $("#Search-Patient").html(data.html);
                       //HideLoader();
                       HideLoaderBig();

                   }
                   else {
                       var divident = 0;
                       var remainder = 0;
                       $("#Search-Patient").html(data.html);
                       if (data.count > 20) {
                           divident = data.count / 20;
                           remainder = data.count % 20;
                           //alert(divident);
                           $("#pageindex").text("");
                           $("#pageindextop").text("");

                           if (remainder != 0) {
                               divident = divident + 1;
                           }

                           $("#Paggination").css("display", "block");
                           $("#Pagginationtop").css("display", "block");

                           for (var i = 1; i <= divident; i++) {
                               $("#pageindex").append("<option value=\"" + (i - 1) + "\">" + i + "</option>");
                               $("#pageindextop").append("<option value=\"" + (i - 1) + "\">" + i + "</option>");

                           }
                       }
                       else {
                           $("#Paggination").css("display", "none");
                           $("#Pagginationtop").css("display", "none");

                           $("#pageindex").text("");
                           $("#pageindextop").text("");


                       }
                       $("#pageindex").val(page);
                       $("#pageindextop").val(page);

                       HideLoaderBig();
                      // HideLoader();
                   }
               },
               error: function (xhr, ajaxOptions, thrownError) {
                   //if error
                   var myCookie = getCookie(".Admin");

                   if (myCookie == null) {
                       // do cookie doesn't exist stuff;
                       alert('Not logged in. Please log in to continue');
                       window.location = '/Login'
                       //xhr.getResponseHeader('Location');
                   }
                   else {

                       alert('Error : ' + xhr.message);
                   }
                   //alert('Error : ' + xhr.message);
                   // HideLoader();
                   HideLoaderBig();
               },
               complete: function (data) {
                   // if completed
                   HideLoader();

               },
               async: true,
               processData: false
           });
       });
       $("#pageindextop").change(function () {
           ShowLoaderBig();
           page = $("#pageindextop option:selected").val(); //alert(value);
           // ShowLoader();
           var statusvalue = $("#cmbStates option:selected").val();
           var Partner = $("#cmbPartner option:selected").val();
           var Countryvalue = $("#cmbCountryopt1 option:selected").val();
           var FacilityId = $("#txtFacilityId").val();
           if (FacilityId == "0") {
               FacilityId = null;
           }
           if (Countryvalue == "-1") {
               Countryvalue = null;

           }
           if (Partner == "-1") {
               //  alert(Partner);
               Partner = null;
           }
           if (statusvalue == "-1") {
               statusvalue = null;
           }

           ///  alert("value of status is " + statusvalue);
           var requestData = {
               PatientId: $('#txtid').val(),
               FirstName: $('#txtFname').val(),
               LastName: $('#txLname').val(),
               Address1: $('#txtAdd').val(),
               City: $('#txtCity').val(),
               State: statusvalue,
               Zip: $('#txtZipCode').val(),
               CountryCode: Countryvalue,
               HomePhone: $('#txtHphone').val(),
               EMail: $('#txtEmail').val(),
               dob: $('#txtdob').val(),
               EMRSystemId: Partner,
               PageNumber: page,
               PageSize: 20,
               TotalRecords: 0,
               FacilityId:FacilityId,
           };
           $.ajax({
               type: 'POST',
               url: 'Admin/SearchPatients',
               data: JSON.stringify(requestData),
               dataType: 'json',
               contentType: 'application/json; charset=utf-8',
               success: function (data) {
                   // if success
                   // alert("Success : " + data);
                   // var myCookie = getCookie(".Admin");
                   //alert(myCookie); if (data.error == "The access id was deleted") {
                   if (data.error == "The access id was deleted") {
                       alert("The access id was deleted");
                       $("#Search-Patient").html(data.html);
                       //HideLoader();
                       HideLoaderBig();

                   }
                   else {
                       var divident = 0;
                       var remainder = 0;
                       $("#Search-Patient").html(data.html);
                       if (data.count > 20) {
                           divident = data.count / 20;
                           remainder = data.count % 20;
                           //alert(divident);
                           $("#pageindex").text("");
                           $("#pageindextop").text("");
                           if (remainder != 0) {
                               divident = divident + 1;
                           }

                           $("#Paggination").css("display", "block");
                           $("#Pagginationtop").css("display", "block");

                           for (var i = 1; i <= divident; i++) {
                               $("#pageindex").append("<option value=\"" + (i - 1) + "\">" + i + "</option>");
                               $("#pageindextop").append("<option value=\"" + (i - 1) + "\">" + i + "</option>");

                           }
                       }
                       else {
                           $("#Paggination").css("display", "none");
                           $("#Pagginationtop").css("display", "none");

                           $("#pageindex").text("");
                           $("#pageindextop").text("");


                       }
                       $("#pageindex").val(page);
                       $("#pageindextop").val(page);

                       HideLoaderBig();
                       // HideLoader();
                   }
               },
               error: function (xhr, ajaxOptions, thrownError) {
                   //if error
                   var myCookie = getCookie(".Admin");

                   if (myCookie == null) {
                       // do cookie doesn't exist stuff;
                       alert('Not logged in. Please log in to continue');
                       window.location = '/Login'
                       //xhr.getResponseHeader('Location');
                   }
                   else {

                       alert('Error : ' + xhr.message);
                   }
                   //alert('Error : ' + xhr.message);
                   // HideLoader();
                   HideLoaderBig();
               },
               complete: function (data) {
                   // if completed
                   HideLoader();

               },
               async: true,
               processData: false
           });
       });

   });
   $(document).ready(function () {
       var page = 0;

       $("#FacilityindexBottom").change(function () {
           //   ShowLoaderBig();
           $("#loader2").css("display", "Block");
           page = $("#FacilityindexBottom option:selected").val(); //alert(value);
           var FacilityName = $("#searchLocation").val();

           ///  alert("value of status is " + statusvalue);
           var requestData = {
               FacilityName:FacilityName,
               PageNumber: page,
               PageSize: 20,
              
           };
           $.ajax({
               type: 'POST',
               url: 'Admin/SearchFacility',
               data: JSON.stringify(requestData),
               dataType: 'json',
               contentType: 'application/json; charset=utf-8',
               success: function (data) {
                   // if success
                   // alert("Success : " + data);
                   // var myCookie = getCookie(".Admin");
                   //alert(myCookie); if (data.error == "The access id was deleted") {
                   if (data.error == "The access id was deleted") {
                       alert("The access id was deleted");
                       $("#FacilityData").html(data.html);
                       //HideLoader();
                       //     HideLoaderBig();
                       $("#loader2").css("display", "none");


                   }
                   else {

                       var divident = 0;
                       var remainder = 0;
                       //   $("#Search-Patient").html(data.html);
                       $("#FacilityData").html(data.html);
                       if (data.count > 20) {
                           flag = "True";
                           divident = data.count / 20;
                           remainder = data.count % 20;
                           //alert(divident);
                           $("#Facilityindextop").text("");
                           $("#FacilityindexBottom").text("");

                           if (remainder != 0) {
                               divident = divident + 1;
                           }

                           $("#FacilityPagginationBottom").css("display", "block");
                           $("#FacilityPagginationtop").css("display", "block");

                           for (var i = 1; i <= divident; i++) {
                               $("#FacilityindexBottom").append("<option value=\"" + (i - 1) + "\">" + i + "</option>");
                               $("#Facilityindextop").append("<option value=\"" + (i - 1) + "\">" + i + "</option>");

                           }
                       }
                       else {
                           $("#FacilityPagginationBottom").css("display", "none");
                           $("#FacilityPagginationtop").css("display", "none");

                           $("#FacilityindexBottom").text("");
                           $("#Facilityindextop").text("");


                       }
                       $("#FacilityindexBottom").val(page);
                       $("#Facilityindextop").val(page);

                       //   HideLoaderBig();
                       $("#loader2").css("display", "none");

                       // HideLoader();
                   }
               },
               error: function (xhr, ajaxOptions, thrownError) {
                   //if error
                   var myCookie = getCookie(".Admin");

                   if (myCookie == null) {
                       // do cookie doesn't exist stuff;
                       alert('Not logged in. Please log in to continue');
                       window.location = '/Login'
                       //xhr.getResponseHeader('Location');
                   }
                   else {

                       alert('Error : ' + xhr.message);
                   }
                   //alert('Error : ' + xhr.message);
                   // HideLoader();
                   // HideLoaderBig();
                   $("#loader2").css("display", "none");

               },
               complete: function (data) {
                   // if completed
                   //     HideLoader();
                   $("#loader2").css("display", "none");


               },
               async: true,
               processData: false
           });
       });
       $("#Facilityindextop").change(function () {
           //ShowLoader();
           $("#loader2").css("display", "block");

           page = $("#Facilityindextop option:selected").val(); //alert(value);

           var FacilityName = $("#searchLocation").val();
           var requestData = {
               FacilityName: FacilityName,
               PageNumber: page,
               PageSize: 20,

           };
           $.ajax({
               type: 'POST',
               url: 'Admin/SearchFacility',
               data: JSON.stringify(requestData),
               dataType: 'json',
               contentType: 'application/json; charset=utf-8',
               success: function (data) {
                   // if success
                   // alert("Success : " + data);
                   // var myCookie = getCookie(".Admin");
                   //alert(myCookie); if (data.error == "The access id was deleted") {
                   if (data.error == "The access id was deleted") {
                       alert("The access id was deleted");
                       $("#FacilityData").html(data.html);
                       //HideLoader();
                       // HideLoaderBig();
                       $("#loader2").css("display", "none");


                   }
                   else {
                     
                       var divident = 0;
                       var remainder = 0;
                       //   $("#Search-Patient").html(data.html);
                       $("#FacilityData").html(data.html);
                       if (data.count > 20) {
                           flag = "True";
                           divident = data.count / 20;
                           remainder = data.count % 20;
                           //alert(divident);
                           $("#Facilityindextop").text("");
                           $("#FacilityindexBottom").text("");

                           if (remainder != 0) {
                               divident = divident + 1;
                           }

                           $("#FacilityPagginationBottom").css("display", "block");
                           $("#FacilityPagginationtop").css("display", "block");

                           for (var i = 1; i <= divident; i++) {
                               $("#FacilityindexBottom").append("<option value=\"" + (i - 1) + "\">" + i + "</option>");
                               $("#Facilityindextop").append("<option value=\"" + (i - 1) + "\">" + i + "</option>");

                           }
                       }
                       else {
                           $("#FacilityPagginationBottom").css("display", "none");
                           $("#FacilityPagginationtop").css("display", "none");

                           $("#FacilityindexBottom").text("");
                           $("#Facilityindextop").text("");


                       }
                       $("#FacilityindexBottom").val(page);
                       $("#Facilityindextop").val(page);

                       // HideLoaderBig();
                       $("#loader2").css("display", "none");

                       // HideLoader();
                   }
               },
               error: function (xhr, ajaxOptions, thrownError) {
                   //if error
                   var myCookie = getCookie(".Admin");

                   if (myCookie == null) {
                       // do cookie doesn't exist stuff;
                       alert('Not logged in. Please log in to continue');
                       window.location = '/Login'
                       //xhr.getResponseHeader('Location');
                   }
                   else {

                       alert('Error : ' + xhr.message);
                   }
                   //alert('Error : ' + xhr.message);
                   // HideLoader();
                   // HideLoaderBig();
                   $("#loader2").css("display", "none");

               },
               complete: function (data) {
                   // if completed
                   // HideLoader();
                   $("#loader2").css("display", "none");


               },
               async: true,
               processData: false
           });
       });

   });

    function UpgradeDowngrade() {
        ShowLoaderBig();
        try {
            var patientid = $('#lbl-id').text();
            var accounttype = $('#lbl-act-typ').text();
            if (accounttype == 'Standard') {
                account = false;
            }
            else {
                account = true;
            }
           
            var requestData = {
                PatientId: patientid,
               
            PremiumFlag: account
                  

            };

            $.ajax({
                type: 'POST',
                url: 'Admin/UpgradeDowngrade',
                data: JSON.stringify(requestData),
                //dataType: 'json',
                dataType: 'text',
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    // if success
                    // alert("Success : " + data);
                var obj = $.parseJSON(data);
                    
                    if (obj.PremiumFlag == true)
                        $('#lbl-act-typ').text('Standard');
                    else
                        $('#lbl-act-typ').text('Premium');
                    
                    HideLoaderBig();

                },
                error: function (xhr, ajaxOptions, thrownError) {
                    //if error
                    //  alert('Error : ' + xhr.message);
                    var myCookie = getCookie(".Admin");

                    if (myCookie == null) {
                        // do cookie doesn't exist stuff;
                        alert('Not logged in. Please log in to continue');
                        window.location = '/Login'
                        //xhr.getResponseHeader('Location');
                    }
                    else {

                        alert('Error : ' + xhr.message);
                    }
                    HideLoaderBig();
                },
                complete: function (data) {
                    // if completed
                    HideLoaderBig();

                },
                async: true,
                processData: false
            });

        } catch (err) {

            if (err && err !== "") {
                alert(err.message);
                HideLoader();
            }
        }

    }

    $(function () {
        $("#txtdob").datepicker({
            inline: true,
            dateFormat: 'mm/dd/yy',
            changeMonth: true,
            changeYear: true,
            yearRange: "1900:+0"


        });
        $('#show-date-PreferredEnd').click(function () {
            $('#txtdob').datepicker("show");
        });
    })
    function CreateFamilyLinks() {
        $("#ChildPatient-form").dialog("open");
    }

    function RestSecurityQuestion()
    {
        ShowLoaderBig();
        try {
            var patientid = $('#lbl-id').text();
           
            var requestData = {
                PatientId: patientid,

            };

            $.ajax({
                type: 'POST',
                url: 'Admin/GetPatientSecurityInfo',
                data: JSON.stringify(requestData),
                //dataType: 'json',
                dataType: 'text',
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    // if success
                    // alert("Success : " + data);
                    var obj = $.parseJSON(data);

                    //   alert(obj.answe1);
                    if(obj.question1 == "0")
                    {
                        $("#QuestionSelected1").val("1");
                    }else{
                    $("#QuestionSelected1").val(obj.question1);
                    }
                    if (obj.question2 == "0") {
                        $("#QuestionSelected2").val("2");
                    }
                    else { $("#QuestionSelected2").val(obj.question2); }
                    $("#Answer1").val(obj.answer1);
                    $("#Answer2").val(obj.answer2);
                    $("#ResetSecurityQuestion").dialog("open");
                    HideLoaderBig();

                },
                error: function (xhr, ajaxOptions, thrownError) {
                    //if error
                    //  alert('Error : ' + xhr.message);
                    var myCookie = getCookie(".Admin");

                    if (myCookie == null) {
                        // do cookie doesn't exist stuff;
                        alert('Not logged in. Please log in to continue');
                        window.location = '/Login'
                        //xhr.getResponseHeader('Location');
                    }
                    else {

                        alert('Error : ' + xhr.message);
                    }
                    HideLoaderBig();
                },
                complete: function (data) {
                    // if completed
                    HideLoaderBig();

                },
                async: true,
                processData: false
            });

        } catch (err) {

            if (err && err !== "") {
                alert(err.message);
                HideLoader();
            }
        }

      

    }
    function ChangePassword()
    {
        ShowLoaderBig();
        try {
            var patientid = $('#lbl-id').text();

            var requestData = {
                PatientId: patientid,


            };
            $.ajax({
                type: 'POST',
                url: 'Admin/ChangePatientPasswordAdmin',
                data: JSON.stringify(requestData),
                dataType: 'json',
                //dataType: 'text',
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    // if success
                    // alert("Success : " + data);
                   alert(data);

                   // $("#patient-notes").html(data);
                  //  $('#txtPatNote').val('');
                   HideLoaderBig();

                },
                error: function (xhr, ajaxOptions, thrownError) {

                    //alert('Error : ' + xhr.message);
                    var myCookie = getCookie(".Admin");

                    if (myCookie == null) {
                        // do cookie doesn't exist stuff;
                        alert('Not logged in. Please log in to continue');
                        window.location = '/Login'
                        //xhr.getResponseHeader('Location');
                    }
                    else {

                        alert('Error : ' + xhr.message);
                    }

                    HideLoaderBig();
                },
                complete: function (data) {
                    // if completed
                    HideLoaderBig();

                },
                async: true,
                processData: false
            });
        }
        catch (err) {
            if (err && err !== "") {
                alert(err.message);
                HideLoaderBig();
            }
        }
    }
    function ChangeEmail()
    {
        $("#ChangeEmail-form").dialog("open");
        var Email = $('#lbl-email').text();
        $('#changeemail').val(Email);

    }
    function ActivateDeactivatePatient() {
      
        if ($("#Active").text() == "true") {
            $("#rdAct").prop('checked', true);
        }
        else {
            $("#rdDact").prop('checked', true);

        }
        $("#Activate-Decativate-form").dialog("open");
    };
    function clientNotesform() {
        $("#patient-notes").empty();
        ShowLoader1();
        try {
            var patientid = $('#lbl-id').text();
           
            var requestData = {
                PatientId: patientid,

              
            };

            $.ajax({
                type: 'POST',
                url: 'Admin/GetClientNotesData',
                data: JSON.stringify(requestData),
                dataType: 'json',
                //dataType: 'text',
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    // if success
                    // alert("Success : " + data);
                    //alert(data);
                    $("#patient-notes").html(data);
                    $('#txtPatNote').val('');
                    HideLoader1();

                },
                error: function (xhr, ajaxOptions, thrownError) {

                    //alert('Error : ' + xhr.message);
                    var myCookie = getCookie(".Admin");

                    if (myCookie == null) {
                        // do cookie doesn't exist stuff;
                        alert('Not logged in. Please log in to continue');
                        window.location = '/Login'
                        //xhr.getResponseHeader('Location');
                    }
                    else {

                        alert('Error : ' + xhr.message);
                    }
                  
                    HideLoader1();
                },
                complete: function (data) {
                    // if completed
                    HideLoader1();

                },
                async: true,
                processData: false
            });

        } catch (err) {

            if (err && err !== "") {
                alert(err.message);
                HideLoader1();
            }
        }
        $("#clientNotes-form").dialog("open");
    };
    $(function () {

        tips = $(".validateTips");



        $("#clientNotes-form").dialog({
            autoOpen: false,
            show: {
                effect: "blind",
                duration: 1000
            },
            hide: {
                effect: "blind",
                duration: 1000
            },


            width: 650,
            modal: true,
            buttons: {
                //"Save": function () {
                //    ShowLoaderBig();
                //    var bValid = true;

                //    if (bValid) {

                //        var patientid = $('#lbl-id').text();

                //        try {
                //            var requestData = {
                //                PatientId: patientid,
                //                Note: $.trim($('#txtPatNote').val())
                //                //  LastName: $.trim($('#txtdepententName').val())

                //            };


                //            $.ajax({
                //                type: 'POST',
                //                url: 'Admin/ClientNotes',
                //                data: JSON.stringify(requestData),
                //                dataType: 'json',
                //                contentType: 'application/json; charset=utf-8',
                //                success: function (data) {
                //                    // if success

                //                    //  alert("Success : " + data);

                //                    //if (data.message == false) {
                //                    //    alert("The Access Code was not Found");
                //                    //}
                //                    //else
                //                    //{
                //                    //    alert("The Access Code was Found Successfully");
                //                    //}
                //                    var msg = data;
                //                    alert(msg);
                //                    //$("#patient-portlet").html(data.html);
                //                    //$("#tbl-LinkedAccount").fixedHeaderTable();
                //                    HideLoaderBig();
                //                    clearTextBox();

                //                },
                //                error: function (xhr, ajaxOptions, thrownError) {
                //                    //if error

                //                    alert('Error : ' + xhr.message);
                //                    HideLoaderBig();
                //                },
                //                complete: function (data) {
                //                    // if completed
                //                    HideLoaderBig();

                //                },
                //                async: true,
                //                processData: false
                //            });


                //        } catch (err) {

                //            if (err && err !== "") {
                //                alert(err.message);
                //                HideLoaderBig();
                //            }
                //        }
                //        $(this).dialog("close");
                //        ShowLoaderBig();


                //        //                        end ajax
                //    }
                //},
                Close: function () {
                    $(this).dialog("close");
                    clearTextBox();
                }
            },
            close: function () {

            }
        });


        $("#Activate-Decativate-form").dialog({
            autoOpen: false,
            show: {
                effect: "blind",
                duration: 1000
            },
            hide: {
                effect: "blind",
                duration: 1000
            },


            width: 650,
            modal: true,
            buttons: {
                "Save": function () {
                    ShowLoaderBig();
                    var bValid = true;

                    if (bValid) {

                        var patientid = $('#lbl-id').text();
                      
                        try {
                            var requestData = {
                                PatientId: patientid,
                                Activate: $('#rdAct').prop('checked'),
                                Deactivate: $('#rdDact').prop('checked')

                            };
                            var activrd = $('#rdAct').prop('checked');
                           
                            

                            $.ajax({
                                type: 'POST',
                                url: 'Admin/ActivateDecativatePatient',
                                data: JSON.stringify(requestData),
                                dataType: 'json',
                                contentType: 'application/json; charset=utf-8',
                                success: function (data) {
                                    // if success
                                  
                                    if (activrd ==true) {
                                        $("#Active").text("true")
                                    }
                                    else {
                                        $("#Active").text("false")
                                    }
                                    var msg = data;
                                    alert(msg);
                                    HideLoaderBig();
                                    clearTextBox();

                                },
                                error: function (xhr, ajaxOptions, thrownError) {
                                    //if error

                                    //    alert('Error : ' + xhr.message);
                                    var myCookie = getCookie(".Admin");

                                    if (myCookie == null) {
                                        // do cookie doesn't exist stuff;
                                        alert('Not logged in. Please log in to continue');
                                        window.location = '/Login'
                                        //xhr.getResponseHeader('Location');
                                    }
                                    else {

                                        alert('Error : ' + xhr.message);
                                    }
                                    HideLoaderBig();
                                },
                                complete: function (data) {
                                    // if completed
                                    HideLoaderBig();

                                },
                                async: true,
                                processData: false
                            });


                        } catch (err) {

                            if (err && err !== "") {
                                alert(err.message);
                                HideLoaderBig();
                            }
                        }
                        $(this).dialog("close");
                        ShowLoaderBig();


                        //                        end ajax
                    }
                },
                Close: function () {
                    $(this).dialog("close");
                    clearTextBox();
                }
            },
            close: function () {

            }
        });

        $("#ChildPatient-form").dialog({
            autoOpen: false,
            show: {
                effect: "blind",
                duration: 1000
            },
            hide: {
                effect: "blind",
                duration: 1000
            },


            width: 650,
            modal: true,
            buttons: {
                "Save": function () {
                    ShowLoaderBig();
                    var bValid = true;

                    if (bValid) {

                        var patientid = $('#lbl-id').text();

                        try {
                            var requestData = {
                                PatientId: patientid,
                                PatientId_linked: $.trim($('#txtchildcode').val())
                                //  LastName: $.trim($('#txtdepententName').val())

                            };


                            $.ajax({
                                type: 'POST',
                                url: 'Admin/AdminLinkedPatientId',
                                data: JSON.stringify(requestData),
                                dataType: 'json',
                                contentType: 'application/json; charset=utf-8',
                                success: function (data) {

                                    var msg = data.msg;
                                    alert(msg);
                                    //$("#patient-portlet").html(data.html);
                                    //$("#tbl-LinkedAccount").fixedHeaderTable();
                                    HideLoaderBig();
                                    clearTextBox();

                                },
                                error: function (xhr, ajaxOptions, thrownError) {
                                    //if error

                                    //      alert('Error : ' + xhr.message);
                                    var myCookie = getCookie(".Admin");

                                    if (myCookie == null) {
                                        // do cookie doesn't exist stuff;
                                        alert('Not logged in. Please log in to continue');
                                        window.location = '/Login'
                                        //xhr.getResponseHeader('Location');
                                    }
                                    else {

                                        alert('Error : ' + xhr.message);
                                    }
                                   
                                    HideLoaderBig();
                                },
                                complete: function (data) {
                                    // if completed
                                    HideLoaderBig();

                                },
                                async: true,
                                processData: false
                            });


                        } catch (err) {

                            if (err && err !== "") {
                                alert(err.message);
                                HideLoaderBig();
                            }
                        }
                        $(this).dialog("close");
                        ShowLoaderBig();


                        //                        end ajax
                    }
                },
                Close: function () {
                    $(this).dialog("close");
                    clearTextBox();
                }
            },
            close: function () {

            }
        });

        $("#ResetSecurityQuestion").dialog({
            autoOpen: false,
            show: {
                effect: "blind",
                duration: 1000
            },
            hide: {
                effect: "blind",
                duration: 1000
            },


            width: 650,
            modal: true,
            buttons: {
                "Save": function () {
                   
                    var bValid = true;

                    if (($('#QuestionSelected1 option:selected').val()) == ($('#QuestionSelected2 option:selected').val())) {
                        alert("Please select different question other than first");
                        bValid = false;
                        return;
                    }
                 
                    if (!Reqvalue($("#Answer1").val(), "Security Answer 1"))
                    {
                        bValid=false;
                       // alert("Please enter answer of question1");
                    }
                    else if (!Reqvalue($("#Answer2").val(), "Security Answer 2"))
                    {
                        bValid=false;
                       // alert("Please enter answer of question2");
                    }
                   
                    if (bValid) {
                        ShowLoaderBig();
                        var patientid = $('#lbl-id').text();
                      //  var Password = $('#lbl-pwd').text();

                        try {
                            var requestData = {
                                PatientId: patientid,
                               // Password:Password,

                                SecurityQuestionId:$('#QuestionSelected1 option:selected').val(),
                                SecurityAnswer:$("#Answer1").val(),
                                SecurityQuestionId2:$('#QuestionSelected2 option:selected').val(),
                                SecurityAnswer2:$("#Answer2").val(),
                               

                            };


                            $.ajax({
                                type: 'POST',
                                url: 'Admin/ChangeSecurityQuestion',
                                data: JSON.stringify(requestData),
                                dataType: 'json',
                                contentType: 'application/json; charset=utf-8',
                                success: function (data) {
                                    ///$("#patient-portlet").html(data.html);
                                    //$("#tbl-LinkedAccount").fixedHeaderTable();
                                    alert("Security Questions Changed");
                                    HideLoaderBig();
                                    clearTextBox();

                                },
                                error: function (xhr, ajaxOptions, thrownError) {
                                    //if error

                                    //      alert('Error : ' + xhr.message);
                                    var myCookie = getCookie(".Admin");

                                    if (myCookie == null) {
                                        // do cookie doesn't exist stuff;
                                        alert('Not logged in. Please log in to continue');
                                        window.location = '/Login'
                                        //xhr.getResponseHeader('Location');
                                    }
                                    else {

                                        alert('Error : ' + xhr.message);
                                    }

                                    HideLoaderBig();
                                },
                                complete: function (data) {
                                    // if completed
                                    HideLoaderBig();

                                },
                                async: true,
                                processData: false
                            });


                        } catch (err) {

                            if (err && err !== "") {
                                alert(err.message);
                                HideLoaderBig();
                            }
                        }
                        $(this).dialog("close");
                        ShowLoaderBig();


                        //                        end ajax
                    }
                },
                Close: function () {
                    $(this).dialog("close");
                    clearTextBox();
                }
            },
            close: function () {

            }
        });
        $("#PatientDocument-form").dialog({
            autoOpen: false,
            show: {
                effect: "blind",
                duration: 1000
            },
            hide: {
                effect: "blind",
                duration: 1000
            },


            height: 500,
            width: 750,
            modal: true,
            buttons: {
                //"Save": function () {
                   
                //    var bValid = true;
                //    var patientid = $('#lbl-id').text();
                  
                //    var changeEmail = $('#changeemail').val();
                //    if (!checkEmail(changeEmail))
                //    {
                //        bValid = false;
                //    }

                //    if (bValid) {

                //        ShowLoaderBig();
                //        try {
                //            var requestData = {
                //                PatientId: patientid,
                //                Email: $.trim($('#changeemail').val())
                //                //  LastName: $.trim($('#txtdepententName').val())

                //            };


                //            $.ajax({
                //                type: 'POST',
                //                url: 'Admin/ChangeEmail',
                //                data: JSON.stringify(requestData),
                //                dataType: 'json',
                //                contentType: 'application/json; charset=utf-8',
                //                success: function (data) {

                //                    if (data == "Email Change Successfully")
                //                    {
                //                        $('#lbl-email').text(changeEmail);
                //                    }
                //                    alert(data);
                //                    //$("#patient-portlet").html(data.html);
                //                    //$("#tbl-LinkedAccount").fixedHeaderTable();
                //                    HideLoaderBig();
                //                    clearTextBox();

                //                },
                //                error: function (xhr, ajaxOptions, thrownError) {
                //                    //if error

                //                    //      alert('Error : ' + xhr.message);
                //                    var myCookie = getCookie(".Admin");

                //                    if (myCookie == null) {
                //                        // do cookie doesn't exist stuff;
                //                        alert('Not logged in. Please log in to continue');
                //                        window.location = '/Login'
                //                        //xhr.getResponseHeader('Location');
                //                    }
                //                    else {

                //                        alert('Error : ' + xhr.message);
                //                    }

                //                    HideLoaderBig();
                //                },
                //                complete: function (data) {
                //                    // if completed
                //                    HideLoaderBig();

                //                },
                //                async: true,
                //                processData: false
                //            });


                //        } catch (err) {

                //            if (err && err !== "") {
                //                alert(err.message);
                //                HideLoaderBig();
                //            }
                //        }
                //        $(this).dialog("close");
                //        ShowLoaderBig();


                //        //                        end ajax
                //    }
                //},
                Close: function () {
                    $(this).dialog("close");
                    clearTextBox();
                }
            },
            close: function () {

            }
        });

        $("#PatientVisit-form").dialog({
            autoOpen: false,
            show: {
                effect: "blind",
                duration: 1000
            },
            hide: {
                effect: "blind",
                duration: 1000
            },


            height: 500,
            width: 750,
            modal: true,
            buttons: {
               
                Close: function () {
                    $(this).dialog("close");
                    clearTextBox();
                }
            },
            close: function () {

            }
        });


        $("#ChangeEmail-form").dialog({
            autoOpen: false,
            show: {
                effect: "blind",
                duration: 1000
            },
            hide: {
                effect: "blind",
                duration: 1000
            },


            width: 650,
            modal: true,
            buttons: {
                "Save": function () {

                    var bValid = true;
                    var patientid = $('#lbl-id').text();
                  
                    var changeEmail = $('#changeemail').val();
                    if (!checkEmail(changeEmail))
                    {
                        bValid = false;
                    }

                    if (bValid) {

                        ShowLoaderBig();
                        try {
                            var requestData = {
                                PatientId: patientid,
                                Email: $.trim($('#changeemail').val())
                                //  LastName: $.trim($('#txtdepententName').val())

                            };


                            $.ajax({
                                type: 'POST',
                                url: 'Admin/ChangeEmail',
                                data: JSON.stringify(requestData),
                                dataType: 'json',
                                contentType: 'application/json; charset=utf-8',
                                success: function (data) {

                                    if (data == "Email Changed Successfully")
                                    {
                                        $('#lbl-email').text(changeEmail);
                                    }
                                    alert(data);
                                    //$("#patient-portlet").html(data.html);
                                    //$("#tbl-LinkedAccount").fixedHeaderTable();
                                    HideLoaderBig();
                                    clearTextBox();

                                },
                                error: function (xhr, ajaxOptions, thrownError) {
                                    //if error

                                    //      alert('Error : ' + xhr.message);
                                    var myCookie = getCookie(".Admin");

                                    if (myCookie == null) {
                                        // do cookie doesn't exist stuff;
                                        alert('Not logged in. Please log in to continue');
                                        window.location = '/Login'
                                        //xhr.getResponseHeader('Location');
                                    }
                                    else {

                                        alert('Error : ' + xhr.message);
                                    }

                                    HideLoaderBig();
                                },
                                complete: function (data) {
                                    // if completed
                                    HideLoaderBig();

                                },
                                async: true,
                                processData: false
                            });


                        } catch (err) {

                            if (err && err !== "") {
                                alert(err.message);
                                HideLoaderBig();
                            }
                        }
                        $(this).dialog("close");
                        ShowLoaderBig();


                        //                        end ajax
                    }
                },
                Close: function () {
                    $(this).dialog("close");
                    clearTextBox();
                }
            },
            close: function () {

            }
        });

    });

    function RenewPatient() {
        ShowLoaderBig();
        try {
            var patientid = $('#lbl-id').text();
            var requestData = {
                PatientId: patientid,
            };

            $.ajax({
                type: 'POST',
                url: 'Admin/RenewPatient',
                data: JSON.stringify(requestData),
                //dataType: 'json',
                dataType: 'text',
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    // if success
                    // alert("Success : " + data);
                    var msg = data;
                    alert(msg);

                    HideLoaderBig();

                },
                error: function (xhr, ajaxOptions, thrownError) {
                    //if error

                    //  alert('Error : ' + xhr.message);
                    var myCookie = getCookie(".Admin");

                    if (myCookie == null) {
                        // do cookie doesn't exist stuff;
                        alert('Not logged in. Please log in to continue');
                        window.location = '/Login'
                        //xhr.getResponseHeader('Location');
                    }
                    else {

                        alert('Error : ' + xhr.message);
                    }
                  
                    HideLoaderBig();
                },
                complete: function (data) {
                    // if completed
                    HideLoaderBig();

                },
                async: true,
                processData: false
            });

        } catch (err) {

            if (err && err !== "") {
                alert(err.message);
                HideLoader();
            }
        }

    };
    function UpdateRenewelDate() {
        $("#txtUpdateDate").datepicker({
            dateFormat: 'mm/dd/yy',

        });
        $("#UpdateRenewelDate-form").dialog("open");
    }

    function OpenLocation() {
     
        $("#ClearData").html("No Information found");
        $("#FacilityPagginationtop").css("display", "none");
        $("#FacilityPagginationBottom").css("display", "none");
        $('#FacilityData-form').dialog("open");
     }


    function ShowFacilityData(Id, FacilityName) {
      
        $("#txtFacility").val(FacilityName);
        $("#txtFacilityId").val(Id);
        $("#FacilityData-form").dialog("close");
    }
    function DocumentData() {
    //    ShowLoaderBig();
        var patientid = $('#lbl-id').text();
        try {
            var requestData = {
                PatientId: patientid,


            };

            $.ajax({
                type: 'POST',
                url: 'Admin/GetDocumentData',
                data: JSON.stringify(requestData),
                dataType: 'json',
                //dataType: 'text',
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    // if success
                    // alert("Success : " + data);
                    //alert(data);
                    
                    $("#documentdata").html(data);
                    //$('#txtPatNote').val('');
               //     HideLoaderBig();

                },
                error: function (xhr, ajaxOptions, thrownError) {

                    //alert('Error : ' + xhr.message);
                    var myCookie = getCookie(".Admin");

                    if (myCookie == null) {
                        // do cookie doesn't exist stuff;
                        alert('Not logged in. Please log in to continue');
                        window.location = '/Login'
                        //xhr.getResponseHeader('Location');
                    }
                    else {

                        alert('Error : ' + xhr.message);
                    }

                    HideLoader1();
                },
                complete: function (data) {
                    // if completed
                    HideLoaderBig();

                },
                async: true,
                processData: false
            });

        } catch (err) {

            if (err && err !== "") {
                alert(err.message);
                HideLoaderBig();
            }
        }
        $("#PatientDocument-form").dialog("open");
       
    }


    function DeleteVisitPop()
    {
        var patientid = $('#lbl-id').text();
        try {
            var requestData = {
                PatientId: patientid,


            };

            $.ajax({
                type: 'POST',
                url: 'Admin/GetVisitData',
                data: JSON.stringify(requestData),
                dataType: 'json',
                //dataType: 'text',
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    // if success
                    // alert("Success : " + data);
                    //alert(data);

                    $("#VisitData").html(data);
                    //$('#txtPatNote').val('');
                    //     HideLoaderBig();

                },
                error: function (xhr, ajaxOptions, thrownError) {

                    //alert('Error : ' + xhr.message);
                    var myCookie = getCookie(".Admin");

                    if (myCookie == null) {
                        // do cookie doesn't exist stuff;
                        alert('Not logged in. Please log in to continue');
                        window.location = '/Login'
                        //xhr.getResponseHeader('Location');
                    }
                    else {

                        alert('Error : ' + xhr.message);
                    }

                    HideLoader1();
                },
                complete: function (data) {
                    // if completed
                    HideLoaderBig();

                },
                async: true,
                processData: false
            });

        } catch (err) {

            if (err && err !== "") {
                alert(err.message);
                HideLoaderBig();
            }
        }
        $("#PatientVisit-form").dialog("open");

    }

    function DeleteDocuments( DocumentId,DocType,FacilityId,VisitId)
    {
          ShowLoaderBig();
        try {
            var DocumentCntr = DocumentId;
            var PatientId = $('#lbl-id').text();
            var requestData = {
                DocumentCntr: DocumentCntr,
                PatientId: PatientId,
                DocType: DocType,
                FacilityId: FacilityId,
                VisitId:VisitId,
            };

            $.ajax({
                type: 'POST',
                url: 'Admin/DeleteDocument',
                data: JSON.stringify(requestData),
                dataType: 'json',
                //dataType: 'text',
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                   
                     alert("Record deleted Successfully");
                 
                 //   document.getElementById("documentdata").innerHTML=data;
                    
                    $("#documentdata").html(data);

                    HideLoaderBig();

                },
                error: function (xhr, ajaxOptions, thrownError) {
                    //if error

                    //  alert('Error : ' + xhr.message);
                    var myCookie = getCookie(".Admin");

                    if (myCookie == null) {
                        // do cookie doesn't exist stuff;
                        alert('Not logged in. Please log in to continue');
                        window.location = '/Login'
                        //xhr.getResponseHeader('Location');
                    }
                    else {

                        alert('Error : ' + xhr.message);
                    }

                    HideLoaderBig();
                },
                complete: function (data) {
                    // if completed
                    HideLoaderBig();

                },
                async: true,
                processData: false
            });

        } catch (err) {

            if (err && err !== "") {
                alert(err.message);
                HideLoader();
            }
        }
   //     $("#PatientDocument-form").dialog("open");
        
    }
    function DeleteCurrentPatient()
    {
       
     //   alert(PatientId);
        ShowLoaderBig();
        try {
            var PatientId = $('#lbl-id').text();
            var requestData = {           
                PatientId: PatientId                
            };

            $.ajax({
                type: 'POST',
                url: 'Admin/DeletePatient',
                data: JSON.stringify(requestData),
                dataType: 'json',
               // dataType: 'text',
                contentType: 'application/json; charset=utf-8',
                success: function (data) {

                    alert(data);

                    //   document.getElementById("documentdata").innerHTML=data;

                //    $("#documentdata").html(data);

                    HideLoaderBig();

                },
                error: function (xhr, ajaxOptions, thrownError) {
                    //if error

                    //  alert('Error : ' + xhr.message);
                    var myCookie = getCookie(".Admin");

                    if (myCookie == null) {
                        // do cookie doesn't exist stuff;
                        alert('Not logged in. Please log in to continue');
                        window.location = '/Login'
                        //xhr.getResponseHeader('Location');
                    }
                    else {

                        alert('Error : ' + xhr.message);
                    }

                    HideLoaderBig();
                },
                complete: function (data) {
                    // if completed
                    HideLoaderBig();

                },
                async: true,
                processData: false
            });

        } catch (err) {

            if (err && err !== "") {
                alert(err.message);
                HideLoader();
            }
        }
    }


    function DeleteConfrimationCurrentUser() {
        $("#dialog-confirm").html("Are you sure you want to delete this patient?");

        // Define the Dialog and its properties.
        $("#dialog-confirm").dialog({
            resizable: false,
            modal: true,
            title: "Confirm",
            height: 140,
            width: 400,
            buttons: {
                "Yes": function () {
                    $(this).dialog('close');
                    DeleteCurrentPatient();
                },
                "No": function () {
                    $(this).dialog('close');
                    //callback(false);
                }
            }
        });

    }
    function DeleteConfrimation(DocumentId, DocTyp, FacilityId, VisitId) {
        $("#dialog-confirm").html("Are you sure you want to delete this record?");

        // Define the Dialog and its properties.
        $("#dialog-confirm").dialog({
            resizable: false,
            modal: true,
            title: "Confirm",
            height: 140,
            width: 400,
            buttons: {
                "Yes": function () {
                    $(this).dialog('close');
                    DeleteDocuments(DocumentId, DocTyp, FacilityId, VisitId);
                },
                "No": function () {
                    $(this).dialog('close');
                    //callback(false);
                }
            }
        });

    }


    function DeleteConfrimationVisit(visitid, facilityid)
    {
        $("#dialog-confirm").html("Are you sure you want to delete this record?");

        // Define the Dialog and its properties.
        $("#dialog-confirm").dialog({
            resizable: false,
            modal: true,
            title: "Confirm",
            height: 140,
            width: 400,
            buttons: {
                "Yes": function () {
                    $(this).dialog('close');
                    DeleteVisit(visitid, facilityid);
                },
                "No": function () {
                    $(this).dialog('close');
                    //callback(false);
                }
            }
        });


    }


    function ResetChangePassword() {
        $("#dialog-confirm").html("The password will be reset and a new temporary password will be sent to the patient.");

        // Define the Dialog and its properties.
        $("#dialog-confirm").dialog({
            resizable: false,
            modal: true,
            title: "Confirm",
            height: 140,
            width: 750,
            buttons: {
                "Confirm": function () {
                    $(this).dialog('close');
                    ChangePassword();
                },
                "Cancel": function () {
                    $(this).dialog('close');
                    //callback(false);
                }
            }
        });


    }


    function DeleteVisit(visitId, facilityId)
    {
        ShowLoaderBig();
        try {
           // var DocumentCntr = DocumentId;
            var PatientId = $('#lbl-id').text();
            var requestData = {
                PatientId: PatientId,
                FacilityId: facilityId,
                VisitId: visitId,
            };

            $.ajax({
                type: 'POST',
                url: 'Admin/DeleteVisit',
                data: JSON.stringify(requestData),
                dataType: 'json',
                //dataType: 'text',
                contentType: 'application/json; charset=utf-8',
                success: function (data) {

                    alert("Record deleted Successfully");

                    //   document.getElementById("documentdata").innerHTML=data;

                    $("#VisitData").html(data);

                    HideLoaderBig();

                },
                error: function (xhr, ajaxOptions, thrownError) {
                    //if error

                    //  alert('Error : ' + xhr.message);
                    var myCookie = getCookie(".Admin");

                    if (myCookie == null) {
                        // do cookie doesn't exist stuff;
                        alert('Not logged in. Please log in to continue');
                        window.location = '/Login'
                        //xhr.getResponseHeader('Location');
                    }
                    else {

                        alert('Error : ' + xhr.message);
                    }

                    HideLoaderBig();
                },
                complete: function (data) {
                    // if completed
                    HideLoaderBig();

                },
                async: true,
                processData: false
            });

        } catch (err) {

            if (err && err !== "") {
                alert(err.message);
                HideLoader();
            }
        }

    }

    $(function () {

        tips = $(".validateTips");



        $("#UpdateRenewelDate-form").dialog({
            autoOpen: false,
            show: {
                effect: "blind",
                duration: 1000
            },
            hide: {
                effect: "blind",
                duration: 1000
            },


            width: 650,
            modal: true,
            buttons: {
                "Save": function () {
                    var bValid = true;

                    if (bValid) {

                        var patientid = $('#lbl-id').text();

                        try {
                            var requestData = {
                                PatientId: patientid,
                                Date: $.trim($('#txtUpdateDate').val())



                            };


                            $.ajax({
                                type: 'POST',
                                url: 'Admin/UpdateRenewelDate',
                                data: JSON.stringify(requestData),
                                // dataType: 'json',
                                dataType: 'text',
                                contentType: 'application/json; charset=utf-8',
                                success: function (data) {
                                    // if success

                                    var obj = $.parseJSON(data);
                                    alert(obj);
                                    $('#lbl-Rdate').text(data);
                                    HideLoaderBig();
                                    clearTextBox();

                                },
                                error: function (xhr, ajaxOptions, thrownError) {
                                    //if error

                                    //alert('Error : ' + xhr.message);
                                    var myCookie = getCookie(".Admin");

                                    if (myCookie == null) {
                                        // do cookie doesn't exist stuff;
                                        alert('Not logged in. Please log in to continue');
                                        window.location = '/Login'
                                        //xhr.getResponseHeader('Location');
                                    }
                                    else {

                                        alert('Error : ' + xhr.message);
                                    }
                                    HideLoaderBig();
                                },
                                complete: function (data) {
                                    // if completed
                                    HideLoaderBig();

                                },
                                async: true,
                                processData: false
                            });


                        } catch (err) {

                            if (err && err !== "") {
                                alert(err.message);
                                HideLoaderBig();
                            }
                        }
                        $(this).dialog("close");
                        ShowLoaderBig();


                        //                        end ajax
                    }
                },
                Close: function () {
                    $(this).dialog("close");
                    clearTextBox();
                }
            },
            close: function () {

            }
        });

    });
</script>
<div id="Index-Div">
    <div id="First-Div">
         @*<button onclick="Logout();" class="btn btn-warning" style="float:right;"><span class="glyphicon glyphicon-circle-arrow-left"></span> Logout</button>*@
<table width="80%" >
    <tr>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>
            Access ID
        </td>
        <td>
            <input type="text" id="txtid" class="anc" style="width:250px" />
        </td>
        <td></td>
        <td>
            Address
        </td>
        <td>
            <input type="text" id="txtAdd" class="anc" style="width:250px" />
        </td>
    </tr>
        <tr>
        <td>
            First Name
        </td>
        <td>
            <input type="text" id="txtFname" class="anc" style="width:250px" />
        </td>
        <td></td>
         <td>
            City
        </td>
        <td>
            <input type="text" id="txtCity" class="anc" style="width:250px" />
        </td>
    </tr>
      <tr>
        <td>
            Last Name
        </td>
        <td>
            <input type="text" id="txLname" class="anc" style="width:250px" />
        </td>
          <td></td>
           <td>
            State
        </td>
        <td>
                   <select style="visibility: visible;" class="coms" name="state" id="cmbStates">
									<option value="-1" selected="selected"></option>
										<option value="AL">AL</option>
									
										<option value="AK">AK</option>
									
										<option value="AS">AS</option>
									
										<option value="AZ">AZ</option>
									
										<option value="AR">AR</option>
									
										<option value="AA">AA</option>
									
										<option value="AE">AE</option>
									
										<option value="AP">AP</option>
									
										<option value="CA">CA</option>
									
										<option value="CO">CO</option>
									
										<option value="CT">CT</option>
									
										<option value="DE">DE</option>
									
										<option value="DC">DC</option>
									
										<option value="FL">FL</option>
									
										<option value="GA">GA</option>
									
										<option value="GU">GU</option>
									
										<option value="HI">HI</option>
									
										<option value="ID">ID</option>
									
										<option value="IL">IL</option>
									
										<option value="IN">IN</option>
									
										<option value="IA">IA</option>
									
										<option value="KS">KS</option>
									
										<option value="KY">KY</option>
									
										<option value="LA">LA</option>
									
										<option value="ME">ME</option>
									
										<option value="MH">MH</option>
									
										<option value="MD">MD</option>
									
										<option value="MA">MA</option>
									
										<option value="MI">MI</option>
									
										<option value="FM">FM</option>
									
										<option value="MN">MN</option>
									
										<option value="MS">MS</option>
									
										<option value="MO">MO</option>
									
										<option value="MT">MT</option>
									
										<option value="NE">NE</option>
									
										<option value="NV">NV</option>
									
										<option value="NH">NH</option>
									
										<option value="NJ">NJ</option>
									
										<option value="NM">NM</option>
									
										<option value="NY">NY</option>
									
										<option value="NC">NC</option>
									
										<option value="ND">ND</option>
									
										<option value="MP">MP</option>
									
										<option value="OH">OH</option>
									
										<option value="OK">OK</option>
									
										<option value="OR">OR</option>
									
										<option value="PW">PW</option>
									
										<option value="PA">PA</option>
									
										<option value="PA">PA</option>
									
										<option value="PR">PR</option>
									
										<option value="RI">RI</option>
									
										<option value="SC">SC</option>
									
										<option value="TN">TN</option>
									
										<option value="TX">TX</option>
									
										<option value="UT">UT</option>
									
										<option value="VT">VT</option>
									
										<option value="VI">VI</option>
									
										<option value="VA">VA</option>
									
										<option value="WA">WA</option>
									
										<option value="WV">WV</option>
									
										<option value="WI">WI</option>
									
										<option value="WY">WY</option>
									
										<option value="SD">SD</option>
									
								</select>
                              
        </td>
    </tr>
     <tr>
        <td>
            Date of Birth
        </td>
        <td>
            <input type="text" id="txtdob" class="anc" style="width:200px" />
            <img id="show-date-PreferredEnd" src="Content/img/calender.png" style="margin-top:-3px; cursor:pointer; margin-left:10px;">
        </td>
         <td>
         </td>
          <td>
            Zip Code
        </td>
        <td>
            <input type="text" id="txtZipCode" class="anc" style="width:250px" />
        </td>
    </tr>
          
      <tr>
         <td>
            Email
        </td>
        <td>
            <input type="text" id="txtEmail" class="anc" style="width:250px" />
        </td>
          <td></td>
        <td>
            Country 
        </td>
        <td>
            <select name="Countryopt" class="coms"  id="cmbCountryopt1" style="width:250px;">
                 <option selected="selected" value="-1"></option>
				
									<option  value="USA">United States</option>
                
									<option value="ALB">Albania</option>
									<option value="DZA">Algeria</option>
									@*<option value="WSM">American Samoa</option>*@
									<option value="AND">Andorra</option>
									<option value="AGO">Angola</option>
									<option value="AIA">Anguilla</option>
									<option value="ATA">Antarctica</option>
									<option value="ATG">Antigua And Barbuda</option>
									<option value="ARG">Argentina</option>
									<option value="ARM">Armenia</option>
									<option value="ABW">Aruba</option>
									<option value="AUT">Austria</option>
									<option value="AUT">Australia</option>
									<option value="AZE">Azerbaijan</option>
									<option value="BHS">Bahamas</option>
									<option value="BHR">Bahrain</option>
									<option value="BGD">Bangladesh</option>
									<option value="BRB">Barbados</option>
									<option value="BLR">Belarus</option>
									<option value="BEL">Belgium</option>
									<option value="BLZ">Belize</option>
									<option value="BEN">Benin</option>
									<option value="BMU">Bermuda</option>
									<option value="BTN">Bhutan</option>
									<option value="BOL">Bolivia</option>
									<option value="BIH">Bosnia and Herzegovina</option>
									<option value="BWA">Botswana</option>
									<option value="BVT">Bouvet Island</option>
									<option value="BRA">Brazil</option>
									<option value="IOT">British Indian Ocean Territory</option>
									<option value="BRN">Brunei Darussalam</option>
									<option value="BGR">Bulgaria</option>
									<option value="BFA">Burkina Faso</option>
									<option value="BDI">Burundi</option>
									<option value="KHM">Cambodia</option>
									<option value="CMR">Cameroon</option>
									<option value="CAN">Canada</option>
									<option value="CPV">Cape Verde</option>
									<option value="CYM">Cayman Islands</option>
									<option value="CAF">Central African Republic</option>
									<option value="TCD">Chad</option>
									<option value="CHL">Chile</option>
									<option value="CHN">China</option>
									<option value="CXR">Christmas Island</option>
									<option value="CCK">Cocos (Keeling) Islands</option>
									<option value="COL">Colombia</option>
									<option value="COM">Comoros</option>
									<option value="COG">Congo</option>
									<option value="COK">Cook Islands</option>
									<option value="CRI">Costa Rica</option>
									<option value="CIV">Cote d'Ivoire</option>
									<option value="HRV">Croatia</option>
									<option value="CZE">Czech Republic</option>
									<option value="DNK">Denmark</option>
									<option value="DJI">Djibouti</option>
									<option value="DMA">Dominica</option>
									<option value="DOM">Dominican Republic</option>
									<option value="TMP">East Timor</option>
									<option value="ECU">Ecuador</option>
									<option value="EGY">Egypt</option>
									<option value="SLV">El Salvador</option>
									<option value="ENG">England</option>
									<option value="GNQ">Equatorial Guinea</option>
									<option value="ERI">Eritrea</option>
									<option value="ESP">Espana</option>
									<option value="EST">Estonia</option>
									<option value="ETH">Ethiopia</option>
									<option value="FLK">Falkland Islands</option>
									<option value="FRO">Faroe Islands</option>
									<option value="FJI">Fiji</option>
									<option value="FIN">Finland</option>
									<option value="FRA">France</option>
									<option value="GUF">French Guiana</option>
									<option value="PYF">French Polynesia</option>
									<option value="ATF">French Southern Territories</option>
									<option value="GAB">Gabon</option>
									<option value="GMB">Gambia</option>
									<option value="GEO">Georgia</option>
									<option value="DEU">Germany</option>
									<option value="GHA">Ghana</option>
									<option value="GIB">Gibraltar</option>
									<option value="GRC">Greece</option>
									<option value="GRL">Greenland</option>
									<option value="GRD">Grenada</option>
									<option value="GLP">Guadeloupe</option>
									<option value="GTM">Guatemala</option>
									<option value="GIN">Guinea</option>
									<option value="GNB">Guinea-Bissau</option>
									<option value="GUY">Guyana</option>
									<option value="HTI">Haiti</option>
									<option value="HMD">Heard and Mc Donald Islands</option>
									<option value="HND">Honduras</option>
									<option value="HKG">Hong Kong</option>
									<option value="HUN">Hungary</option>
									<option value="IND">India</option>
									<option value="IDN">Indonesia</option>
									<option value="IRL">Ireland</option>
									<option value="ISR">Israel</option>
									<option value="ITA">Italy</option>
									<option value="JAM">Jamaica</option>
									<option value="JPN">Japan</option>
									<option value="JOR">Jordan</option>
									<option value="KAZ">Kazakhstan</option>
									<option value="KEN">Kenya</option>
									<option value="KIR">Kiribati</option>
									<option value="KOR">Korea (North)</option>
									<option value="KOR">Korea (South)</option>
									<option value="KWT">Kuwait</option>
									<option value="KGZ">Kyrgyzstan</option>
									<option value="LVA">Latvia</option>
									<option value="LBN">Lebanon</option>
									<option value="LSO">Lesotho</option>
									<option value="LBR">Liberia</option>
									<option value="LIE">Liechtenstein</option>
									<option value="LTU">Lithuania</option>
									<option value="LUX">Luxembourg</option>
									<option value="MAC">Macau</option>
									<option value="MDG">Madagascar</option>
									<option value="MWI">Malawi</option>
									<option value="MDV">Maldives</option>
									<option value="MLI">Mali</option>
									<option value="MLT">Malta</option>
									<option value="MTQ">Martinique</option>
									<option value="MRT">Mauritania</option>
									<option value="MUS">Mauritius</option>
									<option value="MYT">Mayotte</option>
									<option value="MEX">Mexico</option>
									<option value="MDA">Moldova, Republic of</option>
									<option value="MCO">Monaco</option>
									<option value="MNG">Mongolia</option>
									<option value="MSR">Montserrat</option>
									<option value="MAR">Morocco</option>
									<option value="MOZ">Mozambique</option>
									<option value="MMR">Myanmar</option>
									<option value="NAM">Namibia</option>
									<option value="NRU">Nauru</option>
									<option value="NPL">Nepal</option>
									<option value="NLD">Netherlands</option>
									<option value="ANT">Netherlands Antilles</option>
									<option value="NCL">New Caledonia</option>
									<option value="NZE">New Zealand</option>
									<option value="NIC">Nicaragua</option>
									<option value="NER">Niger</option>
									<option value="NGA">Nigeria</option>
									<option value="NIU">Niue</option>
									<option value="NFK">Norfolk Island</option>
									<option value="IRL">Northern Ireland</option>
									<option value="NOR">Norway</option>
									<option value="PAK">Pakistan</option>
									<option value="PAN">Panama</option>
									<option value="PNG">Papua New Guinea</option>
									<option value="PRY">Paraguay</option>
									<option value="PER">Peru</option>
									<option value="PHL">Philippines</option>
									<option value="PCN">Pitcairn</option>
									<option value="POL">Poland</option>
									<option value="PRT">Portugal</option>
									<option value="QAT">Qatar</option>
									<option value="REU">Reunion</option>
									<option value="ROM">Romania</option>
									<option value="RUS">Russia</option>
									<option value="RUS">Russian Federation</option>
									<option value="RWA">Rwanda</option>
									<option value="KNA">Saint Kitts and Nevis</option>
									<option value="LCA">Saint Lucia</option>
									<option value="VCT">Saint Vincent and the Grenadines</option>
									<option value="SMR">San Marino</option>
									<option value="STP">Sao Tome and Principe</option>
									<option value="SAU">Saudi Arabia</option>
									<option value="SEN">Senegal</option>
									<option value="SYC">Seychelles</option>
									<option value="SLE">Sierra Leone</option>
									<option value="SGP">Singapore</option>
									<option value="SVK">Slovakia</option>
									<option value="SVN">Slovenia</option>
									<option value="SLB">Solomon Islands</option>
									<option value="SOM">Somalia</option>
									<option value="ESP">Spain</option>
									<option value="LKA">Sri Lanka</option>
									<option value="SHN">St. Helena</option>
									<option value="SPM">St. Pierre and Miquelon</option>
									<option value="SUR">Suriname</option>
									<option value="SJM">Svalbard and Jan Mayen Islands</option>
									<option value="SWZ">Swaziland</option>
									<option value="SWE">Sweden</option>
									<option value="CHE">Switzerland</option>
									<option value="TWN">Taiwan</option>
									<option value="TJK">Tajikistan</option>
									<option value="TZA">Tanzania</option>
									<option value="THA">Thailand</option>
									<option value="TGO">Togo</option>
									<option value="TKL">Tokelau</option>
									<option value="TON">Tonga</option>
									<option value="TTO">Trinidad and Tobago</option>
									<option value="TUN">Tunisia</option>
									<option value="TUR">Turkey</option>
									<option value="TKM">Turkmenistan</option>
									<option value="TCA">Turks and Caicos Islands</option>
									<option value="TUV">Tuvalu</option>
									<option value="UGA">Uganda</option>
									<option value="UKR">Ukraine</option>
									<option value="ARE">United Arab Emirates</option>
									<option value="UK">United Kingdom</option>
									<option value="URY">Uruguay</option>
									<option value="UZB">Uzbekistan</option>
									<option value="VUT">Vanuatu</option>
									<option value="VAT">Vatican City State (Holy See)</option>
									<option value="VEN">Venezuela</option>
									<option value="VNM">Viet Nam</option>
									<option value="VGB">Virgin Islands</option>
									<option value="WLF">Wallis and Futuna Islands</option>
									<option value="ESH">Western Sahara</option>
									<option value="YEM">Yemen</option>
									<option value="ZMB">Zambia</option>

							</select>
        </td>
    </tr>
      <tr>
           <td>
            Partner
        </td>
        <td>
                @Html.DropDownList("cmbPartner", Model.Partner.ToPartnerModelSelectList(), new { id = "cmbPartner", @class="txt", style = "width:200px",  })

           
        </td>
          <td></td>
        <td>
            Home Phone
        </td>
        <td>
            <input type="text" id="txtHphone" class="anc" style="width:250px" />
        </td>
    </tr>
    <tr><td>Location</td><td>      <input type="text" id="txtFacility" class="anc" style="width:250px" /><input type="hidden" id="txtFacilityId" /><img src="~/Content/img/zoom_in.png" style="height:32px;cursor:pointer;" onclick="OpenLocation();" />
    </td>

    </tr>
   
    <tr>
        <td>

        </td>
        <td height="60px">
            <span style="height:500px;">    <button type="button" onclick="PatientSearch();" class="btn btn-info"><span class="glyphicon glyphicon-search"></span> Search</button>
                <img id="loader" src="Content/img/login-loader.gif" style="margin-left:30px;display:none;">
        </span>
        </td>
    </tr>
</table>
      <div align="right" id="Pagginationtop" style="display:none;">
           Page: <select class="coms"  id="pageindextop" style="width:70px;">
                </select>

        </div> 
<div id="Search-Patient">
</div>
         <div align="right" id="Paggination" style="display:none;">
           Page: <select class="coms"  id="pageindex" style="width:70px;">
                </select>

        </div>
        
        <div id="dialog-confirm">

</div>
</div>

    <div id="Patient-Data" style="display:none;">
    <button onclick="BackSearch();" class="btn btn-warning" style="float:right;"><span class="glyphicon glyphicon-circle-arrow-left"></span> Previous Search</button>
    <table width="80%" >
            <tr>
        <td>
        <table width="80%" >
    <tr>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>
            Access ID
        </td>
        <td>
            <label id="lbl-id"></label>
        </td>
         <td>
            Patient Representative Password
        </td>
        <td>
            <label id="lbl-cpwd"></label>
        </td>
    </tr>
        <tr>
        <td>
            Name
        </td>
        <td>
            <label id="lbl-Name"></label>
        </td>
             <td>
            Renewel Date
        </td>
        <td>
            <label id="lbl-Rdate"></label>
        </td>
          <td></td>
    </tr>
      <tr>
        <td>
           Account Password
        </td>
        <td>
            <label id="lbl-pwd"></label>
        </td>
          <td></td>
    </tr>
      <tr>
        <td>
            Address
        </td>
        <td>
            <label id="lbl-Adr"></label>           
        </td>
          <td></td>
    </tr>
     <tr>
        <td>
            
        </td>
        <td>            
            <label id="lbl-Adr3"></label>  
            
        </td>
          <td></td>
    </tr>
            <tr>
        <td>
            
        </td>
        <td>           
            <label id="lbl-Adr2"></label>
        </td>
          <td></td>
    </tr>
      <tr>
        <td>
            Account Type
        </td>
        <td>
                   <label id="lbl-act-typ"></label>
								                          
        </td>
          <td></td>
    </tr>
     
      <tr>
        <td>
            Email 
        </td>
        <td>
            <label id="lbl-email"></label>        </td>
          <td> <span style="height:500px;">    <button type="button" onclick="SendEmail();" class="btn btn-info">Compose Email</button></td>
    </tr>
      <tr>
        <td>
            Partner
        </td>
        <td>
           <label id="lbl-partner"> </label>
        </td>
          <td><label id="Active" style="display:none"></label></td>
    </tr>
             <tr><td valign="Top" >Location:
                    <table id="myTable1" width="80%" style="display:none;"  >

    </table>
                 </td>
                 <td>
                 <div id="lbl-Practice" >
                      <table id="myTable" width="80%" style="font-weight: bold;"  >

    </table>

                 </div></td>
      
    </tr>
   
    
</table></td>
        <td >
            
            @*<div style="border:1px solid blue; ">
            Get Well Clinic
                <br />1002 HealthCare Dr.<br /><br />
                Portland Cardiology<br />
                232 54th street<br />
                Portland, OR 97005<br /><br />
            </div>*@
        </td>
    </tr>
</table>


<table width="50%" style="margin-top:40px;">

    <tr>
   <td><span style="height:500px;">    <button type="button" onclick="PatientPortal();"  class="btn btn-info" style="width:167px;">Log in as Patient</button></span></td>
    <td><span style="height:500px;">    <button id="PrintWelcomeScreen" type="button"  style="width:170px;" class="btn btn-info" disabled="disabled">Print Welcome Screen</button></span></td>
    <td><span style="height:500px;">    <button id="FamilyLinkId" type="button"  class="btn btn-info" style="width:170px;" onclick="CreateFamilyLinks();" disabled="disabled">Family Links</button></span></td>
         <td><span style="height:500px;">    <button  type="button"  class="btn btn-info" style="width:195px;" onclick="ResetChangePassword();">Reset Password</button></span></td>
       <td><span style="height:500px;">    <button type="button"  class="btn btn-info" onclick="DeleteConfrimationCurrentUser();" style="width:175px;">Delete Patient</button></span></td>
   
       </tr>
    <tr>   
    <td><span style="height:500px;">    <button id="UpdateRenewelDate" type="button"    class="btn btn-info" style="width:167px;" onclick="UpdateRenewelDate();" disabled="disabled">Update Renewel Date</button></span></td>
    <td><span style="height:500px;">    <button type="button"  class="btn btn-info" style="width:170px;" onclick="ResetLockedAccount();">Reset Locked Account</button></span></td>
     <td><span style="height:500px;">    <button type="button"  class="btn btn-info" style="width:170px;" onclick="ChangeEmail();">Change Email</button></span></td>
      <td><span style="height:500px;">    <button type="button"  class="btn btn-info" onclick="RestSecurityQuestion();" style="width:195px;">Change Security Questions</button></span></td>
        <td><span style="height:500px;">    <button id="UpgradeDowngrade" type="button"   class="btn btn-info" style="width:175px;" onclick="UpgradeDowngrade();">Upgrade/Downgrade</button></span></td>
       </tr>
    <tr>
   <td><span style="height:500px;">    <button type="button"  class="btn btn-info" onclick="ActivateDeactivatePatient();" style="width:167px;">Activate/Deactivate</button></span></td>
    <td><span style="height:500px;">    <button id="RenewAccount" type="button"   class="btn btn-info" style="width:170px;" onclick="RenewPatient();" disabled="disabled">Renew Account</button></span></td>
    <td><span style="height:500px;">    <button id="clientNote" type="button"  class="btn btn-info" style="width:170px;" onclick="clientNotesform();">Client Notes</button></span></td>
      <td><span style="height:500px;">    <button type="button"  class="btn btn-info" style="width:195px;" onclick="DocumentData();">Documents</button></span></td>
      <td><span style="height:500px;">    <button type="button"  class="btn btn-info" style="width:175px;" onclick="DeleteVisitPop();">Delete a Visit</button></span></td>

       </tr>
  
</table>
    </div>
    
       <div  id="FacilityData-form" title="Location Lookup">
         <table>
             <tr><td>Enter Location Name</td><td><input type="text" id="searchLocation" style="width:256px;" /></td> <td ><span style="height:500px;">    <button type="button" onclick="FacilitySearch();" class="btn btn-info"><span class="glyphicon glyphicon-search"></span> Search</button>
        </span>
        </td><td><img id="loader2" src="Content/img/login-loader.gif" style="margin-left:30px;display:none;"></td></tr>
             <tr></tr>
            
         </table>
               <div align="right" id="FacilityPagginationtop" style="display:none;">
           Page: <select class="coms"  id="Facilityindextop" style="width:70px;">
                </select>

        </div> 
        <div id="FacilityData" style="margin-top:0px;">
            <table class="table">
                <thead>
                      <tr>

              <th>Location ID</th>
                <th>Location Name</th>
               
                
            </tr>

                </thead>
                <tbody id="ClearData">
                <tr >
                        <td>
                            No Information Found
                        </td>
                    <td>

                    </td>
                </tr>
                </tbody>
            </table>
        </div>
               <div align="right" id="FacilityPagginationBottom" style="display:none;">
           Page: <select class="coms"  id="FacilityindexBottom" style="width:70px;">
                </select>

        </div> 
       
    </div>
       
    <!--popup for Third Party -->
    <div id="ThirdParty-Records" title="Third Party">

    <table width="100%">

        <tr>
            <td align="right">Third Party:</td>
            <td>
                @Html.DropDownList("cmbThirdParty", Model.ThirdParty.ToThirdPartyModelSelectList(), new { id = "cmbThirdParty", @class="txt", style = "width:200px",  })
            </td>
        </tr>


    </table>
   

</div>

    <div id="ResetSecurityQuestion" title="Reset Security Question">
          <table width="100%">

        <tr>
            <td align="right">Question 1:</td>
            <td>
                @Html.DropDownList("QuestionSelected1", Model.SecurityQuestion.ToSecurityQuestionModelSelectList(), new { id = "QuestionSelected1", @class="txt", style = "width:300px",  })
            </td>
        </tr>
              
        <tr>
            <td align="right">Answer:</td>
            <td>
                <input type="text" id="Answer1" class="txt" value="" style = "width:300px"/>
            </td>
        </tr>
                <tr>
            <td align="right">Question 2:</td>
            <td>
                @Html.DropDownList("QuestionSelected2", Model.SecurityQuestion.ToSecurityQuestionModelSelectList(), new { id = "QuestionSelected2", @class="txt", style = "width:300px",  })
            </td>
        </tr>
              
        <tr>
            <td align="right">Answer:</td>
            <td>
                <input type="text" class="txt" id="Answer2"  value="" style = "width:300px" />
            </td>
        </tr>

    </table>
   

    </div>
    <div id="ChangeEmail-form" title="Edit Email ">
     <table width="80%" >
       <tr>
            <td align="right" style="width:20%;" >Email: </td>
            <td align="left" style="width:10%;" colspan="3" >
               
          <input type="text" id="changeemail" class="txt" maxlength="60" style="width:250px;"  />

          </td>
          
        </tr>
        
        
       
    </table>
     
</div>
    <!--end popup for record of clincal-->

    <div id="ChildPatient-form" title="Add an Account ">
     <table width="100%" >
       <tr>
            <td align="right" style="width:20%;" >Please enter a Family Member Access Code: </td>
            <td align="left" style="width:10%;" colspan="3" >
                <input type="hidden" id="txtpatrentcode"  value="" class="txt"  maxlength="3" style="width:65px; display:none;" />
                
          <input type="text" id="txtchildcode" class="txt" maxlength="30" style="width:100px;"  />

          </td>
          
        </tr>
        
        
       
    </table>
     
</div>

    <div  id="PatientDocument-form" title="Documents">
        <div id="documentdata">

        </div>
        <div id="documentdata1">

        </div>


    </div>

     <div  id="PatientVisit-form" title="Visits">
        <div id="VisitData">

        </div>
       


    </div>



    <!-- popup for activate/deactivated patient -->
    <div id="Activate-Decativate-form" title="Activate/Deactivate Patient">
     <table width="100%" >
       <tr>
            <td style="width:5%;" ><input id="rdAct" checked="checked" type="radio" name="patradio" value="Activate"></td>
          <td>Activate</td>
        </tr>
               <tr>
            <td style="width:5%;" ><input id="rdDact" type="radio" name="patradio" value="Deactivate"></td>
          <td>Deactivate</td>
        </tr>
        
       
    </table>
     
</div>

    <!-- popup for client notes -->
    <div id="clientNotes-form" title="Add Client Notes">
     <table width="100%" >
                <tr>
            <td align="right" style="width:20%;" >Add Note: </td>
            <td align="left" style="width:80%;" colspan="3" >
          @*<input type="text" id="txtPatNote" class="txt" maxlength="30" style="width:100px;"  />*@
                <textarea class="txt" id="txtPatNote" cols="5" rows="5"  style="width:80%;"></textarea>

          </td>
          
        </tr>
         <tr>
             <td></td>
             <td colspan="3">         <span style="text-align:center;">
         <input type="button"  value="Save Notes" onclick="SavePatientNotes();"/>
             <img id="loader1" src="Content/img/login-loader.gif" style="margin-left: 30px; display: none;">
         </span></td>
         </tr>
        
       
       
    </table>
     
        <div id="patient-notes" class="portlet-content disabled" style="height: 190px; overflow-x: auto;">
                @Html.Partial("_PatientNotesTable", Model.PatientNotes)
            </div>
     
</div>

    <div id="UpdateRenewelDate-form" title="Update Renewel Date ">
     <table width="100%" >
       <tr>
            <td align="right" style="width:20%;" >Update Date: </td>
            <td align="left" style="width:10%;" colspan="3" >
                <input type="hidden" id="txtUpdateDatehid"  value="" class="txt"  maxlength="3" style="width:65px; display:none;" />
                
          <input type="text" id="txtUpdateDate" class="txt" maxlength="30" style="width:100px;"  />

          </td>
          
        </tr>
        
        
       
    </table>
     
</div>
    </div>
<script type="text/javascript">
    var flag = "";
    function SendEmail()
    {
        var email = $('#lbl-email').text();
        window.location.href = "mailto:"+email;
    }
    function PatientPortal()
    {
        var pwd = $('#lbl-pwd').text();
        var user = $('#lbl-id').text();
        var url = '@Url.Action("PatientLogin","Admin")' + "/?UserLogin=" + user + "&Password=" + pwd;

         //alert(url);
       // window.location.href = url;
        window.open(url);
    }
    function BackSearch()
    {
        $('#First-Div').show();
        $('#Patient-Data').hide();
        if (flag == "True") {
            $('#Paggiation').css("display", "block");
            $('#Paggiationtop').css("display", "block");

        }
        var myTable = document.getElementById('myTable');
        var myTable1 = document.getElementById('myTable1');
        myTable.innerHTML = "";
        myTable1.innerHTML = "";
       // $("tbody", myTable).remove();
       // $("tbody", myTable1).remove()

    }
    function DisableControll()
    {
      //  alert("disable");
        document.getElementById("RenewAccount").disabled = true;//m.disabled = true;
        document.getElementById("UpdateRenewelDate").disabled = true;
        document.getElementById("PrintWelcomeScreen").disabled = true;
        document.getElementById("FamilyLinkId").disabled = true;
      //  alert("disable");
    }
    function EnableControll()
    {
        document.getElementById("RenewAccount").disabled = false;
        document.getElementById("UpdateRenewelDate").disabled = false;
        document.getElementById("PrintWelcomeScreen").disabled = false;
        document.getElementById("FamilyLinkId").disabled = false;

        //alert("enabled");

    }
    function ShowPatientData(id)
    {
        try {
        ShowLoaderBig();
        var obj2 = jQuery.parseJSON($('#' + id).val());
        var requestData = {
            PatientId: obj2.PatientId,
        };
        $.ajax({
            type: 'POST',
            url: 'Admin/GetPatient',
            data: JSON.stringify(requestData),
                dataType: 'json',
                //dataType: 'text',
            contentType: 'application/json; charset=utf-8',
            success: function (data) {
                // if success
                //  alert(data);
                $('#First-Div').hide();
                $('#Patient-Data').show();

                //var obj = jQuery.parseJSON($('#' + id).val());
                var obj = $.parseJSON(data);
                $('#lbl-id').text(obj.PatientId);
                $('#lbl-Name').text(obj.Name);
                $('#lbl-pwd').text(obj.Password);
                $('#lbl-Adr').text(obj.Address);
                $('#lbl-Adr3').text(obj.Address2);
                $('#lbl-Adr2').text(obj.CityStateZip);
                $('#Active').text(obj.Active);
                if (obj.Active) {
                    $("#rdAct").prop('checked', true);
                }
                else {
                    $("#rdDact").prop('checked', true);
                }
                if (obj.RepresentativePwd != null) {
                    $('#lbl-cpwd').text(obj.RepresentativePwd);
                } else { $('#lbl-cpwd').text("");}
                if (obj.PremiumFlag) {
                    EnableControll();
                                   
                   
                    $('#lbl-act-typ').text('Premium');
                }
                else {
                   // $("#RenewAccount").setAttribute('disabled', false);
                    
                    DisableControll();

                    $('#lbl-act-typ').text('Standard');
                }
                if (obj.ClientNote == true) {
                   // $("#clientNote").text = "Client Notes*"
                    document.getElementById("clientNote").innerHTML = "Client Notes*"

                }
                else {
                    document.getElementById("clientNote").innerHTML = "Client Notes"


                }
                $('#lbl-Rdate').text(obj.PremiumExpireDate);
                $('#lbl-email').text(obj.EMail);
                $('#lbl-partner').text(obj.EMRSystemName);
               // $('#lbl-Practice').text(obj.Practices);
                if(obj.Practices !=null){
                    var mystring = obj.Practices;
                    var ResultPractice = "<table><tr>";
                    var td = "<td>";
                    var value = "";
                    var html = "";
                    var result = mystring.split(",");
                           
                    var body = document.getElementById("myTable");
                    var body1 = document.getElementById("myTable1");
                

                    //tbl = document.createElement('table');
                    //  tbl.style.width = '100px';
                    //  tbl.style.border = "1px solid black";
                    //  alert(result.length);
                    for (var i = 0; i < result.length-1; i++) {
                        var tr = body.insertRow();
                        var tr1 = body1.insertRow();

                        // for (var j = 0; j < 2; j++) {
                       
                        var td = tr1.insertCell(0);
                        var td1 = tr.insertCell(0);
                        var td2 = tr.insertCell(1);
                        td.appendChild(document.createTextNode('Practice ' + (i + 1)));
                        td1.appendChild(document.createTextNode(result[i]));
                        // td1.css("margin-left", "25px");
                        //.addClass = 'Practice';
                        //  td2.appendChild(document.createTextNode('Address'));

                        td1.style.border = "2"
                        // td.appendChild(document.createTextNode(result[]));
                        //  td.style.border = "";
                            
                        //  }
                    
                    }
           
                    body1.appendChild(tr1);
                    body.appendChild(tr);
                }

            
               // $('#lbl-Practice').innerHTML(body);
                $('#txtThirdPartyID').text(obj.ThirdPartyId);
                $('#lbl-party').text(obj.ThirdPartyName);
                HideLoaderBig();

            },
            error: function (xhr, ajaxOptions, thrownError) {
                //if error
                    var myCookie = getCookie(".Admin");

                    if (myCookie == null) {
                        // do cookie doesn't exist stuff;
                        alert('Not logged in. Please log in to continue');
                        window.location = '/Login'
                        //xhr.getResponseHeader('Location');
                    }
                    else {

                alert('Error : ' + xhr.message);
                    }
                HideLoaderBig();
            },
            complete: function (data) {
                // if completed
                HideLoaderBig();

            },
            async: true,
            processData: false
        });
        }
     catch (err) {
        
        if (err && err !== "") {
            alert(err.message);
        }
    }
        //alert(obj.Address1);
    }
    function PatientSearch()
    {
        ShowLoader();
        var statusvalue = $("#cmbStates option:selected").val();
        var Partner = $("#cmbPartner option:selected").val();
        var Countryvalue = $("#cmbCountryopt1 option:selected").val();
        var FacilityId = $("#txtFacilityId").val();
        var Facility = $("#txtFacility").val();
        if (FacilityId == "0")
        {
            FacilityId = null;
        }
        if (Facility == null || Facility == "") {
            FacilityId = null;
        }
        if (Countryvalue == "-1") {
            Countryvalue = null;

        }
        if (Partner == "-1") 
        {
          //  alert(Partner);
            Partner = null;
        }
        if (statusvalue == "-1") {
            statusvalue = null;
        }
       
      ///  alert("value of status is " + statusvalue);
        var requestData = {
            PatientId: $('#txtid').val(),
            FirstName: $('#txtFname').val(),
            LastName: $('#txLname').val(),
            Address1: $('#txtAdd').val(),
            City: $('#txtCity').val(),
            State: statusvalue,
            Zip: $('#txtZipCode').val(),
            CountryCode: Countryvalue,
            HomePhone: $('#txtHphone').val(),
            EMail: $('#txtEmail').val(),
            dob: $('#txtdob').val(),
            EMRSystemId: Partner,
            PageNumber: 0,
            PageSize: 20,
            TotalRecords: 0,
            FacilityId: FacilityId,
        };
        $.ajax({
            type: 'POST',
            url: 'Admin/SearchPatients',
            data: JSON.stringify(requestData),
            dataType: 'json',
            contentType: 'application/json; charset=utf-8',
            success: function (data) {
                // if success
                // alert("Success : " + data);
               // var myCookie = getCookie(".Admin");
                //alert(myCookie); if (data.error == "The access id was deleted") {
                if (data.error == "The access id was deleted") {
                    alert("The access id was deleted");
                    $("#Search-Patient").html(data.html);
                    HideLoader();

                }
                else {
                    var  divident = 0;
                    var remainder = 0;
                    $("#Search-Patient").html(data.html);
                    if (data.count > 20) {
                        flag = "True";
                        divident = data.count / 20;
                        remainder = data.count % 20;
                        //alert(divident);
                        $("#pageindex").text("");
                        $("#pageindextop").text("");

                        if (remainder != 0)
                        {
                            divident=divident+1;}

                        $("#Paggination").css("display", "block");
                        $("#Pagginationtop").css("display", "block");

                        for (var i = 1; i <= divident; i++) {
                            $("#pageindex").append("<option value=\"" + (i - 1) + "\">" + i + "</option>");
                            $("#pageindextop").append("<option value=\"" + (i - 1) + "\">" + i + "</option>");

                        }
                    }
                    else {
                        $("#Paggination").css("display", "none");
                        $("#Pagginationtop").css("display", "none");

                        $("#pageindex").text("");
                        $("#pageindextop").text("");


                    }
                    HideLoader();
                }
            },
            error: function (xhr, ajaxOptions, thrownError) {
                //if error
                var myCookie = getCookie(".Admin");

                if (myCookie == null) {
                    // do cookie doesn't exist stuff;
                    alert('Not logged in. Please log in to continue');
                    window.location = '/Login'
                    //xhr.getResponseHeader('Location');
                }
                else {

                alert('Error : ' + xhr.message);
                }
                //alert('Error : ' + xhr.message);
                HideLoader();
            },
            complete: function (data) {
                // if completed
                HideLoader();

            },
            async: true,
            processData: false
        });
    }
    function FacilitySearch() {
       // ShowLoader();
        $("#loader2").css("display", "block");
        var FacilityName = $("#searchLocation").val();
        var requestData = {
            FacilityName: FacilityName,
            PageNumber: 0,
            PageSize: 20,

        };
        $.ajax({
            type: 'POST',
            url: 'Admin/SearchFacility',
            data: JSON.stringify(requestData),
            dataType: 'json',
            contentType: 'application/json; charset=utf-8',
            success: function (data) {
                // if success
                // alert("Success : " + data);
                // var myCookie = getCookie(".Admin");
                //alert(myCookie); if (data.error == "The access id was deleted") {
                if (data.error == "The access id was deleted") {
                    alert("The access id was deleted");
                    //   $("#Search-Patient").html(data.html);
                    $("#FacilityData").html(data.html);
                    $("#loader2").css("display", "none");

                    //HideLoader();

                }
                else {
                    var divident = 0;
                    var remainder = 0;
                    //   $("#Search-Patient").html(data.html);
                    $("#FacilityData").html(data.html);
                    if (data.count > 20) {
                        flag = "True";
                        divident = data.count / 20;
                        remainder = data.count % 20;
                        //alert(divident);
                        $("#Facilityindextop").text("");
                        $("#FacilityindexBottom").text("");

                        if (remainder != 0) {
                            divident = divident + 1;
                        }

                        $("#FacilityPagginationBottom").css("display", "block");
                        $("#FacilityPagginationtop").css("display", "block");

                        for (var i = 1; i <= divident; i++) {
                            $("#FacilityindexBottom").append("<option value=\"" + (i - 1) + "\">" + i + "</option>");
                            $("#Facilityindextop").append("<option value=\"" + (i - 1) + "\">" + i + "</option>");

                        }
                    }
                    else {
                        $("#FacilityPagginationBottom").css("display", "none");
                        $("#FacilityPagginationtop").css("display", "none");

                        $("#pageindex").text("");
                        $("#pageindextop").text("");


                    }
                    $("#loader2").css("display", "none");

               // HideLoader();
                 }

            },
            error: function (xhr, ajaxOptions, thrownError) {
                //if error
                var myCookie = getCookie(".Admin");

                if (myCookie == null) {
                    // do cookie doesn't exist stuff;
                    alert('Not logged in. Please log in to continue');
                    window.location = '/Login'
                    //xhr.getResponseHeader('Location');
                }
                else {

                    alert('Error : ' + xhr.message);
                }
                //alert('Error : ' + xhr.message);
                $("#loader2").css("display", "none");

                HideLoader();
            },
            complete: function (data) {
                $("#loader2").css("display", "none");
               
                // if completed
                HideLoader();

            },
            async: true,
            processData: false
        });


    }
  @*  function Logout()
    {
        window.location.href = '@Url.Action("Logout","Admin")';
    }*@

    // SJF 07/07/2014 Added Third Party Section functions
    function OpenThirdPartyRecord() {
  //      try {
  //          $('#cmbThirdParty').val(id);
  //          $("#ThirdParty-Records")
  //.next(".ui-dialog-buttonpane")
  //.find("button:contains('Save')")
  //.button("option", "disabled", true);

  //      } catch (e) {
  //          alert(e.message);
  //      }
        $("#ThirdParty-Records").dialog("open");
    }
    $(function () {

        $("#ThirdParty-Records").dialog({
            autoOpen: false,
            show: {
                effect: "blind",
                duration: 1000
            },
            hide: {
                effect: "blind",
                duration: 1000
            },


            width: 550,
            modal: true,
            buttons: {
                "Save": function () {

                    try {

                        var requestData = {
                            ThirdPartyId: $.trim($('#cmbThirdParty option:selected').val())

                        };

                        $.ajax({
                            type: 'POST',
                            url: 'index-thirdparty-save',
                            data: JSON.stringify(requestData),
                            dataType: 'json',
                            contentType: 'application/json; charset=utf-8',
                            success: function (data) {
                                // if success
                                // alert("Success : " + data);

                                // Change third party info on main screen


                                $("#lbl-party").text(cmbThirdParty.text);
                                $("#txtThirdPartyID").text(cmbThirdParty.val);


                            },
                            error: function (xhr, ajaxOptions, thrownError) {
                                //if error
                                var myCookie = getCookie(".Admin");

                                if (myCookie == null) {
                                    // do cookie doesn't exist stuff;
                                    alert('Not logged in. Please log in to continue');
                                    window.location = '/Login'
                                    //xhr.getResponseHeader('Location');
                                }
                                else {

                                    alert('Error : ' + xhr.message);
                                }
                               // alert('Error : ' + xhr.message);
                                HideLoader();
                            },
                            complete: function (data) {
                                // if completed
                                HideLoader();

                            },
                            async: true,
                            processData: false
                        });
                    }

                    catch (err) {

                        if (err && err !== "") {
                            alert(err.message);
                            HideLoader();
                        }
                    }
                    allFields.val("").removeClass("ui-state-error");
                    $(".validateTips ").empty();
                    $("span").removeClass("ui-state-highlight");
                    $(this).dialog("close");
                    ShowLoader();

                    //                        end ajax

                },
                Close: function () {
                    allFields.val("").removeClass("ui-state-error");
                    $(".validateTips ").empty();
                    $("span").removeClass("ui-state-highlight");
                    $(this).dialog("close");
                }
            },
            close: function () {

            }
        });


    });
    $(function () {

        tips = $(".validateTips");



        $("#ThirdParty-Records").dialog({
            autoOpen: false,
            show: {
                effect: "blind",
                duration: 1000
            },
            hide: {
                effect: "blind",
                duration: 1000
            },


            width: 650,
            modal: true,
            buttons: {
                "Save": function () {
                    var bValid = true;
                     
                    if (bValid) {

                        var patientid = $('#lbl-id').text();

                        try {
                            var requestData = {
                                PatientId: patientid,
                                ThirdPartyId: $.trim($('#cmbThirdParty option:selected').val()),
                                ThirdPartyName: $.trim($('#cmbThirdParty option:selected').text())


                            };


                            $.ajax({
                                type: 'POST',
                                url: 'Admin/SaveThirdParty',
                                data: JSON.stringify(requestData),
                                // dataType: 'json',
                                dataType: 'text',
                                contentType: 'application/json; charset=utf-8',
                                success: function (data) {
                                    // if success

                                    var obj = $.parseJSON(data);
                                   // alert(data);

                                    $('#lbl-party').text(data);
                                    HideLoaderBig();


                                },
                                error: function (xhr, ajaxOptions, thrownError) {
                                    //if error

                                    //alert('Error : ' + xhr.message);
                                    var myCookie = getCookie(".Admin");

                                    if (myCookie == null) {
                                        // do cookie doesn't exist stuff;
                                        alert('Not logged in. Please log in to continue');
                                        window.location = '/Login'
                                        //xhr.getResponseHeader('Location');
                                    }
                                    else {

                                        alert('Error : ' + xhr.message);
                                    }
                                    HideLoaderBig();
                                },
                                complete: function (data) {
                                    // if completed
                                    HideLoaderBig();

                                },
                                async: true,
                                processData: false
                            });


                        } catch (err) {

                            if (err && err !== "") {
                                alert(err.message);
                                HideLoaderBig();
                            }
                        }
                        $(this).dialog("close");
                        ShowLoaderBig();


                        //                        end ajax
                    }
                },
                Close: function () {
                    $(this).dialog("close");
                    clearTextBox();
                }
            },
            close: function () {

            }
        });
        $("#FacilityData-form").dialog({
            autoOpen: false,
            show: {
                effect: "blind",
                duration: 1000
            },
            hide: {
                effect: "blind",
                duration: 1000
            },


            height: 500,
            width: 750,
            modal: true,
            buttons: {

                Close: function () {
                    $(this).dialog("close");
                    $("#searchLocation").val("");
                }
            },
            close: function () {
                $("#searchLocation").val("");

            }
        });

    });
    function SavePatientNotes()
    {
        ShowLoader1();
        var patientid = $('#lbl-id').text();

        try {
            var requestData = {
                PatientId: patientid,
                Note: $.trim($('#txtPatNote').val())
                //  LastName: $.trim($('#txtdepententName').val())

            };


            $.ajax({
                type: 'POST',
                url: 'Admin/ClientNotes',
                data: JSON.stringify(requestData),
                dataType: 'json',
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    // if success

                    $("#patient-notes").html(data);
                    HideLoader1();
                    clearTextBox();
                    $('#txtPatNote').val('');
                },
                error: function (xhr, ajaxOptions, thrownError) {
                    //if error

                    // alert('Error : ' + xhr.message);
                    var myCookie = getCookie(".Admin");

                    if (myCookie == null) {
                        // do cookie doesn't exist stuff;
                        alert('Not logged in. Please log in to continue');
                        window.location = '/Login'
                        //xhr.getResponseHeader('Location');
                    }
                    else {

                        alert('Error : ' + xhr.message);
                    }
                    HideLoaderBig();
                },
                complete: function (data) {
                    // if completed
                    HideLoaderBig();

                },
                async: true,
                processData: false
    });


        } catch (err) {

            if (err && err !== "") {
                alert(err.message);
                HideLoaderBig();
            }
        }
    }
    function ResetLockedAccount()
    {
        ShowLoaderBig();
        var patientid = $('#lbl-id').text();

        try {
            var requestData = {
                PatientId: patientid,
                Password: $('#lbl-pwd').text()
            };


            $.ajax({
                type: 'POST',
                url: 'Admin/ResetLockedAccount',
                data: JSON.stringify(requestData),
                dataType: 'json',
                //dataType: 'text',
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    // if success

                    HideLoaderBig();
                     alert(data);
                },
                error: function (xhr, ajaxOptions, thrownError) {
                    //if error

                    // alert('Error : ' + xhr.message);
                    var myCookie = getCookie(".Admin");

                    if (myCookie == null) {
                        // do cookie doesn't exist stuff;
                        alert('Not logged in. Please log in to continue');
                        window.location = '/Login'
                        //xhr.getResponseHeader('Location');
                    }
                    else {

                        alert('Error : ' + xhr.message);
                    }
                    HideLoaderBig();
                },
                complete: function (data) {
                    // if completed
                    HideLoaderBig();

                },
                async: true,
                processData: false
            });


        } catch (err) {

            if (err && err !== "") {
                alert(err.message);
                HideLoaderBig();
            }
        }
    }
    function getCookie(name) {
        var dc = document.cookie;
        var prefix = name + "=";
        var begin = dc.indexOf("; " + prefix);
        if (begin == -1) {
            begin = dc.indexOf(prefix);
            if (begin != 0) return null;
        }
        else {
            begin += 2;
            var end = document.cookie.indexOf(";", begin);
            if (end == -1) {
                end = dc.length;
            }
        }
        return unescape(dc.substring(begin + prefix.length, end));
    }
</script>