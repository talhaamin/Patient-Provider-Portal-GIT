@model IEnumerable<AMR.Models.ProblemModel>
@using System.Text;
@using System.Web.Script.Serialization;

<table class="box-table-a" id="tab-Problems" summary="Appointments">
                                        <thead>
                                            <tr>
                                                <th scope="col" width="120px">Onset Date</th>
                                                <th scope="col" width="520px">Description</th>                                                
                                                <th scope="col">Status</th>
@*                                                <th scope="col" style="text-align:center;" class="showHideThisProblem">Edit</th>
                                                <th scope="col" style="text-align:center;">Details</th>
                                                <th scope="col" style="text-align:center;" class="showHideThisProblem">Delete</th>*@
 


                                            </tr>
                                        </thead>
                                        <tbody>
                                            @if (Model != null && Model.Count()>0)
                                            {
                                                int counter=0;
                                                foreach (var item in Model)
                                                {
                                                    StringBuilder jsonStringProblem = new StringBuilder();

                                                    jsonStringProblem.Append(" { ");
                                                    jsonStringProblem.Append("\"EffectiveDate\": \"" + item.EffectiveDate + "\",");
                                                    jsonStringProblem.Append("\"LastChangeDate\": \"" + item.LastChangeDate + "\",");
                                                    jsonStringProblem.Append("\"Note\": \"" + item.Note + "\",");
                                                    jsonStringProblem.Append("\"CodeValue\":  \"" + item.CodeValue + "\",");
                                                    jsonStringProblem.Append("\"Condition\":  \"" + item.Condition + "\",");
                                                    jsonStringProblem.Append("\"ConditionStatusId\":  \"" + item.ConditionStatusId + "\"");
                                                    jsonStringProblem.Append("}");
                                                
                                                    <tr class="@((counter % 2 == 0) ? "r1" : "r0")" onclick="OpenTabProblemRecord(@item.PatientProblemCntr);">
                                                         @{
                                                    DateTime dtexDate;
                                                    if (item.EffectiveDate.Length == 8 && DateTime.TryParseExact(item.EffectiveDate, "yyyyMMdd", System.Globalization.CultureInfo.InvariantCulture, System.Globalization.DateTimeStyles.None, out dtexDate))
                                                    {
                                                        DateTime dtEff = DateTime.ParseExact(item.EffectiveDate, "yyyyMMdd", null);
                                                        string s = dtEff.ToString("MM/dd/yyyy");

                                                        <td width="120px"><input type="hidden" id="hdProblemTab-@(item.PatientProblemCntr)" value="@jsonStringProblem.ToString()" />@s</td>
                                                    }



                                                    else if ((item.EffectiveDate).Trim().Length == 6)
                                                    {
                                                        string strYear = item.EffectiveDate.Substring(0, 4);
                                                        string strMonth = item.EffectiveDate.Substring(4, 2);
                                                        string strEffectiveDate = strMonth + "/" + strYear;
                                                           <td width="120px"><input type="hidden" id="hdProblemTab-@(item.PatientProblemCntr)" value="@jsonStringProblem.ToString()" />@strEffectiveDate</td>
                                                    }
                                                    else
                                                    {
                                                        <td width="120px"><input type="hidden" id="hdProblemTab-@(item.PatientProblemCntr)" value="@jsonStringProblem.ToString()" />@item.EffectiveDate</td>
                                                    }
                                                
                                                   
                                                       }
                                                        <td width="520px">@item.Condition</td>                                                        
                                                        <td>@item.ConditionStatus </td>
                                                        @*<td align="center" class="showHideThisProblem">  <img onclick="problemEdit(@item.PatientProblemCntr);"   src="Content/img/edit.png" /> </td>
                                                        <td align="center">  <img  onclick="problemDetails(@item.PatientProblemCntr); "   src="Content/img/details.png" />  </td>
                                                        <td align="center" class="showHideThisProblem" >  <img  onclick="problemDelete(@item.PatientProblemCntr);"   src="Content/img/delete.png" />  </td>*@
                                                   </tr>
                                                    counter++;
                                                }
                                            }
                                            else
                                            {
                                               <tr>
                                <td width="200px;">No Information Available.</td>
                            </tr>
                                            }
                                        </tbody>
</table>


