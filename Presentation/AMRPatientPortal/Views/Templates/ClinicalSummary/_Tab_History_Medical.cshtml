@model IEnumerable<AMR.Models.MedicalHistoryModel>
@using System.Text;
@using System.Web.Script.Serialization;


<table class="box-table-a" id="tab-MedicalHistory" summary="Appointments">
                            <thead>
                                <tr>
                                    <th scope="col">Date</th>
                                    <th scope="col">Diagnosis/Disease</th>                                    
                                    <th scope="col" style="text-align:center;" class="showHideThis">Edit</th>
                                    <th scope="col" style="text-align:center;">Details</th>
                                    <th scope="col" style="text-align:center;" class="showHideThis">Delete</th>
                                </tr>
                            </thead>
                            <tbody>
                                @if (Model != null && Model.Count()>0)
                                {
                                    int counter = 0;
                                    foreach (var item in Model)
                                    {
                                        
                                        StringBuilder jsonStringPast = new StringBuilder();

                                        jsonStringPast.Append(" { ");
                                        jsonStringPast.Append("\"PatMedicalHistCntr\": \"" + item.PatMedicalHistCntr + "\",");
                                        jsonStringPast.Append("\"DateOfOccurance\": \"" + item.DateOfOccurance + "\",");
                                        jsonStringPast.Append("\"Description\":  \"" + item.Description + "\",");
                                        jsonStringPast.Append("\"Note\":  \"" + (item.Note) + "\"");
                                        jsonStringPast.Append("}");
                                        
                                    
                                        //var jsonStr = new JavaScriptSerializer().Serialize(item);
                                    
                                        <tr class="@((counter % 2 == 0) ? "r1" : "r0")">
                                            @{
                                                DateTime dtexDate;
                                                if (item.DateOfOccurance.Length == 8 && DateTime.TryParseExact(item.DateOfOccurance, "yyyyMMdd", System.Globalization.CultureInfo.InvariantCulture, System.Globalization.DateTimeStyles.None, out dtexDate))
                                                {
                                                    DateTime dtEff = DateTime.ParseExact(item.DateOfOccurance, "yyyyMMdd", null);
                                                    string s = dtEff.ToString("MM/dd/yyyy");
                                                                                           
                                                    <td><input type="hidden" id="@(item.PatMedicalHistCntr)" value="@jsonStringPast.ToString()" />@s</td>
                                                }
                                                else if ((item.DateOfOccurance).Trim().Length == 6)
                                                {
                                                    string strYear = item.DateOfOccurance.Substring(0, 4);
                                                    string strMonth = item.DateOfOccurance.Substring(4, 2);
                                                    string strOccDate = strMonth + "/" + strYear;
                                                    <td>
                                                        <input type="hidden" id="@(item.PatMedicalHistCntr)" value="@jsonStringPast.ToString()" />@strOccDate
                                                    </td>
                                                }
                                                else
                                                {
                                                     <td>
                                                         <input type="hidden" id="@(item.PatMedicalHistCntr)" value="@jsonStringPast.ToString()" />@item.DateOfOccurance
                                                     </td>
                                                }          
                                             }
                                            <td>@item.Description</td>                                            
                                            <td align="center" class="showHideThis">
                                                 <img onclick="pastHistoryEdit(@item.PatMedicalHistCntr);"   src="Content/img/edit.png" />
                                            </td>
                                            <td align="center">
                                                 <img  onclick="pastHistoryDetails(@item.PatMedicalHistCntr); "   src="Content/img/details.png" />
                                            </td>
                                            <td align="center" class="showHideThis">
                                                 <img  onclick="pastHistoryDelete(@item.PatMedicalHistCntr); "   src="Content/img/delete.png" />
                                            </td>
                                        </tr>
                                        counter++;
                                    }
                                }
                                else
                                {
                                     <tr>
                                <td width="200px;">No Information Available.</td>
                            </tr>
                                }
                            </tbody>
</table>

