@using AMR.Models;
@using AMR.Core.Extensions;
@using System.Text;
@using System.Web.Optimization;
@model HomeViewModel

@{
    ViewBag.Title = "ClinicalSummary";
    Layout = "~/Views/Shared/_LayoutMasterPage.cshtml";
}
@Scripts.Render("~/MedicationIndex/jquery")
@section Scripts
{

    <script>
        function toc(e)
        {
           // alert('problems');
            window.location.hash = '#toc';
            e.preventDefault();
            e.stopPropagation(); 
        }
        $(document).ready(function () {
            var model = @Html.Raw(Json.Encode(Model.FacilityVisitSelect));
            if(model.facilityOptions != null && model.visitOptions != null)
            {
                //alert(model.facilityOptions);
                var VisitHome = document.getElementById('cmbVisitsHome');
                VisitHome.innerHTML = model.visitOptions;
                var FacilityHome = document.getElementById('cmbFacilityHome');
                FacilityHome.innerHTML = model.facilityOptions;
                $('#cmbFacilityHome').val(model.facilitySelected);
                $('#cmbVisitsHome').val(model.visitSelected);
            }
            else{
                $('#cmbFacilityHome').val(model.facilitySelected);
                $('#cmbVisitsHome').val(model.visitSelected);
            }
            if ($('#cmbFacilityHome option:selected').text() == 'Patient Entered') {
                $('#cmbVisitsHome').text("");
                $('#cmbVisitsHome').attr('disabled', true);
            }
            else {
                $('#cmbVisitsHome').attr('disabled', false);
            }
        });
        $(function () {
            $("input[type=submit], a, button")
            .button()
            .click(function (event) {

            });
            $('.full-width').horizontalNav(
{
    responsive: false

});
        });
        
         function pop_up_print_clinicalsummary() {
             chkAccess();
             var page1 = '';
             var facilityId = $('#cmbFacilityHome').val();
             var visitId = $('#cmbVisitsHome').val();
             if(visitId ==null)
             {
                 visitId=0;
             }
             page1 = "@Url.Action("ClinicalSummaryPrint", "ClinicalSummary")" + "/?visitId=" + visitId + "&facilityId=" + facilityId;
             $('#clinical-print').remove();
             var $dialog = $('<div id="clinical-print" style="width:1000px;"></div>')
                            .html('<div id="page_loader1" style="display: block;"><div id="apDiv1" align="center"><table width="200" border="0" cellspacing="0" cellpadding="0"><tr><td height="70px;">&nbsp;</td></tr><tr><td align="center"><img src="Content/img/image_559926.gif" width="128" height="64" /></td></tr><tr><td style="text-align: center;" height="70px;">Please wait ...</td></tr></table></div></div><iframe style="border: 0px; " src="' + page1 + '" width="100%" height="100%"></iframe>')
                            .dialog({
                                autoOpen: false,
                                show: {
                                    effect: "blind",
                                    duration: 100
                                },
                                hide: {
                                    effect: "blind",
                                    duration: 100
                                },
                                modal: true,
                                height: 600,
                                width: 1050,
                                title: "Print Clinical Summary"
                            });
             $dialog.dialog('open');

         }
         function clinicalSummary(id, flag) {
             chkAccess();
             if (flag == 'visit') {
                 sec_arg = $('#cmbFacilityHome option:selected').val();
             }
             else if (flag == 'location') {
                 sec_arg = id;
                 id = $('#cmbVisitsHome option:selected').val();
             }
             var facilityOptions = document.getElementById('cmbFacilityHome').innerHTML;
             var visitOptions = document.getElementById('cmbVisitsHome').innerHTML;
             var facilitySelected = $('#cmbFacilityHome option:selected').val();
             var visitSelected = $('#cmbVisitsHome option:selected').val();
             // alert(facilityOptions);
             // alert(visitOptions);
             if (flag == 'location') {

                 //filling dropdown start 
                 try {
                     ShowLoader();
                     //var IsPrimaryData =
                     var requestData = {

                         FacilityId: sec_arg,
                         ExtensionToggleFunct: " toggle_combobox();",
                         ExtensionFilterFunct: "clinicalSummary(this.value,'visit');",
                         ExtensionIdName: "cmbVisitsHome",
                         facilityOptions: facilityOptions,
                         visitOptions: visitOptions,
                         facilitySelected: facilitySelected,
                         visitSelected: visitSelected
                         // VisitId: id

                     };


                     $.ajax({
                         type: 'POST',
                         url: 'clinical-summary-visit-dropdown',
                         data: JSON.stringify(requestData),
                         dataType: 'json',
                         contentType: 'application/json; charset=utf-8',
                         success: function (data) {
                             // if success

                             $("#homeComboBoxPortlet").html(data);
                             id = $('#cmbVisitsHome option:selected').val();
                             // alert(id);

                             visitOptions = document.getElementById('cmbVisitsHome').innerHTML;
                             visitSelected = $('#cmbVisitsHome option:selected').val();

                             try {
                                 ShowLoader();
                                 //var IsPrimaryData =
                                 var requestData = {

                                     FacilityId: sec_arg,
                                     VisitId: id,
                                     facilityOptions: facilityOptions,
                                     visitOptions: visitOptions,
                                     facilitySelected: facilitySelected,
                                     visitSelected: visitSelected
                                 };


                                 $.ajax({
                                     type: 'POST',
                                     url: 'ClinicalSummary/ClinicalSummaryConsolidate',
                                     data: JSON.stringify(requestData),
                                     dataType: 'json',
                                     contentType: 'application/json; charset=utf-8',
                                     success: function (data) {
                                         // if success
                                         $('#Report').html(data);
                                         HideLoader();
                                         toggle_combobox();
                                     },
                                     error: function (xhr, ajaxOptions, thrownError) {
                                         //if error
                                         var myCookie = getCookie(".Patient");

                                         if (myCookie == null) {
                                             // do cookie doesn't exist stuff;
                                             alert('Not logged in. Please log in to continue');
                                             window.location = '/Login'
                                             //xhr.getResponseHeader('Location');
                                         }
                                         else {

                                             alert('Error : ' + xhr.message);
                                         }
                                         HideLoader();
                                     },
                                     complete: function (data) {
                                         // if completed


                                     },
                                     async: true,
                                     processData: false
                                 });
                             } catch (err) {

                                 if (err && err !== "") {
                                     alert(err.message);
                                 }
                             }


                         },
                         error: function (xhr, ajaxOptions, thrownError) {
                             //if error
                             var myCookie = getCookie(".Patient");

                             if (myCookie == null) {
                                 // do cookie doesn't exist stuff;
                                 alert('Not logged in. Please log in to continue');
                                 window.location = '/Login'
                                 //xhr.getResponseHeader('Location');
                             }
                             else {

                                 alert('Error : ' + xhr.message);
                             }
                             HideLoader();
                         },
                         complete: function (data) {
                             // if completed
                             //  HideLoader();

                         },
                         async: true,
                         processData: false
                     });
                 } catch (err) {

                     if (err && err !== "") {
                         alert(err.message);
                     }
                 }
                 //filling visit drop down end
             }


             if (flag == 'visit') {
                 //start Consolidate Call For Home Widgets Filter....
                 visitOptions = document.getElementById('cmbVisitsHome').innerHTML;
                 visitSelected = $('#cmbVisitsHome option:selected').val();
                 // alert(visitOptions);
                 // alert(visitSelected);
                 try {
                     ShowLoader();
                     //var IsPrimaryData =
                     var requestData = {

                         FacilityId: sec_arg,
                         VisitId: id,
                         facilityOptions: facilityOptions,
                         visitOptions: visitOptions,
                         facilitySelected: facilitySelected,
                         visitSelected: visitSelected
                     };


                     $.ajax({
                         type: 'POST',
                         url: 'ClinicalSummary/ClinicalSummaryConsolidate',
                         data: JSON.stringify(requestData),
                         dataType: 'json',
                         contentType: 'application/json; charset=utf-8',
                         success: function (data) {
                             // if success
                             $('#Report').html(data);
                             HideLoader();
                             toggle_combobox();
                         },
                         error: function (xhr, ajaxOptions, thrownError) {
                             //if error
                             var myCookie = getCookie(".Patient");

                             if (myCookie == null) {
                                 // do cookie doesn't exist stuff;
                                 alert('Not logged in. Please log in to continue');
                                 window.location = '/Login'
                                 //xhr.getResponseHeader('Location');
                             }
                             else {

                                 alert('Error : ' + xhr.message);
                             }
                             HideLoader();
                         },
                         complete: function (data) {
                             // if completed


                         },
                         async: true,
                         processData: false
                     });
                 } catch (err) {

                     if (err && err !== "") {
                         alert(err.message);
                     }
                 }

             }
             //ending Consolidate Call For Home Widgets Filter....

         }
    </script>

    <script>
       
        function toggle_combobox() {
            if ($('#cmbFacilityHome :selected').text() != 'Patient Entered') {
                $('#cmbVisitsHome').attr('disabled', false);
            }

            else {

                $('#cmbVisitsHome').text("");
                $('#cmbVisitsHome').attr('disabled', true);
                //$('#cmbVisitsHome').val(0);
                //  $('#createPresentMedication,#createaddstatements,#createaddproblems,#addvitalscreation,#createaddimmunizations,#createaddPOC,#createaddClinicalInstructions,#createaddProcedures,#createaddallergies,#addvitalscreation,#createaddpast,#createaddfamily,#createaddappointments,#createaddsocial').css('display', 'block');
            }

        }

       

    </script>
}
<div id="containment-wrapper" style="border-bottom-style: none; border-top-style: none; border-right-style: none; border-left-width: 1px; border-left-color: rgb(166, 201, 226);">
    <div id="quicklinks" class="draggable ui-widget-content ui-corner-all" style="position: absolute; top: 20px; left: 3%; width: 94%; height: 70px;display:none;">
        <div id="cart" style="position: absolute; top: 1px; left: 0px; right: 0px;" class="ui-corner-all">
               <input id="hdFlag" type="hidden" value=" " />
            <div class="ui-widget-content" style="position: relative; top: 0px; border: none;">

               @* <button  onclick="ControllMessageCompose();HidevaluecmbMessageType()"id="createmsg"  class="beer ui-button ui-widget ui-state-default ui-corner-all"  style="font-size: 0.9em; font-weight: normal" title="Send Message" type="submit">
                    <img src="Content/img/2.png" />&nbsp;&nbsp;Compose Message</button>

                <button   onclick="ControllAppointment();" id="createappbtn"  class="beer ui-button ui-widget ui-state-default ui-corner-all" style="font-size: 0.9em; font-weight: normal" title="Request Appointment" type="submit">
                    <img src="Content/img/3.png" style="margin-left:-7px;" />&nbsp;&nbsp;Appointment Request</button>


                <button id="refillMEd"   onclick="RefillDialog(); ControllRefill();" role="button" aria-disabled="false" class="beer ui-button ui-widget ui-state-default ui-corner-all" style="font-size: 0.9em; font-weight: normal"  title="Refill Medication" type="submit">
                    <img src="Content/img/4.png" />Refill Request</button>

                <button   onclick="ControllReferall();" id="createreqbtn"  class="beer ui-button ui-widget ui-state-default ui-corner-all" style="font-size: 0.9em; font-weight: normal" title="Request Referral" type="submit">
                    <img src="Content/img/1.png" />&nbsp;&nbsp;Referral Request</button>*@
                   @if (@AMR.Core.Utilities.RequestHelper.MyGlobalVar.GeneralMessageAvailable){
                <button    onclick="ControllMessageCompose();HidevaluecmbMessageType()"id="createmsg"  class="beer ui-button ui-widget ui-state-default ui-corner-all"  style="font-size: 0.9em; font-weight: normal" title="Send Message" type="submit">
                    <img src="Content/img/2.png" />&nbsp;&nbsp;Compose Message</button>
                }
                else
                {
                      <button    onclick="ControllMessageCompose();HidevaluecmbMessageType()"id="createmsg"  class="beer ui-button ui-widget ui-state-default ui-corner-all"  style="font-size: 0.9em; font-weight: normal" title="Send Message" disabled="disabled" type="submit">
                    <img src="Content/img/2.png" />&nbsp;&nbsp;Compose Message</button>
                }
                @if (@AMR.Core.Utilities.RequestHelper.MyGlobalVar.AppointmentMessageAvailable)
                {
                <button   onclick="ControllAppointment();" id="createappbtn" class="beer ui-button ui-widget ui-state-default ui-corner-all" style="font-size: 0.9em; font-weight: normal" title="Request Appointment" type="submit">
                    <img src="Content/img/3.png" style="margin-left:-7px;" />&nbsp;&nbsp;Appointment Request</button>
                }
                else
                {
                      <button   onclick="ControllAppointment();" id="createappbtn" class="beer ui-button ui-widget ui-state-default ui-corner-all" style="font-size: 0.9em; font-weight: normal" title="Request Appointment" disabled="disabled" type="submit">
                    <img src="Content/img/3.png" style="margin-left:-7px;" />&nbsp;&nbsp;Appointment Request</button>
                }

                @if (@AMR.Core.Utilities.RequestHelper.MyGlobalVar.MedicationMessageAvailable)
                {
                <button id="refillMEd"   onclick="RefillDialog(); ControllRefill();" role="button" aria-disabled="false" class="beer ui-button ui-widget ui-state-default ui-corner-all" style="font-size: 0.9em; font-weight: normal"  title="Refill Medication" type="submit">
                    <img src="Content/img/4.png" />Refill Request</button>
                }
                else
                {
                     <button id="refillMEd"   onclick="RefillDialog(); ControllRefill();" role="button" aria-disabled="false" class="beer ui-button ui-widget ui-state-default ui-corner-all" style="font-size: 0.9em; font-weight: normal"  title="Refill Medication" disabled="disabled" type="submit">
                    <img src="Content/img/4.png" />Refill Request</button>
                }
              
                  @if (AMR.Core.Utilities.RequestHelper.MyGlobalVar.ReferralMessageAvailable)
                  {
                <button    onclick="ControllReferall();" id="createreqbtn"  class="beer ui-button ui-widget ui-state-default ui-corner-all" style="font-size: 0.9em; font-weight: normal" title="Request Referral" type="submit">
                    <img src="Content/img/1.png" />&nbsp;&nbsp;Referral Request</button>
                  }
                  else
                  {
                     <button    onclick="ControllReferall();" id="createreqbtn"  class="beer ui-button ui-widget ui-state-default ui-corner-all" style="font-size: 0.9em; font-weight: normal" title="Request Referral" disabled="disabled" type="submit">
                    <img src="Content/img/1.png" />&nbsp;&nbsp;Referral Request</button>
                  }
            </div>
        </div>
    </div>
    <div id="Div1" class="draggable ui-widget-content ui-corner-all" style="position: absolute; top: 5px; left: 3%; width: 94%; height: 35px;">
        <div id="Div2" style="position: absolute; top: 1px; left: 0px; right: 0px;" class="ui-corner-all">

            <div id="combo-row" class="ui-widget-content">
                <ul>

                    <li class="col0 "><p style="margin-top:3px;margin-left:10px;">Location</p> </li>
                    <li class="col1">
                        @Html.DropDownList("cmbFacilityHome", Model.Facilities.ToFacilityModelSelectList(), new { @class = "txt", style = "width:100%;", id = "cmbFacilityHome", @onchange = "clinicalSummary(this.value,'location'); toggle_combobox();  " })

                    </li>
                    <li class="col0"><p style="margin-top:3px;margin-left:10px;">Visit Date</p></li>
                    <li class="col1">
                        <div id="homeComboBoxPortlet">@Html.DropDownList("cmbVisitsHome", Model.Visits.ToVisitModelSelectList(), new { @class = "txt", style = "width:100%;", id = "cmbVisitsHome", @onchange = " clinicalSummary(this.value,'visit'); toggle_combobox();" }) </div>
                    </li>

                </ul>
            </div>
        </div>
    </div>
    <div id="ClinicalIndex" style="position: absolute; top: 45px; left: 0px; right: 5px; width: 950px; height: 1090px; border: 1px solid #A6C9E2;" class="ui-corner-all">
    </div>
    <div id="ClinicalIndexSub" style="">
        <h5 class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix" style="margin-top: 15px; margin-left: 2px; font-weight: bold; width: 950px; padding: 3px;">Clinical Summary
                                        <!-- second ICON -->

            <!-- end of second icon-->


            <!-- third ICON -->
            <div id="#" onmousemove="removing_class();" onmouseover="removing_class(); " onmousedown="removing_class();" onclick="pop_up_print_clinicalsummary();" onmouseout="removing_class();" onmouseup="removing_class();" onfocus="removing_class(); " style="cursor: pointer; float: right; width: auto; height: 20px;">
                <img src="Content/img/print.png" />
                <span class="anc" style="padding-right: 4px;">Print</span>
            </div>
            <!-- end of third icon-->



        </h5>
    </div>
    <div id="ClinicalIndexsub1" >
        <div id="Report" style="color:black;">

           @* @Html.Partial("~/Views/Templates/ClinicalSummary/_Clinical_Summary_Partial.cshtml", Model)*@
            <div id="PatientSummary">

            <table width="100%">
                <tr><td colspan="6"></td></tr>

                <tr>
                    
    
                    <td height="54" colspan="5" align="center">
                        
                       
                        <h2>Created On: @DateTime.Now.ToString("MMMM dd, yyyy hh:mm:ss tt")</h2>


                    </td>
                    <td>&nbsp;</td>
                </tr>
                <tr>
                    <td>
                        @*<input type="checkbox" id="chkDemo" name="checkbox" checked="checked" /><label for="chkDemo"><strong>Include Demographics</strong></label>*@</td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td width="153" height="28"><strong>Patient :</strong></td>
                    <td width="269" height="28">@Model.PatientSummary.FirstName @Model.PatientSummary.LastName</td>
                    <td width="4">&nbsp;</td>
                    <td width="152" height="28"><strong>Access ID : </strong></td>
                    <td width="370" height="28">@Model.PatientSummary.PatientId</td>
                    <td width="2">&nbsp;</td>
                </tr>
                <tr>
                    <td height="28"><strong>Address :</strong></td>
                    <td>@Model.PatientSummary.PAddress<br>
                        @Model.PatientSummary.City, @Model.PatientSummary.State @Model.PatientSummary.Zip<br>
                    </td>
                    <td>&nbsp;</td>
                    <td height="28"><strong>Work Phone :</strong></td>
                    <td height="28">@Model.PatientSummary.WorkPhone</td>
                    <td>&nbsp;</td>
                </tr>
                <tr>
                    <td height="28"><strong>Date of Birth :</strong></td>
                    <td>@Model.PatientSummary.DOB</td>
                    <td>&nbsp;</td>
                    <td><strong>Mobile Phone :</strong></td>
                    <td>@Model.PatientSummary.MobilePhone</td>
                    <td>&nbsp;</td>
                </tr>
                <tr>
                    <td height="28" width="160"><strong>Preferred Language :</strong></td>
                    <td>@Model.PatientSummary.PreferredLanguage</td>
                    <td>&nbsp;</td>
                    <td><strong>Sex :</strong></td>
                    <td>@Model.PatientSummary.Gender</td>
                    <td>&nbsp;</td>
                </tr>
                <tr>
                    <td height="28"><strong>Ethnicity :</strong></td>
                    <td>@Model.PatientSummary.Ethnicity</td>
                    <td>&nbsp;</td>
                    <td><strong>Race :</strong></td>
                    <td>@Model.PatientSummary.Race</td>
                    <td>&nbsp;</td>
                </tr>
                <tr>
                    <td height="28">
                        @*<input type="checkbox" id="chkprovider" name="chkprovider" checked="checked" /><strong><label for="chkprovider">Include Provider</label></strong>*@</td>

                    <td></td>
                    <td>&nbsp;</td>
                    <td></td>
                    <td></td>
                    <td>&nbsp;</td>
                </tr>
                <tr>
                    <td height="28"><strong>Provider :</strong></td>
                    <td>@Model.PatientVisitCCD.Title @Model.PatientVisitCCD.FirstName @Model.PatientVisitCCD.LastName </td>
                    <td>&nbsp;</td>
                   @*  <td ><strong>Reason For Visit :</strong></td>
      <td>@Model.PatientVisitCCD.VisitReason</td>
      <td>&nbsp;</td>*@
                </tr>
                <tr>
                    <td height="28"><strong>Practice Name :</strong></td>
                    <td>@Model.PatientVisitCCD.FacilityName

                    </td>
                    <td>&nbsp;</td>
                </tr>
                <tr>
                    <td height="28"><strong></strong></td>
                    <td>@Model.PatientVisitCCD.Address1
                        <br />
                        @Model.PatientVisitCCD.City, @Model.PatientVisitCCD.State @Model.PatientVisitCCD.PostalCode
                    </td>
                    <td>&nbsp;</td>
                </tr>
                <tr>
                    <td height="28"><strong>Practice Phone :</strong></td>
                    <td>@Model.PatientVisitCCD.FacilityPhone
                    </td>
                    <td>&nbsp;</td>
                </tr>
               <tr>
                    <td height="28">
                        @*<input type="checkbox" id="chkvisit" name="chkvisit" checked="checked" /><strong><label for="chkvisit">Include Visit Information</label></strong>*@</td>

                    <td></td>
                    <td>&nbsp;</td>
                    <td></td>
                    <td></td>
                    <td>&nbsp;</td>
                </tr>
                 <tr>
                    <td height="28"><strong>Visit Date :</strong></td>
                    <td>@Model.PatientVisitCCD.VisitDate
                    </td>
                    <td>&nbsp;</td>
                </tr>
                 <tr>
                    <td height="28"><strong>Visit Location :</strong></td>
                    <td>@Model.PatientVisitCCD.Address1
                        <br />
                        @Model.PatientVisitCCD.City, @Model.PatientVisitCCD.State @Model.PatientVisitCCD.PostalCode
                    </td>
                    <td>&nbsp;</td>
                </tr>
            </table>
        </div>
        <div>
            <h3><span id="toc">Table of Contents</span></h3>
           @* <img id="loader" src="https://www.amrportal.com/Content/img/login-loader.gif" alt="Loading..." style="display: none;">*@
            <ul>
                 <li><span class="anc"  onclick="location.href='#widget_Reason'" >Reason For Visit/Chief Complaint</span></li>
                 <li><span class="anc" onclick="location.href='#widget_Medications Administered'" >Medications Administered During Visit</span></li>
                <li><span class="anc"  onclick="location.href='#widget_Medications'" >Medications</span></li>
                <li><span class="anc" onclick="location.href='#widget_Problems'" >Problems</span></li>
                <li><span class="anc" onclick="location.href='#widget_Allergies, Adverse Reactions, Alerts'"  >Allergies, Adverse Reactions, Alerts</span></li>
                <li><span class="anc" onclick="location.href='#widget_Immunizations'"  >Immunizations</span></li>
                <li><span class="anc" onclick="location.href='#widget_Social History'"  >Social History</span></li>
                <li><span class="anc" onclick="location.href='#widget_Family History'"  >Family History</span></li>
                <li><span class="anc" onclick="location.href='#widget_Procedures'"  >Procedures</span></li>
                <li><span class="anc" onclick="location.href='#widget_Medical History'"  >Medical History</span></li>
                <li><span class="anc" onclick="location.href='#widget_Vital Signs'" >Vital Signs</span></li>
                <li><span class="anc" onclick="location.href='#widget_Lab Tests'"  >Lab Tests</span></li>
                <li><span class="anc" onclick="location.href='#widget_Plan Of Care'"  >Care Plan</span></li>
                <li><span class="anc" onclick="location.href='#widget_ClinicalInstructions'"  >Clinical Instructions</span></li>
            </ul>
        </div>
        <div id="widgets">
           @* @if (Model.Medications != null && Model.Medications.Count > 0)
            {
                *@
            
            <div class="uploadBox" id="widget_Reason">

                    <h3><span style="font-weight: bold;"><label for="chkRes"><span> Reason For Visit/Chief Complaint</span></label></span><span style="float: right;color:blue;margin-top:-10px;" href="#toc" onclick="toc(); " class="anc">Top</span></h3>
                    <div class="widgetTable">

                        <table class="widget" summary="VisitReason" id="EditReason" border="1" width="100%">
                            <thead>
                                <tr>
                                    
                                    <th style="display:none"></th>
                                    <th>Reason For Visit/Chief Complaint</th>
                                    
                                </tr>
                            </thead>


                            <tbody>
                               
                                    <tr>
                                         <td style="display:none">
                                            <input type="hidden" value="1" />
                                        </td>
                                        <td>@Model.PatientVisitCCD.VisitReason</td>
                                        
                                    </tr>
                                
                            </tbody>

                        </table>
                    </div>
                </div>
            <div class="uploadBox" id="widget_Medications Administered">
                    <h3><span style="font-weight: bold;"><label for="chkmedAdm"><span>Medications Administered During Visit</span></label></span><span style="float: right;color:blue;margin-top:-10px;" href="#toc" onclick="toc(); " class="anc">Top</span></h3>
                    <div class="widgetTable">

                        <table class="widget" summary="MedsAdministered" border="1" width="100%">
                            <thead>
                                <tr>
                                    
                                    <th>RxNorm Code</th>
                                    <th>Product</th>
                                    <th>Medication Name</th>
                                    <th>Frequency</th>
                                    <th>Date Started</th>
                                    <th>Status</th>
                                    <th>Notes</th>
                                </tr>
                            </thead>


                            <tbody>
                                @foreach (var item in Model.MedicationsAdministered)
                                {
                                    <tr>
                                        <td>
                                            <input type="hidden" value="@item.PatientMedicationCntr" />@item.CodeValue</td>
                                        <td>Medication</td>
                                        <td>@item.MedicationName</td>
                                        <td>@item.Frequency</td>
                                         @if (Convert.ToDateTime(item.StartDate).ToShortTimeString() == "12:00 AM") 
                                    {
                                        <td>@Convert.ToDateTime(item.StartDate).ToShortDateString()</td>
                                    }
                                     else
                                    {
                                       <td>@item.StartDate</td> 
                                    }                                        
                                        <td>@item.Status</td>
                                        <td>@item.Note</td>
                                    </tr>
                                }
                            </tbody>

                        </table>
                    </div>
                </div>
            <div class="uploadBox" id="widget_Medications">
                    <h3><span style="font-weight: bold;">
                    <label for="chkmed"><span>Medications</span></label></span><span style="float: right;color:blue;margin-top:-10px;" href="#toc" onclick="toc(); " class="anc">Top</span></h3>
                    <div class="widgetTable">

                        <table class="widget" summary="Medications" border="1" width="100%">
                            <thead>
                                <tr>
                                    
                                    <th>RxNorm Code</th>
                                    <th>Product</th>
                                    <th>Medication Name</th>
                                    <th>Frequency</th>
                                    <th>Date Started</th>
                                    <th>Status</th>
                                    <th>Notes</th>
                                </tr>
                            </thead>


                            <tbody>
                                @foreach (var item in Model.Medications)
                                {
                                    <tr>
                                        <td>
                                            <input type="hidden" value="@item.PatientMedicationCntr" />@item.CodeValue</td>
                                        <td>Medication</td>
                                        <td>@item.MedicationName</td>
                                        <td>@item.Frequency</td>
                                    @if (Convert.ToDateTime(item.StartDate).ToShortTimeString() == "12:00 AM") 
                                    {
                                        <td>@Convert.ToDateTime(item.StartDate).ToShortDateString()</td>
                                    }
                                     else
                                    {
                                       <td>@item.StartDate</td> 
                                    }

                                        <td>@item.Status</td>
                                        <td>@item.Note</td>
                                    </tr>
                                }
                            </tbody>

                        </table>
                    </div>
                </div>
           @* }
            @if (Model.Problems != null && Model.Problems.Count > 0)
            {
                *@
            <div class="uploadBox" id="widget_Problems">
                    <h3><span style="font-weight: bold;">
                        
                        <label for="chkProblems"><span>Problems</span></label></span><span style="float: right;color:blue;margin-top:-10px;" href="#toc" onclick="toc(); " class="anc">Top</span></h3>
                    <div class="widgetTable">
                        <table class="widget" summary="Problems" border="1" width="100%">
                            <thead>
                                <tr>
                                    
                                    <th>SNOMED Code</th>
                                    <th>Patient Problem</th>
                                    <th>Status</th>
                                    <th>Date Diagnosed</th>
                                </tr>
                            </thead>


                            <tbody>
                                @foreach (var item1 in Model.Problems)
                                {
		 
                                    <tr>
                                      

                                        <td>@item1.CodeValue<input type="hidden" value="@item1.PatientProblemCntr" /></td>
                                        <td>@item1.Condition</td>
                                        <td>@item1.ConditionStatus</td>                                        
                                           @{
                                    DateTime dtexDate;
                                    if (item1.EffectiveDate.Length == 8 && DateTime.TryParseExact(item1.EffectiveDate, "yyyyMMdd", System.Globalization.CultureInfo.InvariantCulture, System.Globalization.DateTimeStyles.None, out dtexDate))
                                    {
                                        DateTime dtEff = DateTime.ParseExact(item1.EffectiveDate, "yyyyMMdd", null);
                                        string s = dtEff.ToString("MM/dd/yyyy");

                                        <td>@s</td>
                                    }



                                    else if ((item1.EffectiveDate).Trim().Length == 6)
                                    {
                                        string strYear = item1.EffectiveDate.Substring(0, 4);
                                        string strMonth = item1.EffectiveDate.Substring(4, 2);
                                        string strEffectiveDate = strMonth + "/" + strYear;
                                        <td>@strEffectiveDate</td>
                                    }
                                    else
                                    {
                                        <td>@item1.EffectiveDate</td>
                                    }
                                                   
                                                   
                                    }

                                    </tr>
                                }
                            </tbody>

                        </table>
                    </div>
                </div>
            @*}
            @if (Model.Allergies != null && Model.Allergies.Count > 0)
            {
                *@<div class="uploadBox" id="widget_Allergies, Adverse Reactions, Alerts">
                    <h3><span style="font-weight: bold;">
                        <label for="ckhallergies"><span>Allergies, Adverse Reactions, Alerts</span></label></span><span style="float: right;color:blue;margin-top:-10px;" href="#toc" onclick="toc(); " class="anc">Top</span></h3>
                    <div class="widgetTable">
                        <table class="widget" summary="Allergies" border="1" width="100%">
                            <thead>
                                <tr>                                    
                                    <th>SNOMED Code</th>
                                    <th>RxNorm Code</th>
                                    <th>Medication/Agent Allergy</th>
                                    <th>Reaction</th>
                                    <th>Status</th>
                                </tr>
                            </thead>


                            <tbody>
                                @foreach (var item2 in Model.Allergies)
                                {
                                    <tr>
                                        

                                        <td><input type="hidden" value="@item2.PatientAllergyCntr" /></td>
                                        <td>@item2.CodeValue_Allergen</td>
                                        <td>@item2.Allergen</td>
                                        <td>@item2.Reaction</td>
                                        <td>@item2.ConditionStatus</td>
                                    </tr>
                                }
                            </tbody>


                        </table>
                    </div>
                </div>
            @*}
            @if (Model.Immunizations != null && Model.Immunizations.Count > 0)
            {
                *@<div class="uploadBox" id="widget_Immunizations">
                    <h3><span style="font-weight: bold;">
                        <label for="chkImmunizations"><span>Immunizations</span></label></span><span style="float: right;color:blue;margin-top:-10px;" href="#toc" onclick="toc(); " class="anc">Top</span></h3>
                    <div class="widgetTable">
                        <table class="widget" summary="Immunizations" border="1" width="100%">
                            <thead>
                                <tr>
                                    
                                    <th>Vaccine</th>
                                    <th>Date</th>
                                    <th>Status</th>
                                </tr>
                            </thead>



                            <tbody>
                                @foreach (var item3 in Model.Immunizations)
                                {
                                    <tr>
                                       
                                        <td>
                                            <input type="hidden" value="@item3.PatientImmunizationCntr" />@item3.Vaccine</td>
                                        <td>@item3.ImmunizationDate</td>
                                        <td>Completed</td>
                                    </tr>
                                }
                            </tbody>

                        </table>
                    </div>
                </div>
           @* }
            @if (Model.SocialHistories != null && Model.SocialHistories.Count > 0)
            {
                *@<div class="uploadBox" id="widget_Social History">
                    <h3><span style="font-weight: bold;"><label for="chkSocial"><span> Social History</span></label></span><span style="float: right;color:blue;margin-top:-10px;" href="#toc" onclick="toc(); " class="anc">Top</span></h3>
                    <div class="widgetTable">
                        <table class="widget" summary="Social" border="1" width="100%">
                            <thead>
                                <tr>
                                    
                                    <th>Code System</th>
                                    <th>Code</th>
                                    <th>Description</th>
                                    <th>Begin Date</th>
                                    <th>End Date</th>
                                </tr>
                            </thead>



                            <tbody>
                                @foreach (var item4 in Model.SocialHistories)
                                {
                                    <tr>
                                        
                                        <td>
                                            <input type="hidden" value="@item4.PatSocialHistCntr" />
                                            @item4.CodeSystem</td>
                                        <td>@item4.CodeValue</td>
                                        <td>@item4.Description</td>
                                         @{
                                            DateTime dtBDate;
                                            if (item4.BeginDate.Length == 8 && DateTime.TryParseExact(item4.BeginDate, "yyyyMMdd", System.Globalization.CultureInfo.InvariantCulture, System.Globalization.DateTimeStyles.None, out dtBDate))
                                            {
                                                DateTime dtOcc = DateTime.ParseExact(item4.BeginDate, "yyyyMMdd", null);
                                                string s = dtOcc.ToString("MM/dd/yyyy");

                                                <td>@s</td>
                                            }
                                            else if ((item4.BeginDate).Trim().Length == 6)
                                            {
                                                string strYear = item4.BeginDate.Substring(0, 4);
                                                string strMonth = item4.BeginDate.Substring(4, 2);
                                                string strBDate = strMonth + "/" + strYear;
                                                <td>@strBDate</td>
                                            }
                                            else
                                            {
                                                <td>@item4.BeginDate</td>
                                            }      
                                          }
                                         
                                         @{
                                            DateTime dtEDate;
                                            if (item4.EndDate.Length == 8 && DateTime.TryParseExact(item4.EndDate, "yyyyMMdd", System.Globalization.CultureInfo.InvariantCulture, System.Globalization.DateTimeStyles.None, out dtEDate))
                                                {
                                                    DateTime dtEndDate = DateTime.ParseExact(item4.EndDate, "yyyyMMdd", null);
                                                    string s = dtEndDate.ToString("MM/dd/yyyy");

                                                    <td>@s</td>
                                                }
                                            else if ((item4.EndDate).Trim().Length == 6)
                                                {
                                                    string strYear = item4.EndDate.Substring(0, 4);
                                                    string strMonth = item4.EndDate.Substring(4, 2);
                                                    string strEDate = strMonth + "/" + strYear;
                                                    <td>@strEDate</td>
                                                }
                                                else
                                                {
                                                    <td>@item4.EndDate</td>
                                                }
                            
                                                   
                                         }
                                    </tr>
                                }
                            </tbody>

                        </table>
                    </div>
                </div>
          @*  }
             @if (Model.Procedures != null && Model.Procedures.Count > 0)
            {
            *@
            <div class="uploadBox" id="widget_Family History">
                    <h3><span style="font-weight: bold;"><label for="chkSocial"><span> Family History</span></label></span><span style="float: right;color:blue;margin-top:-10px;" href="#toc" onclick="toc(); " class="anc">Top</span></h3>
                    <div class="widgetTable">
                        <table class="widget" summary="Family History" border="1" width="100%">
                            <thead>
                                <tr>
                                    
                                    <th>Code System</th>
                                    <th>Code Relationship</th>
                                    <th>Description</th>
                                </tr>
                            </thead>



                            <tbody>
                                @foreach (var item4 in Model.FamilyHistories)
                                {
                                    <tr>
                                        
                                        <td>
                                            <input type="hidden" value="@item4.PatFamilyHistCntr" />
                                            @item4.CodeSystem</td>
                                        <td>@item4.Relationship</td>
                                        <td>@item4.Description</td>
                                    </tr>
                                }
                            </tbody>

                        </table>
                    </div>
                </div>

            <div class="uploadBox" id="widget_Procedures">
                <h3><span style="font-weight: bold;"><label for="chkProcedures"><span>Procedures</span></label>
                    </span><span style="float: right;color:blue;margin-top:-10px;" href="#toc" onclick="toc(); " class="anc">Top</span></h3>
                <div class="widgetTable">
                    <table class="widget" summary="Procedures" border="1" width="100%">
                        <thead>
                            <tr>
                                
                                <th>Code System</th>
                                <th>Code</th>
                                <th>Description</th>
                                <th>Date</th>
                            </tr>
                        </thead>
                        <tbody>
                              @foreach (var item in Model.Procedures)
                                {
                            <tr>
                                 <td>
                                            <input type="hidden" value="@item.PatProcedureCntr" />
                                    @item.CodeSystem
                                             </td>
                                <td>@item.CodeValue</td>
                                <td>@item.Description</td>
                                <td>1/15/2014</td>
                            </tr>
                              }
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="uploadBox" id="widget_Medical History">
                    <h3><span style="font-weight: bold;"><label for="chkMedical"><span> Medical History</span></label></span><span style="float: right;color:blue;margin-top:-10px;" href="#toc" onclick="toc(); " class="anc">Top</span></h3>
                    <div class="widgetTable">
                        <table class="widget" summary="Medical History" border="1" width="100%">
                            <thead>
                                <tr>
                                    
                                    <th>Code System</th>
                                    <th>Code Date</th>
                                    <th>Diagnosis/Disease</th>
                                </tr>
                            </thead>



                            <tbody>
                                @foreach (var item in Model.MedicalHistories)
                                {
                                    <tr>
                                        
                                        <td>
                                            <input type="hidden" value="@item.PatMedicalHistCntr" />
                                            @item.Note</td>
                                        <td>
                                            @{
                                                DateTime dtexDate;
                                                if (item.DateOfOccurance.Length == 8 && DateTime.TryParseExact(item.DateOfOccurance, "yyyyMMdd", System.Globalization.CultureInfo.InvariantCulture, System.Globalization.DateTimeStyles.None, out dtexDate))
                                                {
                                                    DateTime dtEff = DateTime.ParseExact(item.DateOfOccurance, "yyyyMMdd", null);
                                                    string s = dtEff.ToString("MM/dd/yyyy");
                                                                                           
                                                    @s
                                                }
                                                else if ((item.DateOfOccurance).Trim().Length == 6)
                                                {
                                                    string strYear = item.DateOfOccurance.Substring(0, 4);
                                                    string strMonth = item.DateOfOccurance.Substring(4, 2);
                                                    string strOccDate = strMonth + "/" + strYear;
                                                    
                                                     @strOccDate
                                                    
                                                }
                                                else
                                                {
                                                    @item.DateOfOccurance
                                                }          
                                             }
                                        </td>
                                        <td>@item.Description</td>
                                    </tr>
                                }
                            </tbody>

                        </table>
                    </div>
                </div>
            @* }
             @if (Model.VitalSigns != null && Model.VitalSigns.Count > 0)
            {
            *@<div class="uploadBox" id="widget_Vital Signs">
                <h3><span style="font-weight: bold;"><label for="chkVitalSigns"><span>Vital Signs</span></label>
                    </span><span style="float: right;color:blue;margin-top:-10px;" href="#toc" onclick="toc(); " class="anc">Top</span></h3>
                <div class="widgetTable">
                    <table class="widget" summary="VitalSigns" border="1" width="100%">
                        <thead>
                            <tr>
                                
                                <th>Date / Time</th>
                                <th>BP-Sys(mm[Hg]</th>
                                <th>BP-Dia(mm[Hg]</th>
                                <th>HR(bpm)</th>
                                <th>RR(rpm)</th>
                                <th>Temp</th>
                                <th>WT</th>
                                <th>HT</th>
                                <th>BMI</th>
                            </tr>
                        </thead>
                        <tbody>
                             @foreach (var item in Model.VitalSigns)
                                {
                            <tr>
                             
                             @if (Convert.ToDateTime(item.VitalDate).ToShortTimeString() == "12:00 AM")
                             {
                                <td>
                                            <input type="hidden" value="@item.PatientVitalCntr" />
                                             @Convert.ToDateTime(item.VitalDate).ToShortDateString()</td>
                             }
                             else
                             {
                                 <td>
                                            <input type="hidden" value="@item.PatientVitalCntr" />
                                             @item.VitalDate</td>
                             }

                                <td>@item.Systolic</td>
                                <td>@item.Diastolic</td>
                                <td>@item.Pulse</td>
                                <td>@item.Respiration</td>
                                <td>@item.Temperature</td>
                                <td>@item.WeightLb</td>
                                <td>@item.HeightIn</td>
                                <td>@*27.5*@</td>
                            </tr>
                             }
                        </tbody>
                    </table>
                </div>
            </div>
           @*  }
            @if (Model.LabResults != null && Model.LabResults.Count > 0)
            {
                *@<div class="uploadBox" id="widget_Lab Tests">
                    <h3><span style="font-weight: bold;"><label for="ckhDiagnostic"><span> Lab Tests</span></label></span><span style="float: right;color:blue;margin-top:-10px;" href="#toc" onclick="toc(); " class="anc">Top</span></h3>
                    <div class="widgetTable">
                        <table class="widget" summary="LabResults" border="1" width="100%">
                            <thead>
                                <tr>
                                    
                                    <th>Test</th>
                                    <th>Result</th>
                                    <th>Ref. Range</th>
                                    <th>Abnormal Flag</th>
                                    <th>Date Performed</th>
                                    <th>Set</th>
                                    <th>Code System</th>
                                    <th>Code</th>
                                </tr>
                            </thead>


                            <tbody>
                                @foreach (var item5 in Model.LabResults)
                                {
                          
                                    <tr>
                                      
                                        <td>@item5.LabName<input type="hidden" value="@item5.LabResultCntr" /></td>
                                        <td>@item5.Result</td>
                                        <td>@item5.RefRange</td>
                                        <td>@item5.Abnormal</td>                                       
                                         @if (item5.ReportDate.ToString() == "1/1/1900 00:00:00" || item5.ReportDate.ToString() == "1/1/1900 12:00:00 AM")
                                    {
                                        <td></td>
                                    }
                                          else if (Convert.ToDateTime(item5.ReportDate).ToShortTimeString() == "12:00 AM")
                                    {
                                        <td>@Convert.ToDateTime(item5.ReportDate).ToShortDateString()</td> 
                                    }
                                    else
                                    {
                                       <td>@item5.ReportDate</td> 
                                    } 
                                        <td></td>
                                        <td>@item5.CodeSystemId</td>
                                        <td>@item5.CodeValue</td>
                                    </tr>
                  
                                }
                            </tbody>

                        </table>
                    </div>
                </div>
           @* }
            @if (Model.Pocs != null && Model.Pocs.Count > 0)
            {
                *@<div class="uploadBox" id="widget_Plan Of Care">
                    <h3><span style="font-weight: bold;"><label for="chkplan"><span> Care Plan</span></label></span><span style="float: right;color:blue;margin-top:-10px;" href="#toc" onclick="toc(); " class="anc">Top</span></h3>
                    <div class="widgetTable">
                        <table class="widget" id="EditPOC" summary="POC" border="1" width="100%">
                            <thead>
                                <tr>
                                    
                                    <th>Type</th>
                                    <th>Code System</th>
                                    <th>Code</th>                                    
                                    <th>Instructions</th>
                                    <th>Comments</th>
                                    <th>Planned Date/Time</th>
                                    <th>Plan/Goal</th>
                                    
                                </tr>
                            </thead>

                            <tbody>

                                @foreach (var item in Model.Pocs)
                                {
                               
                           
                                    <tr>
                                        
                                        <td>@item.InstructionType</td>
                                         <td>@item.CodeSystem</td>
                                        <td>@item.CodeValue</td>                                       
                                        <td>@item.Instruction</td>
                                        <td>@item.Note</td>
                                    @if (item.AppointmentDateTime.ToString() == "1/1/1900 00:00:00" || item.AppointmentDateTime.ToString() == "1/1/1900 12:00:00 AM")
                                    {
                                        <td></td>
                                    }
                                    else if (Convert.ToDateTime(item.AppointmentDateTime).ToShortTimeString() == "12:00 AM")
                                    {
                                        <td>@Convert.ToDateTime(item.AppointmentDateTime).ToShortDateString()</td> 
                                    }
                                    else
                                    {
                                       <td>@item.AppointmentDateTime</td> 
                                    } 
                                        <td>@item.Goal</td>
                                       

                                    </tr>
                                }
                            </tbody>

                        </table>
                    </div>
                </div>
         @*   }*@
            <div class="uploadBox" id="widget_ClinicalInstructions">
                    <h3><span style="font-weight: bold;"><label for="chkCI"><span>Clinical Instructions</span></label></span><span style="float: right;color:blue;margin-top:-10px;" href="#toc" onclick="toc(); " class="anc">Top</span></h3>
                    <div class="widgetTable">
                        <table class="widget" id="EditCI" summary="Clinical" border="1" width="100%">
                            <thead>
                                <tr>
                                    
                                    <th>Type</th>
                                    <th>Code System</th>
                                    <th>Code</th>                                    
                                    <th>Instructions</th>
                                    <th>Comments</th>
                                    <th>Planned Date/Time</th>
                                    <th>Plan/Goal</th>
                                    
                                </tr>
                            </thead>

                            <tbody>

                                @foreach (var item in Model.ClinicalInstructions)
                                {
                               
                           
                                    <tr>
                                        
                                        <td>@item.InstructionType</td>
                                         <td>@item.CodeSystem</td>
                                        <td>@item.CodeValue</td>                                       
                                        <td>@item.Instruction</td>
                                        <td>@item.Note</td>
                                    @if (item.AppointmentDateTime.ToString() == "1/1/1900 00:00:00" || item.AppointmentDateTime.ToString() == "1/1/1900 12:00:00 AM")
                                    {
                                        <td></td>
                                    }
                                    else if (Convert.ToDateTime(item.AppointmentDateTime).ToShortTimeString() == "12:00 AM")
                                    {
                                        <td>@Convert.ToDateTime(item.AppointmentDateTime).ToShortDateString()</td> 
                                    }
                                    else
                                    {
                                       <td>@item.AppointmentDateTime</td> 
                                    } 
                                        <td>@item.Goal</td>
                                        

                                    </tr>
                                }
                            </tbody>

                        </table>
                    </div>
                </div>
        </div>
        </div>
    </div>
</div>
<div id="ComposeMessage" title="Compose Message" >
        <input type="hidden" id="hdSentFlag" value=""/><input type="hidden" id="hdReplyMessageId" value=""/>
        <input type="hidden" id="hdAttachmentName" value=""/>
        <input type="hidden" id="hdAttachmentTest" value=""/>
        <input type="hidden" id="hdFacilityId" value="test"/>
        <input type="hidden" id="hdProviderId_To" value=""/>
        <input type="hidden" id="hdMessageRequest" value=""/>
        <input type="hidden" id="hdMessageTypeId" value=""/>
        <input type="hidden" id="hdMessageUrgencyId" value=""/>
        <input type="hidden" id="hdFlag" value=""/>
    <div style="vertical-align:top;">
        <table>
            <tr>
               
                <td><input type="file" id="files" name="file" /><input id="my-simple-upload" type="file" value="" name="MyAttachFile" style="display:none;"/><input type="button" value="Browse..." id="browse" />@*<label id="BrowseName" style="margin-top:-20px;margin-left:100px"></label>*@</td>
                <td><input type="hidden" id="ByteData" value="" "/></td>
                <td><input type="hidden" id="FileBytes" value="" "/></td>
                <td><label id="BrowseName" style="margin-top:-20px;margin-left:60px"></label><input type="button" id="btncancelupload" value="Cancel" style="display: inline-block;margin-top:-1px;height:28px;" /></td>
            </tr>
        </table>
        <div id="progress_bar"><div class="percent">0%</div></div>
         @* <img src="Content/img/attach.gif" width="20px" style="margin-top: 0px; margin-left: -10px; margin-right: 10px;">
       *@ 
       </div>  <br>
        <p>
            @*Please note that you can expect to receive a response within 1 bussiness day*@
        </p>
        <div>
            <table width="705" height="180" border="1" style="border-color: rgb(166, 201, 226);">
                <tr style="border: 1px solid; border-color: rgb(166, 201, 226);">
                    <td height="40" colspan="2">
                        <p style="margin-left: 10px; margin-top: 10px;">
                            <b>Location:</b>
                     
                             @Html.DropDownList("cmbAppointmentFacility", Model.MessageFacilities.ToFacilityModelWithoutPatientEnteredSelectList(), new { @class = " txt  ui-corner-all bcom", style = "width:400px; margin-left:33px;", id = "cmbAppointmentFacility", @onchange = "LoadFacilityProviderSendMessage();" })
                                <span id="apDiv9" ><img id="loader1" src="Content/img/login-loader.gif"  style="margin-left:530px;  margin-top:-30px; display:none;" /></span>
                        </p>
                    </td>
                </tr>
                <tr style="border: 1px solid; border-color: rgb(166, 201, 226);">
                    <td height="40" colspan="2">
                        <p style="margin-left: 10px; margin-top: 10px;">
                            <b>To:</b>
                              <div id="DivLoadFacilityProviderSendMessage" style="margin-top:-30px;">
                             @Html.Partial("_FacilityProviderSendMessage", Model.Providers)
                             @* @Html.DropDownList("cmbAppointmentDoctor", Model.Providers.ToProviderModelSelectList(), new { @class = "txt  ui-corner-all bcom", style = "width:405px; margin-left:72px;", id = "cmbAppointmentDoctor" })*@
                                 </div>
                        </p>
                    </td>
                </tr>
                <tr style="border: 1px solid; border-color: rgb(166, 201, 226);">
                    <td height="40" colspan="2">
                        <p style="margin-left: 10px; margin-top: 10px;">
                            <b>Subject:</b>
                             @Html.DropDownList("cmbMessageType", Model.MessageType.ToMessageTypeModelSelectList(), new { @class = "txt  ui-corner-all bcom", style = "width:403px; margin-left:45px;", id = "cmbMessageType" })

                        </p>
                    </td>
                </tr>
                <tr style="border: 1px solid; border-color: rgb(166, 201, 226);">
                    <td height="40" colspan="2">
                        <p style="margin-left: 10px; margin-top: 10px;">
                           <b>Urgent:</b>
                               <select id="cmbMessageUrgency" class="txt" style="width:90px; margin-left:47px;">
                     
                      
                      <option value="false" selected="selected">No</option><option value="true">Yes</option>
</select>  
                            @* @Html.DropDownList("cmbMessageUrgency", Model.MessageUrgencyType.ToMessageUrgencySelectList(), new { @class = "txt  ui-corner-all bcom", style = "width:170px; margin-left:20px;", id = "cmbMessageUrgency" })*@
                            @* <select style="margin-left: 0px; margin-top: -15px; width: 100px;" class="txt">
                                <option>Arial</option>
                            </select>
                            <select style="margin-left: 0px; margin-top: -15px; width: 70px;" class="txt">
                                <option>12</option>
                            </select>
                            <button>
                                <img src="Content/img/bold.png" width="20px"></button>
                            <button>
                                <img src="Content/img/italic.png" width="20px"></button>
                            <button>
                                <img src="Content/img/underline.png" width="20px"></button>*@
                        </p>
                    </td>
                </tr>
                <tr style="border: 1px solid; border-color: rgb(166, 201, 226);">
                    <td height="150" colspan="2" bgcolor="#FFFFFF"> 
                   <textarea id="txtMessageWrite" class="txt" rows="5" cols="45" style="height:150px; width:685px;" maxlength="256"> </textarea>
                    </td>
                </tr>
                   <tr><td><div id="counter" style="text-align:right;"></div></td></tr>
            </table>
        </div>
    </div>
<div id="appbtn-form" title="Appointment Request">
    <center>  <span   class="validateTips"></span></center>
    <table width="100%" height="433" border="0
        " cellpadding="0" cellspacing="2">
        <tr>
            <td width="250" height="35" align="right">Location :</td>
            <td width="2">&nbsp;</td>
            <td colspan="2">
          
                @Html.DropDownList("cmbAppointmentFacility1", Model.MessageFacilities.ToFacilityModelWithoutPatientEnteredSelectList(), new { @class = "txt  ui-corner-all bcom", style = "width:400px;", id = "cmbAppointmentFacility1", @onchange = "LoadFacityProvider();" })
                <span id="apDiv9">

    

</span>
            </td>
        </tr>
        <tr>
            <td width="250" height="35" align="right">Provider :</td>
            <td align="right">&nbsp;</td>
            <td colspan="2">
                <div id="DivFacityProvider">
                @Html.Partial("_FacilityProvider", Model.Providers)
                @*@Html.DropDownList("cmbAppointmentDoctor1", Model.Providers.ToProviderModelSelectList(), new { @class = " txt  ui-corner-all bcom", style = "width:400px;", id = "cmbAppointmentDoctor1" })*@
            </div>
                    </td>
        </tr>
        <tr>
              <td  ><div style="float:right;margin-Top:4px;">Urgent :</div></td>
                    <td align="right">&nbsp;</td>
                        <td  colspan="2">
                            <select id="cmbMessageUrgency1" class="txt" style="width:90px">
                     @* <option value="-1">--Select--</option>*@
                      
                      <option value="false" selected="selected">No</option><option value="true">Yes</option>
</select>    
                            @*<div style="margin-left:0px;">
                              @Html.DropDownList("cmbMessageUrgency1", Model.MessageUrgencyType.ToMessageUrgencySelectList(), new { @class = "txt  ui-corner-all bcom", style = "width:150px; ", id = "cmbMessageUrgency1" })
                          </div>*@
                        </td>
        </tr>
        <tr>
            <td width="250"  align="right" style="padding-top:7px;" valign="Top">Preferred Time of Day :</td>
            <td>&nbsp;</td>
            <td colspan="2">
                <table width="439" border="0" cellpadding="0" cellspacing="0">
                    <tr>
                         <td >
                            <input type="checkbox" name="mor_chk" id="chkmor" style=""/></td>
                        <td width="50"><div style="margin-left:5px;margin-Top:4px;">Morning</div></td>
                        <td width="21">
                            <input type="checkbox" name="aft_chk" id="chkAft" style="margin-left:10px;"/></td>
                        <td width="68"  ><div style="margin-left:5px;margin-Top:4px;">Afternoon</div></td>
                        <td width="21">
                            <input type="checkbox" name="eve_chk" id="chkeve" style="margin-left:10px;" /></td>
                        <td width="84"  ><div style="margin-left:5px;margin-Top:4px;">Evening</div></td>
                        <td width="61"  ><div style="margin-left:15px;margin-Top:4px;"></div></td>
                        <td width="119">
                            <div style="margin-left:3px;">
                             @* @Html.DropDownList("cmbMessageUrgency1", Model.MessageUrgencyType.ToMessageUrgencySelectList(), new { @class = "txt  ui-corner-all bcom", style = "width:150px; margin-left:20px;", id = "cmbMessageUrgency1" })*@
                          </div>
                        </td>
                    </tr>
                </table>
                <label for="urg_com"></label>
            </td>
        </tr>
        <tr>
            <td width="250" valign="Top" style="padding-top:7px;" align="right">Preferred Day :</td>
            <td>&nbsp;</td>
            <td colspan="2">
                <table width="445" border="0" cellpadding="0" cellspacing="0">
                    <tr>
                 <td >
                            <input type="checkbox" name="mon_chk" id="chkmon" style="" /></td>
                        <td ><div style="margin-left:2px;margin-top:4px;">Monday</div></td>
                        <td >
                            <input type="checkbox" name="tue_chk" id="chktue" style="margin-left:10px;"/></td>
                        <td ><div style="margin-left:2px;margin-top:4px;"">Tuesday</div></td>
                        <td >
                            <input type="checkbox" name="wed_chk" id="chkwed" style="margin-left:10px;"/></td>
                        <td ><div style="margin-left:2px;margin-top:4px;"">Wednesday</div></td>
                        <td >
                            <input type="checkbox" name="thu_chk" id="chkthu" style="margin-left:10px;"/></td>
                        <td ><div style="margin-left:2px;margin-top:4px;"">Thursday</div></td>
                        
                    </tr>
                    <tr>
<td >
                            <input type="checkbox" name="fri_chk" id="chkfri" /></td>
                        <td ><div style="margin-left:2px;margin-top:4px;">Friday</div></td>
                        <td >
                            <input type="checkbox" name="fri_chk" id="chksat" style="margin-left:10px;"/></td>
                        <td ><div style="margin-left:2px;margin-top:4px;">Saturday</div></td>
                        <td >
                            <input type="checkbox" name="fri_chk" id="chksun" style="margin-left:10px;"/></td>
                        <td ><div style="margin-left:2x;margin-top:4px;">Sunday</div></td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td width="250" height="35" align="right">Preferred Date Range :</td>
            <td>&nbsp;</td>
            <td colspan="2">
                <table width="367" border="0" cellpadding="0" cellspacing="0">
                    <tr>
                        <td width="118">
                            <input type="text" name="pref_txt" id="txtPrefDateFrom" class="com" /></td>
                        <td>    <img id="show-date-PreferedStart" src="Content/img/calender.png" style="margin-top:-3px; cursor:pointer; margin-left:-15px;"/></td>
                        <td width="19">&nbsp;</td>
                        <td width="19">&nbsp;</td>
                        <td width="216">
                            <input type="text" name="pref_txt" id="txtPrefDateTo" class="com" /></td>
                        <td>    <img id="show-date-PreferredEnd" src="Content/img/calender.png" style="margin-top:-3px; cursor:pointer; margin-left:-105px;"/></td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td width="250" height="35" align="right">Preferred Time: </td>
            <td>&nbsp;</td>
            <td colspan="2">
                <select name="preft_com" id="cmbPreftime" class="com">
                      <option value="-1">--select--</option>                    
  <option value="7">7:00 am</option>
  <option value="8">8:00 am</option>
  <option value="9">9:00 am</option>
  <option value="10">10:00 am</option>
  <option value="11">11:00 am</option>
  <option value="12">12:00 pm</option>
  <option value="13">1:00 pm</option>
  <option value="14">2:00 pm</option>
  <option value="15">3:00 pm</option>
  <option value="16">4:00 pm</option>
  <option value="17">5:00 pm</option>
  <option value="18">6:00 pm</option>
 <option value="19">7:00 pm</option>
  <option value="20">8:00 pm</option>
                </select>
                
            </td>
        </tr>
        <tr>
            <td width="250" height="33" align="right">Reason for Visit :</td>
            <td>&nbsp;</td>
            <td colspan="2">
                <input type="text" name="reas_txt" id="txtReason" class="btxt" /></td>
        </tr>
        <tr>
            <td width="250" align="right">Comments :</td>
            <td>&nbsp;</td>
            <td colspan="2">
                <textarea name="comm_txta" cols="45" rows="5" class="btxta" id="txtComment" maxlength="256"></textarea></td>
        </tr>
          <tr>
            
            <td colspan="3" align="right"><div id="appcount"></div></td>
        </tr>


    </table>

</div>
<div id="dialog-refill" title="Refill Request">
    <center>  <span   class="validateTips"></span></center>
    <table border="0" width="100%" height="300px">
        <tr>
            <td width="30%" height="40"><span class="form_text" style="color: #000066;">Location:</span></td>
            <td>

                  @Html.DropDownList("cmbAppointmentFacilityRefill", Model.MessageFacilities.ToFacilityModelWithoutPatientEnteredSelectList(), new { @class = "txt  ui-corner-all bcom", style = "width:400px;", id = "cmbAppointmentFacilityRefill", @onchange = "LoadFacityProviderRefil();LoadRefilmediaction();" })
    

            </td>
        </tr>
        <tr>
            <td width="30%" class="form_text" style="color: #000066;">Doctor: </td>
            <td>
                <div id="refildiv">
                @Html.Partial("_CmbRefildoctorDropDown", Model.Providers)
                    </div>

           @*    @Html.DropDownList("cmbDoctor", Model.Providers.ToProviderModelSelectList(), new { @class = " txt  ui-corner-all", style = "width:200px;", id = "cmbDoctor" })*@

            </td>
        </tr>
        <tr>
            <td width="30%" height="40"><span class="form_text" style="color: #000066;">Medication:</span></td>
            <td>
                <div id="refilmed">
                @Html.Partial("_Index_RefillMedication", Model.MedicationsClincial)
                    </div>
            </td>
        </tr>


        

        <tr>
            <td width="30%" class="form_text" style="color: #000066;">Number of Refills: </td>
            <td>
                <input type="text" name="txtCountRefills" id="txtCountRefills" class="txt ui-corner-all" />
            </td>
        </tr>
        <tr>
            <td width="30%" class="form_text" style="color: #000066;">Pharmacy: </td>
            <td>
                <table>
<tr><td>
<div id="cmbPharmacy">

          
                 @Html.Action("RefillPharmacypartialview", "Home", new { @class = "txt  ui-corner-all", style = "width:200px;", id = "cmbRFPharmacy"  })
              
 </div>
</td>
<td><span><img  src="Content/img/add.png" />
<span id="addPharmacy" class="anc" onclick="OpenPharmacyDialoge();" style="font-size: 13px; padding-right: 17px;">Add</span></span>
</td>
</tr>
</table>
               <div > </div> <div id="PharmAddress" style="color:red;"></div><div><input type="hidden" id="Phone" value="" /></div>
            </td>
            
        </tr>

        <tr>
            <td width="30%" class="form_text" style="color: #000066;">Comments: </td>
            <td>
                <textarea multiline="true" style="height: 96px; width: 453px;" id="txtComments" rows="3" cols="5" class="txt  ui-corner-all" maxlength="256"></textarea>
            </td>
        </tr>
          <tr>
            
            <td colspan="3" align="right"><div id="refillcount"></div></td>
        </tr>



    </table>

</div>
<div id="reqbtn-form" title="Referral Request">
    <table width="100%" border="0" cellpadding="0" cellspacing="2">
        <tr>
            <td width="250" height="35" align="right">Location :</td>
            <td width="2">&nbsp;</td>
            <td width="571">
               
                   @Html.DropDownList("cmbAppointmentFacility3", Model.MessageFacilities.ToFacilityModelWithoutPatientEnteredSelectList(), new { @class = "txt  ui-corner-all bcom", style = "width:400px;", id = "cmbAppointmentFacility3", @onchange = "LoadFacilityProviderRequestRefferal();" })
         <span id="apDiv9">

    <img id="loader4" src="Content/img/login-loaderwhite.gif" style="margin-left: 420px; margin-top: -30px; display: none;"></img>

</span>
            </td>
        </tr>

        <tr>
            <td width="250" height="35" align="right">Send Request to :</td>
            <td width="2">&nbsp;</td>
            <td width="571">
                
                  <div id="DivFacilityProviderRequestRefferal">
                @Html.Partial("_FacilityProviderRequestRefferal", Model.Providers)
                
            </div>
                   @*@Html.DropDownList("cmbRProvider", Model.Providers.ToProviderModelSelectList(), new { @class = " txt  ui-corner-all bcom", style = "width:400px;", id = "cmbRProvider" })*@
         </td>
        </tr>
        <tr>
            <td width="250" height="35" align="right">Reason for Referral :</td>
            <td align="right">&nbsp;</td>
            <td>
                <input type="text" name="reas_txt3" id="txtReqRes" class="btxt" /></td>
        </tr>
        <tr>
            <td width="250" height="35" align="right">Comments :</td>
            <td>&nbsp;</td>
            <td>
                <textarea name="comm_txta2" cols="45" rows="5" class="btxta" id="txtRComm" maxlength="256"></textarea></td>
        </tr>
       <tr>
            
            <td colspan="3" align="right">
                <div id="referallcount"></div>

            </td>
        </tr>
    </table>


</div>
<div id="dialog-pharmacy" title="Add a Pharmacy">
           
    <table border="0" width="100%">

        <tr>
            <td align="right" width="140px;"><span style="color:red;"  >*</span><span class="form_text"  >Pharmacy Name : </span></td>
            <td>
                <input type="hidden" id="txtPharmID" value="0" />
                <input type="text" name="name" id="txtPharmacyName" class="txt ui-corner-all" style="width: 240px;"/>
            </td>
        </tr>
           <tr>
        <td align="right"><span style="color:red;"  >*</span><span class="form_text" >Address Line 1 : </span> </td>
                <td>
                <input type="text" name="name" id="txtPharmAddress1" style="width: 240px;" class="txt ui-corner-all" />
            </td>
        </tr>
        <tr>
            <td align="right"><span class="form_text" >Address Line 2 : </span></td>
           
            <td>
                <input type="text" name="name" id="txtPharmAddress2" style="width: 240px;" class="txt ui-corner-all" /></td>
        </tr>
            <tr>
            <td align="right"><span style="color:red;"  >*</span><span class="form_text" >City : </span></td>
           
            <td>
                <input type="text" name="name" id="txtPharmCity" class="txt ui-corner-all" width="150px;" /></td>
          
        </tr>

            <tr>
            <td align="right"><span style="color:red;"  >*</span><span class="form_text" >State : </span></td>
           
           <td>
                @*<input type="text" name="name" id="txtPharmState" class="txt ui-corner-all" />*@
               <select style="visibility: visible;" class="coms" name="state" id="cmbStates" tabindex="11">
									
										<option value="AL">AL</option>
									
										<option value="AK">AK</option>
									
										<option value="AS">AS</option>
									
										<option value="AZ">AZ</option>
									
										<option value="AR">AR</option>
									
										<option value="AA">AA</option>
									
										<option value="AE">AE</option>
									
										<option value="AP">AP</option>
									
										<option value="CA">CA</option>
									
										<option value="CO">CO</option>
									
										<option value="CT">CT</option>
									
										<option value="DE">DE</option>
									
										<option value="DC">DC</option>
									
										<option value="FL">FL</option>
									
										<option value="GA">GA</option>
									
										<option value="GU">GU</option>
									
										<option value="HI">HI</option>
									
										<option value="ID">ID</option>
									
										<option value="IL">IL</option>
									
										<option value="IN">IN</option>
									
										<option value="IA">IA</option>
									
										<option value="KS">KS</option>
									
										<option value="KY">KY</option>
									
										<option value="LA">LA</option>
									
										<option value="ME">ME</option>
									
										<option value="MH">MH</option>
									
										<option value="MD">MD</option>
									
										<option value="MA">MA</option>
									
										<option value="MI">MI</option>
									
										<option value="FM">FM</option>
									
										<option value="MN">MN</option>
									
										<option value="MS">MS</option>
									
										<option value="MO">MO</option>
									
										<option value="MT">MT</option>
									
										<option value="NE">NE</option>
									
										<option value="NV">NV</option>
									
										<option value="NH">NH</option>
									
										<option value="NJ">NJ</option>
									
										<option value="NM">NM</option>
									
										<option value="NY">NY</option>
									
										<option value="NC">NC</option>
									
										<option value="ND">ND</option>
									
										<option value="MP">MP</option>
									
										<option value="OH">OH</option>
									
										<option value="OK">OK</option>
									
										<option value="OR">OR</option>
									
										<option value="PW">PW</option>
									
										<option value="PA">PA</option>
									
										<option value="PA">PA</option>
									
										<option value="PR">PR</option>
									
										<option value="RI">RI</option>
									
										<option value="SC">SC</option>
									
										<option value="TN">TN</option>
									
										<option value="TX">TX</option>
									
										<option value="UT">UT</option>
									
										<option value="VT">VT</option>
									
										<option value="VI">VI</option>
									
										<option value="VA">VA</option>
									
										<option value="WA">WA</option>
									
										<option value="WV">WV</option>
									
										<option value="WI">WI</option>
									
										<option value="WY">WY</option>
									
										<option value="SD">SD</option>
									
								</select>
            </td>
        </tr>

        <tr>
            <td align="right"><span style="color:red;"  >*</span><span class="form_text" >Zip Code : </span></td>
           
          <td>
                <input type="text" name="name" id="txtPharmZipCode" class="txt ui-corner-all" style="width: 100px;" />
            </td>
        </tr>


          <tr>
            <td align="right"><span class="form_text" >Phone : </span></td>
           
          <td>
                <input type="text" name="name" id="txtPhone" style="width: 190px;" class="txt ui-corner-all" />
            </td>
        </tr>
           <tr>
            <td align="right"><span class="form_text" >Website : </span></td>
           
          <td>
       <input type="text" name="name" id="txtWebsite" style="width: 240px;" class="txt ui-corner-all" />
            </td>
        </tr>



      
        
    </table>

  
    <table style="margin-top: -15px;">
        <tr>
          
        </tr>
        
    </table>

 
    <h3 style="margin-top: 25px; color: rgb(29, 89, 135); font-size: 22px;">Preferred Pharmacy</h3>
    <table>
        <tr>
            <td width="30%"><span class="form_text">
                <input name="chk" type="checkbox" value="" id="chkPref">
            </span></td>
            <td width="-20%"><span class="form_text" style="margin-left: -80px; color: #9B9B9B;">Would you like to make this your preferred pharmacy?</span> </td>
        </tr>
    </table>
</div>


@Scripts.Render("~/MedicationIndex/jquery")