 @using AMR.Models;
@using AMR.Core.Extensions;
@using System.Text;
@model MessageCenterModel

@using System.Web.Optimization;

@{
    ViewBag.Title = "[Patient Portal] Message Center";
    Layout = "~/Views/Shared/_LayoutMasterPage.cshtml";
}
@Styles.Render("~/MsgIndex/css")

<style>

.tdhide{

visibility: hidden

}

tr.selected {
    background-color: #039
}
tr.selected:hover td {
    background: #039
}
</style>
@section Scripts
{
   
    <!-- applying script for modal pop up -->
    <script>
        $(function () {
            var generalMsg = '@AMR.Core.Utilities.RequestHelper.MyGlobalVar.GeneralMessageAvailable';
            var apointmentMsg = '@AMR.Core.Utilities.RequestHelper.MyGlobalVar.AppointmentMessageAvailable';
            var medicatinMsg = '@AMR.Core.Utilities.RequestHelper.MyGlobalVar.MedicationMessageAvailable';
            var referralMsg = '@AMR.Core.Utilities.RequestHelper.MyGlobalVar.ReferralMessageAvailable';
         //   alert(generalMsg + " " + apointmentMsg + " " + medicatinMsg + " " + referralMsg);
            if (generalMsg == 'False') {
                $("#tabs").tabs({ disabled: [0, 4, 5] });
                if (apointmentMsg == 'False') {
                    $("#tabs").tabs({ disabled: [0, 4, 5,1] });
                }
                if (medicatinMsg == 'False') {
                    $("#tabs").tabs({ disabled: [0, 4, 5,2] });
                }
                if (referralMsg == 'False') {
                    $("#tabs").tabs({ disabled: [0, 4, 5,3] });
                }


                if (apointmentMsg == 'False' && medicatinMsg == 'False') {
                    $("#tabs").tabs({ disabled: [0, 4, 5, 1, 2] });
                }
                if (apointmentMsg == 'False' && referralMsg == 'False') { $("#tabs").tabs({ disabled: [0, 4, 5, 1, 3] }); }
                if (medicatinMsg == 'False' && referralMsg == 'False') { $("#tabs").tabs({ disabled: [0, 4, 5, 2, 3] }); }
            }
            if (apointmentMsg == 'False') {
              
                $("#tabs").tabs({ disabled: [1] });
                if (generalMsg == 'False') {
                    $("#tabs").tabs({ disabled: [0, 4, 5, 1] });
                }
                if (medicatinMsg == 'False') {
                    $("#tabs").tabs({ disabled: [1, 2] });
                }
                if (referralMsg == 'False') {
                    $("#tabs").tabs({ disabled: [1, 3] });
                }
                if (generalMsg == 'False' && medicatinMsg == 'False') {
                    $("#tabs").tabs({ disabled: [0, 4, 5,1, 2] });
                }
                if (generalMsg == 'False' && referralMsg == 'False') {
                    $("#tabs").tabs({ disabled: [0, 4, 5,1, 3] });
                }
                if (medicatinMsg == 'False' && referralMsg == 'False') {
                    $("#tabs").tabs({ disabled: [1, 2, 3] });
                }

            }
            if (medicatinMsg == 'False') {
             
                $("#tabs").tabs({ disabled: [2] });
                if (generalMsg == 'False') {
                    $("#tabs").tabs({ disabled: [0, 4, 5, 2] });
                }
                if (apointmentMsg == 'False') {
                    $("#tabs").tabs({ disabled: [1,2] });
                }
                if (referralMsg == 'False') {
                    $("#tabs").tabs({ disabled: [2, 3] });
                }
                if (generalMsg == 'False' && apointmentMsg == 'False') {
                    $("#tabs").tabs({ disabled: [0, 4, 5, 1, 2] });
                }
                if (generalMsg == 'False' && referralMsg == 'False') {
                    $("#tabs").tabs({ disabled: [0, 4, 5, 2, 3] });
                }
                if (apointmentMsg == 'False' && referralMsg == 'False') {
                    $("#tabs").tabs({ disabled: [1, 2, 3] });
                }
            }
            if (referralMsg == 'False') {
               
                $("#tabs").tabs({ disabled: [3] });
                if (generalMsg == 'False') {
                    $("#tabs").tabs({ disabled: [0, 4, 5, 3] });
                }
                if (apointmentMsg == 'False') {
                    $("#tabs").tabs({ disabled: [1, 3] });
                }
                if (medicatinMsg == 'False') {
                    $("#tabs").tabs({ disabled: [2,3] });
                }
                if (generalMsg == 'False' && apointmentMsg == 'False') {
                    $("#tabs").tabs({ disabled: [0, 4, 5, 1, 3] });
                }
                if (generalMsg == 'False' && medicatinMsg == 'False') {
                    $("#tabs").tabs({ disabled: [0, 4, 5, 2, 3] });
                }
                if (apointmentMsg == 'False' && medicatinMsg == 'False') {
                    $("#tabs").tabs({ disabled: [1, 2, 3] });
                }
            }
      /*      if (referralMsg == 'False')
            {
                $("#createreqbtn").attr("disabled", true);
            }
            if (medicatinMsg == 'False') {
                $("#refillMEd").attr("disabled", true);
            }
            if (apointmentMsg == 'False') {
                $("#createappbtn").attr("disabled", true);
            }
            if (generalMsg == 'False') {
                $("#createmsg").attr("disabled", true);
            }*/
           /* var navFlag = $('#querystringhd').val();
            $("#tabs").tabs({
                active: navFlag
            });*/
        });

        //function Inbox() {
        //    alert("inbox");
        //    $("#MessageDetailGrid").hide();
        //    $("#tbl-MessageGridDetail").hide();
        //    $("#detail-inbox-request").hide();

        //}


        //function Sent() {
        //    alert("sent");
        //    $("#MessageDetailGrid").hide();
        //    $("#tbl-MessageGridDetail").hide();
        //    $("#detail-sent-request").hide();
        //}

        //function deleted() {
        //    alert("deleted");
        //    $("#MessageDetailGrid").hide();
        //    $("#tbl-MessageGridDetail").hide();
        //    $("#detail-delete-request").hide();

        //}


        //function appointment() {
        //    alert("appointment");
        //    $("#MessageDetailGrid").hide();
        //    $("#tbl-AppointmentDetailGrid").hide();
        //    $("#detail-Appointment-Request").hide();
        //}

        //function refill() {
        //    alert("refill");
        //    $("#RefillRequestDetailGrid").hide();
        //    $("#detail-refill-request").hide();
        //}

        //function referral() {
            
        //        alert("referral");
        //        $("#ReferralRequestDetailGrid").hide();
        //        $("#detail-Referral-Request").hide();
            
        //}
function messageAttachmentDetail(id) {


    var requestURL = "";

    //alert(id);
    var docType = id.split('|')[1];
    //alert(docType);

    requestURL = '@Url.Action("MessageAttachment", "Message")' + "/?id=" + id.split('|')[0];

    var isOfficeDocRequest = false;

    switch (docType.toLowerCase()) {
        case "doc":
            isOfficeDocRequest = true;
            break;

        case "docx":
            isOfficeDocRequest = true;
            break;

        case "xls":
            isOfficeDocRequest = true;
            break;

        case "xlsx":
            isOfficeDocRequest = true;
            break;

        default:
            isOfficeDocRequest = false;
            break;
    }

    if (isOfficeDocRequest) {


        try {


            ShowLoaderReportViewer();

            $('#iframeViewAttachment').attr('src', requestURL);
            $('#iframeViewAttachment').load();

        } catch (err) {

            if (err && err !== "") {
                alert(err.message);
                HideLoaderReportViewer();
            }
        }



    }
    else {
        $('#Signupdialog').remove();
        var $dialog = $('<div id="Signupdialog" style="width:500px;"></div>')
                       .html('<div id="page_loader2" style="display: block;"><div id="apDiv1" align="center"><table width="200" border="0" cellspacing="0" cellpadding="0"><tr><td height="70px;">&nbsp;</td></tr><tr><td align="center"><img src="Content/img/image_559926.gif" width="128" height="64" /></td></tr><tr><td style="text-align: center;" height="70px;">Please wait ...</td></tr></table></div></div><iframe id="iframeViewDoctorAttachment" style="border: 0px; " src="' + requestURL + '" width="100%" height="100%" onload="processingComplete();"></iframe>')
                       .dialog({
                           autoOpen: false,
                           show: {
                               effect: "blind",
                               duration: 100
                           },
                           hide: {
                               effect: "blind",
                               duration: 100
                           },
                           modal: true,
                           height: 600,
                           width: 800,
                           title: "View Attachment",
                           buttons: {

                               Close: function () {
                                   $(this).dialog("close");
                               }
                           },
                           close: function () {

                           }
                       });
        $dialog.dialog('open');

    }
}

        $(function () {

            $("#dialog-pharmacy").dialog
            ({
                autoOpen: false,
                show: {
                    effect: "blind",
                    duration: 100
                },
                hide: {
                    effect: "blind",
                    duration: 100
                },
                height: 600,
                width: 700,
                modal: true,
                buttons: {
                    "Save": function () {
                        chkAccess();
                        var bValid = true;
                        //   if (editpharmacyflag != 1) { bValid = false; }

                        //var address = $('#txtPharmAddress1').val();
                        //var phone = $('#txtPhone').val();
                        //var addphone = address + '|' + phone;

                        if ($("#txtPharmacyName").val() == "") {
                            alert("Please enter the Pharmacy Name");
                            bValid = false;
                        }
                        else if ($("#txtPharmAddress1").val() == "") {
                            alert("Please enter the Address");
                            bValid = false;
                        }
                        else if ($("#txtPharmCity").val() == "") {
                            alert("Please enter the City");
                            bValid = false;
                        }
                        else if ($("#txtPharmZipCode").val() == "") {
                            alert("Please enter the Zip code");
                            bValid = false;

                        }
                        if (bValid) {

                            try {
                                var requestData = {
                                    PharmacyCntr: $.trim($('#txtPharmID').val()),
                                    PharmacyName: $.trim($('#txtPharmacyName').val()),
                                           Address1: $.trim($('#txtPharmAddress1').val()),
                                 //   Address1: addphone,

                                    City: $.trim($('#txtPharmCity').val()),
                                    State: $.trim($('#cmbStates option:selected').text()),
                                    PostalCode: $.trim($('#txtPharmZipCode').val()),
                                    Address2: $.trim($('#txtPharmAddress2').val()),
                                    Phone: $.trim($('#txtPhone').val()),
                                    Preferred: $('#chkPref').prop('checked'),
                                    Flag: 1,

                                };


                                $.ajax({
                                    type: 'POST',
                                    url: 'pharmacies-save',
                                    data: JSON.stringify(requestData),
                                    dataType: 'json',
                                    contentType: 'application/json; charset=utf-8',
                                    success: function (data) {
                                        // if success
                                        // alert("Success : " + data);
                                        
                                        $("#cmbPharmacy").html(data);
                                        var sppl = $("#cmbRFPharmacy option:first").val().split('|');
                                        $('#PharmAddress').text(sppl[1]);

                                        $("#Phone").val(sppl[2]);
                                        $("#cmbRFPharmacy").change(function () {

                                          
                                            var spl = $("#cmbRFPharmacy").val().split('|');
                                            $('#PharmAddress').text(spl[1]);
                                           
                                            $("#Phone").val(spl[2]);
                                       //     $('#PharmPhoneNo').text(spl[2]);
                                        });
                                        // $("#tbl-Pharmacies").fixedHeaderTable();
                                    },
                                    error: function (xhr, ajaxOptions, thrownError) {
                                        //if error
                                        var myCookie = getCookie(".Patient");

                                        if (myCookie == null) {
                                            // do cookie doesn't exist stuff;
                                            alert('Not logged in. Please log in to continue');
                                            window.location = '/Login'
                                            //xhr.getResponseHeader('Location');
                                        }
                                        else {

                                            alert('Error : ' + xhr.message);
                                        }
                                        HideLoader();
                                    },
                                    complete: function (data) {
                                        // if completed
                                        HideLoader();

                                    },
                                    async: true,
                                    processData: false
                                });

                                //$.ajax({
                                //    type: 'POST',
                                //    url: 'Medication-Data',
                                //    // data: JSON.stringify(requestData),
                                //    dataType: 'json',
                                //    contentType: 'application/json; charset=utf-8',
                                //    success: function (data) {
                                //        // if success
                                //        // alert("Success : " + data);
                                //        $("#divPharmacy").html(data);
                                //        $("#DivPharmacy1").html(data);
                                //        $('#DivPharmacy1 #txtPharmacy').attr('id', 'txtPharmacy1');
                                //        $("#tbl-Pharmacies").fixedHeaderTable();
                                //    },
                                //    error: function (xhr, ajaxOptions, thrownError) {
                                //        //if error

                                //        alert('Error : ' + xhr.message);
                                //    },
                                //    complete: function (data) {
                                //        // if completed
                                //        HideLoader();

                                //    },
                                //    async: true,
                                //    processData: false
                                //});
                            } catch (err) {

                                if (err && err !== "") {
                                    alert(err.message);
                                }
                            }
                            $(this).dialog("close");
                            ShowLoader();
                        }

                    },
                    Close: function () {
                        $("#dialog-pharmacy")
             .next(".ui-dialog-buttonpane")
             .find("button:contains('Save')")
             .button("option", "disabled", false);
                        $(this).dialog("close");
                    }
                },
                close: function () {
                    $("#dialog-pharmacy")
        .next(".ui-dialog-buttonpane")
        .find("button:contains('Save')")
        .button("option", "disabled", false);
                }
            });



            $("#addpharmacy")
            .button()
            .click(function () {

                $("#dialog-pharmacy")
          .next(".ui-dialog-buttonpane")
          .find("button:contains('Save')")
          .button("option", "disabled", false);
                $('.HideEditDelete').css('display', 'none');
                $("#dialog-pharmacy").dialog("open");
            });

        });
    </script>
  
      
}                                                      

<div id="containment-wrapper" style="border-bottom-style: none; border-top-style: none; border-right-style: none; border-left-width: 1px; border-left-color: rgb(166, 201, 226);">
    

    @{
        AMR.Controllers.Controllers.Base.BaseController bc1 = new AMR.Controllers.Controllers.Base.BaseController();
        AMR.Models.PatientRepModel patRep = bc1.GetRepData();
          }  
    <div id="quicklinks" class="draggable ui-widget-content ui-corner-all" style="position: absolute; top: 20px; left: 3%; width: 94%; height: 70px;display:none;">
        <div id="cart" style="position: absolute; top: 1px; left: 0px; right: 0px;" class="ui-corner-all">
               <input id="hdFlag" type="hidden" value=" " />
            <div class="ui-widget-content" style="position: relative; top: 0px; border: none;">
                @if (@AMR.Core.Utilities.RequestHelper.MyGlobalVar.GeneralMessageAvailable){
                <button    onclick="ControllMessageCompose();HidevaluecmbMessageType()"id="createmsg"  class="beer ui-button ui-widget ui-state-default ui-corner-all"  style="font-size: 0.9em; font-weight: normal" title="Send Message" type="submit">
                    <img src="Content/img/2.png" />&nbsp;&nbsp;Compose Message</button>
                }
                else
                {
                      <button    onclick="ControllMessageCompose();HidevaluecmbMessageType()"id="createmsg"  class="beer ui-button ui-widget ui-state-default ui-corner-all"  style="font-size: 0.9em; font-weight: normal" title="Send Message" disabled="disabled" type="submit">
                    <img src="Content/img/2.png" />&nbsp;&nbsp;Compose Message</button>
                }
                @if (@AMR.Core.Utilities.RequestHelper.MyGlobalVar.AppointmentMessageAvailable)
                {
                <button   onclick="ControllAppointment();" id="createappbtn" class="beer ui-button ui-widget ui-state-default ui-corner-all" style="font-size: 0.9em; font-weight: normal" title="Request Appointment" type="submit">
                    <img src="Content/img/3.png" style="margin-left:-7px;" />&nbsp;&nbsp;Appointment Request</button>
                }
                else
                {
                      <button   onclick="ControllAppointment();" id="createappbtn" class="beer ui-button ui-widget ui-state-default ui-corner-all" style="font-size: 0.9em; font-weight: normal" title="Request Appointment" disabled="disabled" type="submit">
                    <img src="Content/img/3.png" style="margin-left:-7px;" />&nbsp;&nbsp;Appointment Request</button>
                }

                @if (@AMR.Core.Utilities.RequestHelper.MyGlobalVar.MedicationMessageAvailable)
                {
                <button id="refillMEd"   onclick="RefillDialog(); ControllRefill();" role="button" aria-disabled="false" class="beer ui-button ui-widget ui-state-default ui-corner-all" style="font-size: 0.9em; font-weight: normal"  title="Refill Medication" type="submit">
                    <img src="Content/img/4.png" />Refill Request</button>
                }
                else
                {
                     <button id="refillMEd"   onclick="RefillDialog(); ControllRefill();" role="button" aria-disabled="false" class="beer ui-button ui-widget ui-state-default ui-corner-all" style="font-size: 0.9em; font-weight: normal"  title="Refill Medication" disabled="disabled" type="submit">
                    <img src="Content/img/4.png" />Refill Request</button>
                }
              
                  @if (AMR.Core.Utilities.RequestHelper.MyGlobalVar.ReferralMessageAvailable)
                  {
                <button    onclick="ControllReferall();" id="createreqbtn"  class="beer ui-button ui-widget ui-state-default ui-corner-all" style="font-size: 0.9em; font-weight: normal" title="Request Referral" type="submit">
                    <img src="Content/img/1.png" />&nbsp;&nbsp;Referral Request</button>
                  }
                  else
                  {
                     <button    onclick="ControllReferall();" id="createreqbtn"  class="beer ui-button ui-widget ui-state-default ui-corner-all" style="font-size: 0.9em; font-weight: normal" title="Request Referral" disabled="disabled" type="submit">
                    <img src="Content/img/1.png" />&nbsp;&nbsp;Referral Request</button>
                  }
            </div>
        </div>
    </div>
    <div id="tabs" style="font-size: 12px; margin-top: 10px; width: 930px;display: none;">
        <input type="hidden" id="querystringhd" value="@Request.QueryString["id"]" />
        <ul>
            <li><a href="#tabs-1" onclick="Inbox();" style="height: 30px;">
                <p id="GeneralMessages" style="margin-top: -5px;">
                    Inbox
                </p>
            </a></li>
              <li><a href="#tabs-2" onclick="appointment();" style="height: 30px;" >
                <p @if (patRep.Appointment == true)
                   {<Text>  id="AppointmentMessages" style="margin-top: -5px;" 
                    </Text>}
                   else
                   {<Text>  style="margin-top: -5px; color: rgb(220, 220, 220);"  </Text> } >
                    Appointments
                </p>
            </a></li>
               <li @*style="margin-left:-1px;"*@><a href="#tabs-3" onclick="refill();" style="height: 30px;" >
                <p  @if (patRep.Medication == true)
                    {<Text> id="MedicationMessages" style="margin-top: -5px;" </Text>}
                    else
                    {<Text>  style="margin-top: -5px; color: rgb(220, 220, 220);"  </Text> } >
                    Refill Requests
                </p>
            </a></li>
              <li><a href="#tabs-4" onclick="referral();" style="height: 30px;" >
                <p  @if (patRep.Messaging == true)
                    { <Text> id="ReferralMessages" style="margin-top: -5px;" </Text> }
                    else
                    {<Text>  style="margin-top: -5px; color: rgb(220, 220, 220);"  </Text> } >
                    Referral Request
                </p>
            </a></li>
            <li @*style="margin-left:-1px;"*@> <a href="#tabs-5" style="height: 30px;">
                <p style="margin-top: -5px;" >
                    Sent Items
                </p>
            </a></li>
            <li><a href="#tabs-6" onclick="deleted();" style="height: 30px;">
                <p id="DeleteMessages" style="margin-top: -5px;" >
                    Deleted
                </p>
            </a></li>
           
         
          
           
        </ul>
        <div id="tabs-1">

            <div id="ComposeMessage" title="Compose Message" >
        <input type="hidden" id="hdSentFlag" value=""/><input type="hidden" id="hdReplyMessageId" value=""/>
        <input type="hidden" id="hdAttachmentName" value=""/>
        <input type="hidden" id="hdAttachmentTest" value=""/>
        <input type="hidden" id="hdFacilityId" value="test"/>
        <input type="hidden" id="hdProviderId_To" value=""/>
        <input type="hidden" id="hdMessageRequest" value=""/>
        <input type="hidden" id="hdMessageTypeId" value=""/>
        <input type="hidden" id="hdMessageUrgencyId" value=""/>
        <input type="hidden" id="hdFlag" value=""/>
    <div style="vertical-align:top;">
        <table>
            <tr valign="Top">
               
                <td><input type="file" id="files" name="file" /><input id="my-simple-upload" type="file" value="" name="MyAttachFile" style="display:none;"/><input type="button" value="Browse..." id="browse" /></td>
                <td><input type="hidden" id="ByteData" value="" "/></td>
                <td><input type="hidden" id="FileBytes" value="" "/></td>
                <td><label id="BrowseName" style="margin-top:-20px;margin-left:60px"></label><input type="button" id="btncancelupload" value="Cancel" style="display: inline-block;margin-top:-1px;height:28px;" /></td>
            </tr>
        </table>
        <div id="progress_bar"><div class="percent">0%</div></div>
         @* <img src="Content/img/attach.gif" width="20px" style="margin-top: 0px; margin-left: -10px; margin-right: 10px;">
       *@ 
       </div>  <br>
        <p>
           @* Please note that you can expect to receive a response within 1 bussiness day*@
             

        </p>
        <div>
            <table width="705" height="180" border="1" style="border-color: rgb(166, 201, 226);">
                <tr style="border: 1px solid; border-color: rgb(166, 201, 226);">
                    <td height="40" colspan="2">
                        <p style="margin-left: 10px; margin-top: 10px;">
                            <b>Location:</b>
                     
                             @Html.DropDownList("cmbAppointmentFacility", Model.MessageFacilities.ToFacilityModelWithoutPatientEnteredSelectList(), new { @class = " txt  ui-corner-all bcom", style = "width:400px; margin-left:33px;", id = "cmbAppointmentFacility", @onchange = "LoadFacilityProviderSendMessage();" })
          <span id="apDiv9" ><img id="loader" src="Content/img/login-loaderwhite.gif"  style="margin-left:530px;  margin-top:-30px; display:none;" /></span>
                        </p>
                    </td>
                </tr>
                <tr style="border: 1px solid; border-color: rgb(166, 201, 226);">
                    <td height="40" colspan="2">
                        <p style="margin-left: 10px; margin-top: 10px;">
                            <b>To:</b>
                              <div id="DivLoadFacilityProviderSendMessage" style="margin-top:-30px;">
                             @Html.Partial("_FacilityProviderSendMessage", Model.Providers)
                             @* @Html.DropDownList("cmbAppointmentDoctor", Model.Providers.ToProviderModelSelectList(), new { @class = "txt  ui-corner-all bcom", style = "width:405px; margin-left:72px;", id = "cmbAppointmentDoctor" })*@
                                 </div>
                        </p>
                    </td>
                </tr>
                <tr style="border: 1px solid; border-color: rgb(166, 201, 226);">
                    <td height="40" colspan="2">
                        <p style="margin-left: 10px; margin-top: 10px;">
                            <b>Subject:</b>
                             @Html.DropDownList("cmbMessageType", Model.MessageType.ToMessageTypeModelSelectList(), new { @class = "txt  ui-corner-all bcom", style = "width:403px; margin-left:42px;", id = "cmbMessageType" })

                        </p>
                    </td>
                </tr>
                <tr style="border: 1px solid; border-color: rgb(166, 201, 226);">
                    <td height="40" colspan="2">
                        <p style="margin-left: 10px; margin-top: 10px;">
                           <b>Urgent:</b>
                               <select id="cmbMessageUrgency" class="txt" style="width:90px; margin-left:47px;">
                     
                      
                      <option value="false" selected="selected">No</option><option value="true">Yes</option>
</select>  
                           @*  @Html.DropDownList("cmbMessageUrgency", Model.MessageUrgencyType.ToMessageUrgencySelectList(), new { @class = "txt  ui-corner-all bcom", style = "width:170px; margin-left:20px;", id = "cmbMessageUrgency" })*@
                            @* <select style="margin-left: 0px; margin-top: -15px; width: 100px;" class="txt">
                                <option>Arial</option>
                            </select>
                            <select style="margin-left: 0px; margin-top: -15px; width: 70px;" class="txt">
                                <option>12</option>
                            </select>
                            <button>
                                <img src="Content/img/bold.png" width="20px"></button>
                            <button>
                                <img src="Content/img/italic.png" width="20px"></button>
                            <button>
                                <img src="Content/img/underline.png" width="20px"></button>*@
                        </p>
                    </td>
                </tr>
                <tr style="border: 1px solid; border-color: rgb(166, 201, 226);">
                    <td height="150" colspan="2" bgcolor="#FFFFFF"> 
                   <textarea id="txtMessageWrite" class="txt" rows="5" cols="45" style="height:150px; width:685px;" maxlength="256"> </textarea>
                    </td>
                </tr>
                <tr><td><div id="counter" style="text-align:right;"></div></td></tr>
            </table>
        </div>
    </div>
            <input id="hdReplyMessageDetailId" type="hidden" value="" />
            
           @* <button onclick="Javascript:SentMessage('Reply');" >
                <img src="Content/img/reply.png" width="20px" style="margin-top: 0px; margin-left: -10px; margin-right: 10px;" >Reply</button>*@
             <input id="hdDeleteMessageId" type="hidden" value="" />
            <button onclick="Javascript:SentMessage('Compose');"id="composeButton" >
        <img src="Content/img/meesage.png" width="20px" style="margin-top: -5px; margin-left: -2px; margin-right: 10px;">Compose New Message</button>
                <button id="InboxDeleteMessage"  name="Delete" >
                <img src="Content/img/delete.gif" width="20px" style="margin-top: -5px; margin-left: -2px; margin-right: 10px;">Delete</button>
            
            <!--Inbox 1st grid start here -->
            <div id="MessageHeaderGrid" name="MessageHeaderGrid" style="margin-top: 20px; border: 1px solid; border-color: rgb(166, 201, 226); height: 190px; overflow-x: auto;"
                class="ui-corner-all"  >
                 @Html.Partial("~/Views/Templates/Message/_Message_Inbox.cshtml", Model.Messages)  
            </div> 
            <!--Inbox 1st grid end here -->

            <!--Inbox 2nd grid start here -->
            <div id="MessageDetailGrid" name="MessageDetailGrid" style="border: 1px solid; border-color: rgb(166, 201, 226); margin-top:10px;"
                class="ui-corner-all">
          
            </div> 
            <!--Inbox 2nd grid end here -->
            <!-- Reply Part-->
      
            <!--End of reply part-->
           <div id="detail-inbox-request">

            </div> 
        </div>
       
       
        <div id="tabs-2">
            
              @if (patRep.Appointment == true)
              {<Text> 
              <button id="composeButtonapp" onclick="Javascript:SentMessageApp('Compose');clearFields();">
        <img src="Content/img/meesage.png" width="20px" style="margin-top: -5px; margin-left: -2px; margin-right: 10px; width:20px;">Compose Appointment Request</button>
            <button id="btnCancel">
                <img src="Content/img/cancel.png" width="20px" style="margin-top: -3px; margin-left: -2px; margin-right: 10px;">Cancel</button>
            <!--Appointment request Grid start -->
            <div style="margin-top: 20px; border: 1px solid; border-color: rgb(166, 201, 226); height: 190px; overflow-x: auto;"
                class="ui-corner-all">
                @Html.Partial("~/Views/Templates/Message/_Message_Appointment.cshtml", Model.Messages)  
            </div>
            <!-- Grid end appointment request-->
           <!--Appointment 2nd grid start here -->
            <div id="AppintmentDetailGrid" name="AppintmentDetailGrid" style="border: 1px solid; border-color: rgb(166, 201, 226); margin-top:10px;"
                class="ui-corner-all">
          
            </div> 
            <!--AppointmentDetail 2nd grid end here -->
           <div id="detail-Appointment-Request">
            </div>
       </Text>  }
              else
              {
         <div><p>You are not allowed to access Appointments</p></div>
         
              }


        </div> 
        
         
        <div id="tabs-3">
               <button id="composeButtonRefil" onclick="Javascript:SentMessageRefil('Compose');clearFields();">
        <img src="Content/img/meesage.png" style="margin-top: -5px; margin-left: -2px; margin-right: 10px; width:20px;">Compose Refill Request</button>
            
             @if (patRep.Medication == true)
             {<Text> 
            <button id="deleterefrill" onclick="deleterefrill();">
                <img src="Content/img/delete.gif"  width="20px" style="margin-top: -3px; margin-left: -2px; margin-right: 10px;">Delete</button>
            <!--Refill request Grid start -->
            <div style="margin-top: 20px; border: 1px solid; border-color: rgb(166, 201, 226); height: 190px; overflow-x: auto;"
                class="ui-corner-all">
                @Html.Partial("~/Views/Templates/Message/_Message_Refill.cshtml", Model.Messages) 
            </div>
            <!-- Grid end refill request-->
                 <!--Medication Refill 2nd grid start here -->
            <div id="RefillRequestDetailGrid" name="RefillRequestDetailGrid" style="border: 1px solid; border-color: rgb(166, 201, 226); margin-top:10px;"
                class="ui-corner-all">
          
            </div> 
            <!--Medication Refill 2nd grid end here -->
            <div id="detail-refill-request">
            </div>      </Text>  }
             else
             {
         <div><p>You are not allowed to acces Medication Refill</p></div>
         
             }
        </div> 
              
        
         
        <div id="tabs-4">
                    <button id="composeButtonRequest" onclick="Javascript:SentMessageRequest('Compose');clearFields();">
        <img src="Content/img/meesage.png" width="20px" style="margin-top: -5px; margin-left: -2px; margin-right: 10px; width:20px;">Compose Referral Request</button>
         
            
             @if (patRep.Messaging == true)
             {<Text> 
           <button id="ReferralDelete">
                <img src="Content/img/delete.gif" width="20px" style="margin-top: -4px; margin-left: -2px; margin-right: 10px;">Delete</button>
            <!--Referral Request Grid start -->
            <div style="margin-top: 20px; border: 1px solid; border-color: rgb(166, 201, 226); height: 190px; overflow-x: auto;"
                class="ui-corner-all">
                  @Html.Partial("~/Views/Templates/Message/_Message_Refferal.cshtml", Model.Messages)
            </div>
            <!-- Grid end Referral Request-->
            <!--Medication Refill 2nd grid start here -->
            <div id="ReferralRequestDetailGrid" name="ReferralRequestDetailGrid" style="border: 1px solid; border-color: rgb(166, 201, 226); margin-top:10px;"
                class="ui-corner-all">
          
            </div> 
            <!--Medication Refill 2nd grid end here -->
            <div id="detail-Referral-Request">
            </div>   </Text>  }
             else
             {
         <div ><p>You are not allowed to Refill Requests</p></div>
         
             }
        </div>
        
        <div id="tabs-5">
            
            <button class="DeleteMessageRcorod" id="SentDeleteMessage">
                <img src="Content/img/delete.gif" width="20px" style="margin-top: -3px; margin-left: -2px; margin-right: 10px;" >Delete</button>
            <!--sentitem Grid start -->
            
            <div id="MessageSentHeaderGrid" style="margin-top: 20px; border: 1px solid; border-color: rgb(166, 201, 226); height: 190px; overflow-x: auto;"
                class="ui-corner-all">
                 @Html.Partial("~/Views/Templates/Message/_Message_Sent.cshtml", Model.Messages)  
                @*<table id="box-table-a" summary="Medications">
                    <thead>
                        <tr>
                            <th scope="col" style="margin-right: 10px;">
                               <input name="check" type="checkbox" class="CheckAll" onclick="checkAll('chk1');"/>
                            </th>
                            <th scope="col">
                                <div style="margin-left: 20px;">
                                    <img src="Content/img/i.png" />
                                </div>
                            </th>
                            <th scope="col">
                                <div style="margin-left: 20px;">
                                    From
                                </div>
                            </th>
                            <th scope="col">
                                <div style="margin-left: 30px;">
                                    To
                                </div>
                            </th>
                            <th scope="col">
                                <div style="margin-left: 80px;">
                                    Date
                                </div>
                            </th>
                            <th scope="col">
                                <div style="margin-left: 60px;">
                                    Subject
                                </div>
                            </th>
                            
                            <th scope="col">
                                <div style="margin-left: 90px; ">
                                    Detail
                                </div>
                            </th>
                        </tr>
                    </thead>
                     <tbody>
                        @foreach (var item in Model.Messages.Select((x, i) => new { PatientMessageModel = x, Index = i + 1 }))
                        {
                            if (item.PatientMessageModel.MessageType == "Billing Message" || item.PatientMessageModel.MessageType == "General Inquiry")
                            {
                           <tr class="@((item.Index % 2 == 1) ? "r1" : "r0")" >
                                <td>
                                   
                                    <input type="checkbox" id="chk1" value="1" name="chk[]" />
                                </td>
                                <td></td>
                                <td>
                                   <div style="margin-left: 20px;">
                                       @item.PatientMessageModel.CreatedByName  
                                    </div>
                                </td>
                                <td>
                                   <div style="margin-left: 30px;">
                                        @item.PatientMessageModel.ProviderName_To
                                   </div>
                                </td>
                                <td>
                                   <div style="margin-left: 80px;">
                                         @item.PatientMessageModel.MessageUrgency
                                    </div>
                                </td>
                                <td>
                                   <div style="margin-left: 60px;">
                                        @item.PatientMessageModel.MessageType
                                    </div>
                                </td>

                               <td>
                                   <div style="margin-left: 88px;" > <img src="Content/img/details.png" onclick="sentDetail(@item.PatientMessageModel.MessageId);"/>
                                      
                                    </div>
                                </td>
                            </tr>
                            }
                        } 
                    </tbody>
                </table>*@
            </div>
            <!-- Grid end sentitem-->
            <!-- Reply Part-->
        <!--Inbox 2nd grid start here -->
            <div id="MessageSentDetailGrid" name="MessageSentDetailGrid" style="border: 1px solid; border-color: rgb(166, 201, 226); margin-top:10px;"
                class="ui-corner-all">
          
            </div> 
            <!--Inbox 2nd grid end here -->
            <!-- Reply Part-->
      
            <!--End of reply part-->
            <div id="detail-sent-request">

            </div>
</div>

        <div id="tabs-6">
            
            <button style="display:none;">
                <img src="Content/img/delete.gif" width="20px" style="margin-top: -3px; margin-left: -2px; margin-right: 10px;">Delete</button>
            <button style="display:none;">
                <img src="Content/img/delete.gif" width="20px" style="margin-top: -3px; margin-left: -2px; margin-right: 10px;">Restore</button>
            <!--deleted Grid start -->
            <div id="deletegrid" style="margin-top: 20px; border: 1px solid; border-color: rgb(166, 201, 226); height: 190px; overflow-x: auto;"
                class="ui-corner-all">
                @Html.Partial("~/Views/Templates/Message/_Message_Delete.cshtml", Model.Messages)
                @*<table id="box-table-a" summary="Medications">
                    <thead>
                        <tr>
                            <th scope="col" style="margin-right: 10px;">
                          
                                 <input name="check" type="checkbox" class="CheckAll" onclick="checkAll('chk2');"/>
                            </th>
                            <th scope="col">
                                <div style="margin-left: 20px;">
                                    <img src="Content/img/i.png" />
                                </div>
                            </th>
                            <th scope="col">
                                <div style="margin-left: 20px;">
                                    From
                                </div>
                            </th>
                            <th scope="col">
                                <div style="margin-left: 30px;">
                                    To
                                </div>
                            </th>
                            <th scope="col">
                                <div style="margin-left: 80px;">
                                    Date
                                </div>
                            </th>
                            <th scope="col">
                                <div style="margin-left: 60px;">
                                    Subject
                                </div>
                            </th>
                            <th scope="col">
                                <div style="margin-left: 40px;">
                                    Detail
                                </div>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model.Messages.Select((x, i) => new { PatientMessageModel = x, Index = i + 1 }))
                        {
                            if (item.PatientMessageModel.MessageStatusId == "7")
                            {
                           <tr class="@((item.Index % 2 == 1) ? "r1" : "r0")" >
                            <td>
                                   
                                    <input type="checkbox" id="chk2" value="1" name="chk[]" />
                            </td>
                            <td></td>
                            <td>
                                <div style="margin-left: 20px;">
                                       @item.PatientMessageModel.CreatedByName  
                                </div>
                            </td>
                            <td>
                                <div style="margin-left: 30px;">
                                        @item.PatientMessageModel.ProviderName_To
                                </div>
                            </td>
                            <td>
                                <div style="margin-left: 80px;">
                                         @item.PatientMessageModel.MessageUrgency
                                </div>
                            </td>
                            <td>
                                <div style="margin-left: 60px;">
                                        @item.PatientMessageModel.MessageType
                                    </div>
                                </td>

                               <td>
                                   <div style="margin-left: 50px;" > <img src="Content/img/details.png" onclick="deleteDetail(@item.PatientMessageModel.MessageId);"/>
                                      
                                </div>
                            </td>
                        </tr>
                            }
                        } 
                    </tbody>
                </table>*@
            </div>
            <!-- Grid end deleted-->
            <!-- Reply Part-->
  <div id="MessageDeleteDetailGrid" name="MessageDeleteDetailGrid" style="border: 1px solid; border-color: rgb(166, 201, 226); margin-top:10px;"
                class="ui-corner-all">
          
            </div> 
            <!--End of reply part-->
    <div id="detail-delete-request">

            </div>
        </div> 
            </div>
            </div> 
         
<!-- Start Office Document Iframe Page -->
<div id="divOfficeDocIframe" style="display:none;">
    <iframe id="iframeViewAttachment" onload="HideLoaderReportViewer();" style="border: 0px;" src="" width="100%" height="100%"></iframe>
</div>

<!--pop up Appointment button -->

<div id="appbtn-form" title="Appointment Request">
    <center>  <span   class="validateTips"></span></center>
    <table width="100%" height="433" border="0
        " cellpadding="0" cellspacing="2">
        <tr>
            <td width="250" height="35" align="right">Location :</td>
            <td width="2">&nbsp;</td>
            <td colspan="2">
          
                @Html.DropDownList("cmbAppointmentFacility1", Model.MessageFacilities.ToFacilityModelWithoutPatientEnteredSelectList(), new { @class = "txt  ui-corner-all bcom", style = "width:400px;", id = "cmbAppointmentFacility1", @onchange = "LoadFacityProvider();" })
                <span id="apDiv9">

    

</span>
            </td>
        </tr>
        <tr>
            <td width="250" height="35" align="right">Provider :</td>
            <td align="right">&nbsp;</td>
            <td colspan="2">
                <div id="DivFacityProvider">
                @Html.Partial("_FacilityProvider", Model.Providers)
                @*@Html.DropDownList("cmbAppointmentDoctor1", Model.Providers.ToProviderModelSelectList(), new { @class = " txt  ui-corner-all bcom", style = "width:400px;", id = "cmbAppointmentDoctor1" })*@
            </div>
                    </td>
        </tr>
        <tr>
              <td  ><div style="float:right;margin-Top:4px;">Urgent :</div></td>
                    <td align="right">&nbsp;</td>
                        <td  colspan="2">
                            <select id="cmbMessageUrgency1" class="txt" style="width:90px">
                     @* <option value="-1">--Select--</option>*@
                      
                      <option value="false" selected="selected">No</option><option value="true">Yes</option>
</select>    
                            @*<div style="margin-left:0px;">
                              @Html.DropDownList("cmbMessageUrgency1", Model.MessageUrgencyType.ToMessageUrgencySelectList(), new { @class = "txt  ui-corner-all bcom", style = "width:150px; ", id = "cmbMessageUrgency1" })
                          </div>*@
                        </td>
        </tr>
        <tr>
            <td width="250"  align="right" style="padding-top:7px;" valign="Top">Preferred Time of Day :</td>
            <td>&nbsp;</td>
            <td colspan="2">
                <table width="439" border="0" cellpadding="0" cellspacing="0">
                    <tr>
                         <td >
                            <input type="checkbox" name="mor_chk" id="chkmor" style=""/></td>
                        <td width="50"><div style="margin-left:5px;margin-Top:4px;">Morning</div></td>
                        <td width="21">
                            <input type="checkbox" name="aft_chk" id="chkAft" style="margin-left:10px;"/></td>
                        <td width="68"  ><div style="margin-left:5px;margin-Top:4px;">Afternoon</div></td>
                        <td width="21">
                            <input type="checkbox" name="eve_chk" id="chkeve" style="margin-left:10px;" /></td>
                        <td width="84"  ><div style="margin-left:5px;margin-Top:4px;">Evening</div></td>
                        <td width="61"  ><div style="margin-left:15px;margin-Top:4px;"></div></td>
                        <td width="119">
                            <div style="margin-left:3px;">
                             @* @Html.DropDownList("cmbMessageUrgency1", Model.MessageUrgencyType.ToMessageUrgencySelectList(), new { @class = "txt  ui-corner-all bcom", style = "width:150px; margin-left:20px;", id = "cmbMessageUrgency1" })*@
                          </div>
                        </td>
                    </tr>
                </table>
                <label for="urg_com"></label>
            </td>
        </tr>
        <tr>
            <td width="250" valign="Top" style="padding-top:7px;" align="right">Preferred Day :</td>
            <td>&nbsp;</td>
            <td colspan="2">
                <table width="445" border="0" cellpadding="0" cellspacing="0">
                    <tr>
                 <td >
                            <input type="checkbox" name="mon_chk" id="chkmon" style="" /></td>
                        <td ><div style="margin-left:2px;margin-top:4px;">Monday</div></td>
                        <td >
                            <input type="checkbox" name="tue_chk" id="chktue" style="margin-left:10px;"/></td>
                        <td ><div style="margin-left:2px;margin-top:4px;"">Tuesday</div></td>
                        <td >
                            <input type="checkbox" name="wed_chk" id="chkwed" style="margin-left:10px;"/></td>
                        <td ><div style="margin-left:2px;margin-top:4px;"">Wednesday</div></td>
                        <td >
                            <input type="checkbox" name="thu_chk" id="chkthu" style="margin-left:10px;"/></td>
                        <td ><div style="margin-left:2px;margin-top:4px;"">Thursday</div></td>
                        
                    </tr>
                    <tr>
<td >
                            <input type="checkbox" name="fri_chk" id="chkfri" /></td>
                        <td ><div style="margin-left:2px;margin-top:4px;">Friday</div></td>
                        <td >
                            <input type="checkbox" name="fri_chk" id="chksat" style="margin-left:10px;"/></td>
                        <td ><div style="margin-left:2px;margin-top:4px;">Saturday</div></td>
                        <td >
                            <input type="checkbox" name="fri_chk" id="chksun" style="margin-left:10px;"/></td>
                        <td ><div style="margin-left:2x;margin-top:4px;">Sunday</div></td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td width="250" height="35" align="right">Preferred Date Range :</td>
            <td>&nbsp;</td>
            <td colspan="2">
                <table width="367" border="0" cellpadding="0" cellspacing="0">
                    <tr>
                        <td width="118">
                            <input type="text" name="pref_txt" id="txtPrefDateFrom" class="com" /></td>
                        <td>    <img id="show-date-PreferedStart" src="Content/img/calender.png" style="margin-top:-3px; cursor:pointer; margin-left:-15px;"/></td>
                        <td width="19">&nbsp;</td>
                        <td width="19">&nbsp;</td>
                        <td width="216">
                            <input type="text" name="pref_txt" id="txtPrefDateTo" class="com" /></td>
                        <td>    <img id="show-date-PreferredEnd" src="Content/img/calender.png" style="margin-top:-3px; cursor:pointer; margin-left:-105px;"/></td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td width="250" height="35" align="right">Preferred Time: </td>
            <td>&nbsp;</td>
            <td colspan="2">
                <select name="preft_com" id="cmbPreftime" class="com">
                      <option value="-1">--select--</option>                    
  <option value="7">7:00 am</option>
  <option value="8">8:00 am</option>
  <option value="9">9:00 am</option>
  <option value="10">10:00 am</option>
  <option value="11">11:00 am</option>
  <option value="12">12:00 pm</option>
  <option value="13">1:00 pm</option>
  <option value="14">2:00 pm</option>
  <option value="15">3:00 pm</option>
  <option value="16">4:00 pm</option>
  <option value="17">5:00 pm</option>
  <option value="18">6:00 pm</option>
 <option value="19">7:00 pm</option>
  <option value="20">8:00 pm</option>

                </select>
                
            </td>
        </tr>
        <tr>
            <td width="250" height="33" align="right">Reason for Visit :</td>
            <td>&nbsp;</td>
            <td colspan="2">
                <input type="text" name="reas_txt" id="txtReason" class="btxt" /></td>
        </tr>
        <tr>
            <td width="250" align="right">Comments :</td>
            <td>&nbsp;</td>
            <td colspan="2">
                <textarea name="comm_txta" cols="45" rows="5" class="btxta" id="txtComment" maxlength="256"></textarea></td>
        </tr>
        <tr>
            
            <td colspan="3" align="right"><div id="appcount"></div></td>
        </tr>


    </table>

</div>


<!--popup up modal refill-->

@*<div id="dialog-refill" title="Refill Request">
    <center>  <span   class="validateTips"></span></center>
    <table border="0" width="100%" height="300px">
        <tr>
            <td width="30%" height="40"><span class="form_text" style="color: #000066;">Location:</span></td>
            <td>

                  @Html.DropDownList("cmbAppointmentFacilityRefill", Model.MessageFacilities.ToFacilityModelWithoutPatientEnteredSelectList(), new { @class = "txt  ui-corner-all bcom", style = "width:400px;", id = "cmbAppointmentFacilityRefill" , @onchange = "LoadFacilityProviderRequestRefill();" })
            </td>
        </tr>

        <tr>
            <td width="30%" height="40"><span class="form_text" style="color: #000066;">Medication:</span></td>
            <td>
                @Html.DropDownList("cmbMedication", Model.Medications.ToMedicalModelSelectList(), new { @class = " txt  ui-corner-all", style = "width:400px;", id = "cmbMedication" })
            </td>
        </tr>


        <tr>
            <td width="30%" class="form_text" style="color: #000066;">Doctor: </td>
            <td>
               <div id="DivFacilityProviderRequestRefill">
                @Html.DropDownList("cmbDoctor", Model.Providers.ToProviderModelSelectList(), new { @class = " txt  ui-corner-all", style = "width:400px;", id = "cmbDoctor" })
                   </div>
            </td>
        </tr>

        <tr>
            <td width="30%" class="form_text" style="color: #000066;">Number of Refills: </td>
            <td>
                <input type="text" name="txtCountRefills" id="txtCountRefills" class="txt ui-corner-all" />
            </td>
        </tr>
        <tr>
            <td width="30%" class="form_text" style="color: #000066;">Pharmacy: </td>
            <td>

               @Html.DropDownList("cmbRFPharmacy", Model.PharmciesForRefill.ToPharmacyModelForRefillSelectList(), new { @class = "txt  ui-corner-all", style = "width:200px;", id = "cmbRFPharmacy" })
                <div id="PharmAddress" style="color:red;"></div>
            </td>
        </tr>

        <tr>
            <td width="30%" class="form_text" style="color: #000066;">Comments: </td>
            <td>
                <textarea multiline="true" style="height: 96px; width: 453px;" id="txtComments" rows="3" cols="5" class="txt  ui-corner-all"></textarea>
            </td>
        </tr>



    </table>

</div>*@
<div id="dialog-refill" title="Refill Request">
    <center>  <span   class="validateTips"></span></center>
    <table border="0" width="100%" height="300px">
        <tr>
            <td width="30%" height="40"><span class="form_text" style="color: #000066;">Location:</span></td>
            <td>

                  @Html.DropDownList("cmbAppointmentFacilityRefill", Model.MessageFacilities.ToFacilityModelWithoutPatientEnteredSelectList(), new { @class = "txt  ui-corner-all bcom", style = "width:400px;", id = "cmbAppointmentFacilityRefill", @onchange = "LoadFacityProviderRefil();LoadRefilmediaction();" })
    

            </td>
        </tr>
        <tr>
            <td width="30%" class="form_text" style="color: #000066;">Doctor: </td>
            <td>
                <div id="refildiv">
                @Html.Partial("_CmbRefildoctorDropDown", Model.Providers)
                    </div>

           @*    @Html.DropDownList("cmbDoctor", Model.Providers.ToProviderModelSelectList(), new { @class = " txt  ui-corner-all", style = "width:200px;", id = "cmbDoctor" })*@

            </td>
        </tr>
        <tr>
            <td width="30%" height="40"><span class="form_text" style="color: #000066;">Medication:</span></td>
            <td>
                <div id="refilmed">
                @Html.Partial("_Index_RefillMedication", Model.Medications)
                    </div>
            </td>
        </tr>


        

        <tr>
            <td width="30%" class="form_text" style="color: #000066;">Number of Refills: </td>
            <td>
                <input type="text" name="txtCountRefills" id="txtCountRefills" class="txt ui-corner-all" />
            </td>
        </tr>
        <tr>
            <td width="30%" class="form_text" style="color: #000066;">Pharmacy: </td>
            <td>
                <table>
<tr><td>
<div id="cmbPharmacy">

          
                 @Html.Action("RefillPharmacypartialview", "Home", new { @class = "txt  ui-corner-all", style = "width:200px;", id = "cmbRFPharmacy" })
              
 </div>
</td>
<td><span><img  src="Content/img/add.png" />
<span id="addPharmacy" class="anc" onclick="OpenPharmacyDialoge();" style="font-size: 13px; padding-right: 17px;">Add</span></span>
</td>
</tr>
</table>
               <div > </div> <div id="PharmAddress" style="color:red;"></div><div><input type="hidden" id="Phone" value="" /></div>
            </td>
            
        </tr>

        <tr>
            <td width="30%" class="form_text" style="color: #000066;">Comments: </td>
            <td>
                <textarea multiline="true" style="height: 96px; width: 453px;" id="txtComments" rows="3" cols="5" class="txt  ui-corner-all" maxlength="256"></textarea>
            </td>
        </tr>

         <tr>
            
            <td colspan="3" align="right"><div id="refillcount"></div></td>
        </tr>


    </table>

</div>
<!-- end of modal popup refill-->
<!--pop up of Request Referral button -->
<div id="reqbtn-form" title="Referral Request">
    <table width="100%" border="0" cellpadding="0" cellspacing="2">
        <tr>
            <td width="250" height="35" align="right">Location :</td>
            <td width="2">&nbsp;</td>
            <td width="571">
               
                   @Html.DropDownList("cmbAppointmentFacility3", Model.MessageFacilities.ToFacilityModelWithoutPatientEnteredSelectList(), new { @class = "txt  ui-corner-all bcom", style = "width:400px;", id = "cmbAppointmentFacility3", @onchange = "LoadFacilityProviderRequestRefferal();" })
         <span id="apDiv9">

    <img id="loader4" src="Content/img/login-loaderwhite.gif" style="margin-left: 420px; margin-top: -30px; display: none;"></img>

</span>
            </td>
        </tr>

        <tr>
            <td width="250" height="35" align="right">Send Request to :</td>
            <td width="2">&nbsp;</td>
            <td width="571">
                
                  <div id="DivFacilityProviderRequestRefferal">
                @Html.Partial("_FacilityProviderRequestRefferal", Model.Providers)
                
            </div>
                   @*@Html.DropDownList("cmbRProvider", Model.Providers.ToProviderModelSelectList(), new { @class = " txt  ui-corner-all bcom", style = "width:400px;", id = "cmbRProvider" })*@
         </td>
        </tr>
        <tr>
            <td width="250" height="35" align="right">Reason for Referral :</td>
            <td align="right">&nbsp;</td>
            <td>
                <input type="text" name="reas_txt3" id="txtReqRes" class="btxt" /></td>
        </tr>
        <tr>
            <td width="250" height="35" align="right">Comments :</td>
            <td>&nbsp;</td>
            <td>
                <textarea name="comm_txta2" cols="45" rows="5" class="btxta" id="txtRComm" maxlength="256"></textarea></td>
        </tr>
              <tr>
            
            <td colspan="3" align="right">
                <div id="referallcount"></div>

            </td>
        </tr>
        @*<tr>
            <td width="250" height="35" align="right" style="padding-top:10px;" valign="Top">Preferred Period  :</td>
            <td>&nbsp;</td>
            <td>
                <table width="439" border="0" cellpadding="0" cellspacing="0">
                    <tr>
                        <td >
                            <input type="checkbox" name="mor_chk2" id="chkRmor" style="" /></td>
                        <td style="padding-top:7px;padding-left:7px;" valign="Top">Morning</td>
                        <td style="padding:4px;">
                            <input type="checkbox" name="aft_chk2" id="chkRaft" style="margin-left:10px;" /></td>
                        <td style="padding-top:7px;padding-left:7px;" valign="Top">Afternoon</td>
                        <td style="padding:4px;">
                            <input type="checkbox" name="eve_chk2" id="chkReve" style="margin-left:10px;" /></td>
                        <td style="padding-top:7px;padding-left:7px;" valign="Top">Evening</td>
                        <td style="padding-top:8px; padding-left:15px;" valign="Top">Urgency:</td>
                        <td width="119">
                             @Html.DropDownList("cmbRMessageUrgency", Model.MessageUrgencyType.ToMessageUrgencySelectList(), new { @class = "txt  ui-corner-all bcom", style = "width:150px; margin-left:20px;", id = "cmbRMessageUrgency" })
                          </td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td width="250" height="35" align="right" valign="Top" style="padding-top:6px;">Week Day :</td>
            <td>&nbsp;</td>
            <td>
                <table width="445" border="0" cellpadding="0" cellspacing="0">
                    <tr>
                        <td >
                            <input type="checkbox" name="mon_chk" id="chkRmon" style="margin-left:0px;"/></td>
                        <td ><div style="margin-left:5px;">Monday</div></td>
                        <td >
                            <input type="checkbox" name="tue_chk" id="chkRtue" style="margin-left:10px;"/></td>
                        <td ><div style="margin-left:5px;">Tuesday</div></td>
                        <td >
                            <input type="checkbox" name="wed_chk" id="chkRwed" style="margin-left:10px;"/></td>
                        <td ><div style="margin-left:5px;">Wednesday</div></td>
                        <td >
                            <input type="checkbox" name="thu_chk" id="chkRthu" style="margin-left:10px;"/></td>
                        <td ><div style="margin-left:5px;">Thursday</div></td>
                    </tr>
                     <tr>
                        <td >
                            <input type="checkbox" name="fri_chk" id="chkRfri" style="margin-left:0px;"/></td>
                        <td ><div style="margin-left:5px;">Friday</div></td>
                        <td >
                            <input type="checkbox" name="fri_chk" id="chkRsat" style="margin-left:10px;"/></td>
                        <td ><div style="margin-left:5px;">Saturday</div></td>
                        <td >
                            <input type="checkbox" name="fri_chk" id="chkRsun" style="margin-left:10px;"/></td>
                        <td ><div style="margin-left:5px;">Sunday</div></td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td width="250" height="35" align="right">Preferred Date Range :</td>
            <td>&nbsp;</td>
            <td>
                <table width="367" border="0" cellpadding="0" cellspacing="0">
                    <tr>
                        <td width="118">
                            <input type="text" name="pref_txt" id="txtRpredatefrom" class="com" /></td>
                        <td>    <img id="show-date-refPrefStart" src="Content/img/calender.png" style="margin-top:-5px; cursor:pointer; margin-left:-12px;"/></td>
                        <td width="19">&nbsp;</td>
                        <td width="216">
                            <input type="text" name="pref_txt" id="txtRpredateto" class="com" /></td>
                         <td>    <img id="show-date-refPrefEnd" src="Content/img/calender.png" style="margin-top:-5px; cursor:pointer; margin-left:-100px;"/></td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td width="250" height="33" align="right">Preferred Time :</td>
            <td>&nbsp;</td>
            <td>
                <select name="preft_com" id="cmbRprefTime" class="com">
                    <option value="-1">--Select--</option>
                      <option value="0">12:00 am</option>
  <option value="1">1:00 am</option>
  <option value="2">2:00 am</option>
  <option value="3">3:00 am</option>
  <option value="4">4:00 am</option>
  <option value="5">5:00 am</option>
  <option value="6">6:00 am</option>
  <option value="7">7:00 am</option>
  <option value="8">8:00 am</option>
  <option value="9">9:00 am</option>
  <option value="10">10:00 am</option>
  <option value="11">11:00 am</option>
  <option value="12">12:00 pm</option>
  <option value="13">1:00 pm</option>
  <option value="14">2:00 pm</option>
  <option value="15">3:00 pm</option>
  <option value="16">4:00 pm</option>
  <option value="17">5:00 pm</option>
  <option value="18">6:00 pm</option>
  <option value="19">7:00 pm</option>
  <option value="20">8:00 pm</option>
  <option value="21">9:00 pm</option>
  <option value="22">10:00 pm</option>
  <option value="23">11:00 pm</option>
                </select></td>
        </tr>*@


    </table>


</div>
<div id="dialog-pharmacy" title="Add a Pharmacy">
           
    <table border="0" width="100%">

        <tr>
            <td align="right" width="145px;"><span style="color:red;"  >*</span><span class="form_text"  >Pharmacy Name : </span></td>
            <td>
                <input type="hidden" id="txtPharmID" value="0" />
                <input type="text" name="name" id="txtPharmacyName" class="txt ui-corner-all" style="width: 240px;"/>
            </td>
        </tr>
           <tr>
        <td align="right"><span style="color:red;"  >*</span><span class="form_text" >Address Line 1 : </span> </td>
                <td>
                <input type="text" name="name" id="txtPharmAddress1" style="width: 240px;" class="txt ui-corner-all" />
            </td>
        </tr>
        <tr>
            <td align="right"><span class="form_text" >Address Line 2 : </span></td>
           
            <td>
                <input type="text" name="name" id="txtPharmAddress2" style="width: 240px;" class="txt ui-corner-all" /></td>
        </tr>
            <tr>
            <td align="right"><span style="color:red;"  >*</span><span class="form_text" >City : </span></td>
           
            <td>
                <input type="text" name="name" id="txtPharmCity" class="txt ui-corner-all" width="150px;" /></td>
          
        </tr>

            <tr>
            <td align="right"><span style="color:red;"  >*</span><span class="form_text" >State : </span></td>
           
           <td>
                @*<input type="text" name="name" id="txtPharmState" class="txt ui-corner-all" />*@
               <select style="visibility: visible;" class="coms" name="state" id="cmbStates" tabindex="11">
									
										<option value="AL">AL</option>
									
										<option value="AK">AK</option>
									
										<option value="AS">AS</option>
									
										<option value="AZ">AZ</option>
									
										<option value="AR">AR</option>
									
										<option value="AA">AA</option>
									
										<option value="AE">AE</option>
									
										<option value="AP">AP</option>
									
										<option value="CA">CA</option>
									
										<option value="CO">CO</option>
									
										<option value="CT">CT</option>
									
										<option value="DE">DE</option>
									
										<option value="DC">DC</option>
									
										<option value="FL">FL</option>
									
										<option value="GA">GA</option>
									
										<option value="GU">GU</option>
									
										<option value="HI">HI</option>
									
										<option value="ID">ID</option>
									
										<option value="IL">IL</option>
									
										<option value="IN">IN</option>
									
										<option value="IA">IA</option>
									
										<option value="KS">KS</option>
									
										<option value="KY">KY</option>
									
										<option value="LA">LA</option>
									
										<option value="ME">ME</option>
									
										<option value="MH">MH</option>
									
										<option value="MD">MD</option>
									
										<option value="MA">MA</option>
									
										<option value="MI">MI</option>
									
										<option value="FM">FM</option>
									
										<option value="MN">MN</option>
									
										<option value="MS">MS</option>
									
										<option value="MO">MO</option>
									
										<option value="MT">MT</option>
									
										<option value="NE">NE</option>
									
										<option value="NV">NV</option>
									
										<option value="NH">NH</option>
									
										<option value="NJ">NJ</option>
									
										<option value="NM">NM</option>
									
										<option value="NY">NY</option>
									
										<option value="NC">NC</option>
									
										<option value="ND">ND</option>
									
										<option value="MP">MP</option>
									
										<option value="OH">OH</option>
									
										<option value="OK">OK</option>
									
										<option value="OR">OR</option>
									
										<option value="PW">PW</option>
									
										<option value="PA">PA</option>
									
										<option value="PA">PA</option>
									
										<option value="PR">PR</option>
									
										<option value="RI">RI</option>
									
										<option value="SC">SC</option>
									
										<option value="TN">TN</option>
									
										<option value="TX">TX</option>
									
										<option value="UT">UT</option>
									
										<option value="VT">VT</option>
									
										<option value="VI">VI</option>
									
										<option value="VA">VA</option>
									
										<option value="WA">WA</option>
									
										<option value="WV">WV</option>
									
										<option value="WI">WI</option>
									
										<option value="WY">WY</option>
									
										<option value="SD">SD</option>
									
								</select>
            </td>
        </tr>

        <tr>
            <td align="right"><span style="color:red;"  >*</span><span class="form_text" >Zip Code : </span></td>
           
          <td>
                <input type="text" name="name" id="txtPharmZipCode" class="txt ui-corner-all" style="width: 100px;" />
            </td>
        </tr>


          <tr>
            <td align="right"><span class="form_text" >Phone : </span></td>
           
          <td>
                <input type="text" name="name" id="txtPhone" style="width: 190px;" class="txt ui-corner-all" />
            </td>
        </tr>
           <tr>
            <td align="right"><span class="form_text" >Website : </span></td>
           
          <td>
       <input type="text" name="name" id="txtWebsite" style="width: 240px;" class="txt ui-corner-all" />
            </td>
        </tr>



      
        
    </table>

  
    <table style="margin-top: -15px;">
        <tr>
          
        </tr>
        
    </table>

  @*  <hr style="margin-top: 10px;">*@

    @*<table style="margin-top: -15px;">

        <tr>
            <td width="30%"><span class="form_text" style="color: #000066;">City:</span> </td>
            <td width="30%"><span class="form_text" style="color: #000066;">State/Province: </span></td>
            <td width="30%"><span class="form_text" style="color: #000066;">Zip/PostalCode:</span></td>
        </tr>
        <tr>
         <td>
                <input type="text" name="name" id="txtPharmCity" class="txt ui-corner-all" /></td>
            <td>
                <input type="text" name="name" id="txtPharmState" class="txt ui-corner-all" />
            </td>
            <td>
                <input type="text" name="name" id="txtPharmZipCode" class="txt ui-corner-all" />
            </td>
        </tr>
    </table>*@
  @*  <hr style="margin-top: 10px;">
    <h3 style="margin-top: -15px; color: rgb(29, 89, 135); font-size: 22px;">Contact</h3>
    <p style="margin-top: -10px; color: #9B9B9B;"><i>The Following fields are optional</i></p>
    <hr style="margin-top: 10px;">*@
    @*<table style="margin-top: -15px;">

        <tr>
            <td width="30%"><span class="form_text" style="color: #000066;">Phone: </span></td>
            <td width="60%"><span class="form_text" style="color: #000066;">Website:</span> </td>
        </tr>
        <tr>
            <td>
                <input type="text" name="name" id="txtPhone" style="width: 190px;" class="txt ui-corner-all" />
            </td>
            <td>
                <input type="text" name="name" id="txtWebsite" style="width: 370px;" class="txt ui-corner-all" /></td>
        </tr>
    </table>*@
    @*<hr style="margin-top: 10px;">*@
    <h3 style="margin-top: 25px; color: rgb(29, 89, 135); font-size: 22px;">Preferred Pharmacy</h3>
    <table>
        <tr>
            <td width="30%"><span class="form_text">
                <input name="chk" type="checkbox" value="" id="chkPref">
            </span></td>
            <td width="-20%"><span class="form_text" style="margin-left: -80px; color: #9B9B9B;">Would you like to make this your preferred pharmacy?</span> </td>
        </tr>
    </table>
</div>
<div id="dialog-confirm">

</div>
<div id="dialog-confirmDeletetab">

</div>
<div id="dialog-confirmDeletetabrefil">

</div>
<div id="dialog-confirmDeletetabreferral">

</div>
<div id="dialog-Appointment">

</div>


<!--End of popup of Request Referral button -->
<!-- Start Office Document Iframe Page -->

<!--delete ajax -->
    <script>
        function fnOpenInoboxDialog() {
            $("#dialog-confirm").html("Are you sure you want to delete this message?");

            // Define the Dialog and its properties.
            $("#dialog-confirm").dialog({
                resizable: false,
                modal: true,
                title: "Confirm",
                height: 140,
                width: 400,
                buttons: {
                    "Yes": function () {
                        $(this).dialog('close');
                        deleteInboxRecord();
                    },
                    "No": function () {
                        $(this).dialog('close');
                        //callback(false);
                    }
                }
            });

        }
        function fnOpenDeletedDialog() {
            $("#dialog-confirmDeletetab").html("Are you sure you want to delete this message?");

            // Define the Dialog and its properties.
            $("#dialog-confirmDeletetab").dialog({
                resizable: false,
                modal: true,
                title: "Confirm",
                height: 140,
                width: 400,
                buttons: {
                    "Yes": function () {
                        $(this).dialog('close');
                        deleteSentRecord();
                    },
                    "No": function () {
                        $(this).dialog('close');
                        //callback(false);
                    }
                }
            });

        }
        function fnOpenAppDialog() {
            $("#dialog-confirmDeletetab").html("Are you sure you want to cancel the selected Appointments?");

            // Define the Dialog and its properties.
            $("#dialog-confirmDeletetab").dialog({
                resizable: false,
                modal: true,
                title: "Confirm",
                height: 140,
                width: 500,
                buttons: {
                    "Yes": function () {
                        $(this).dialog('close');
                        CancelApp();
                    },
                    "No": function () {
                        $(this).dialog('close');
                        //callback(false);
                    }
                }
            });

        }
  
        $('#InboxDeleteMessage').click(fnOpenInoboxDialog);
        $('#SentDeleteMessage').click(fnOpenDeletedDialog);
        $('#btnCancel').click(fnOpenAppDialog);
        $('#deleterefrill').click(fnopenrefillDialog);

        $('#ReferralDelete').click(fnopenreferralllDialog);

        function fnopenrefillDialog()
        {
            
            $("#dialog-confirmDeletetabrefil").html("Are you sure you want to delete this message?");

            // Define the Dialog and its properties.
            $("#dialog-confirmDeletetabrefil").dialog({
                resizable: false,
                modal: true,
                title: "Confirm",
                height: 140,
                width: 500,
                buttons: {
                    "Yes": function () {
                        $(this).dialog('close');
                        DeleleRefillRecord();
                    },
                    "No": function () {
                        $(this).dialog('close');
                        //callback(false);
                    }
                }
            });


        }

        function fnopenreferralllDialog()
        {
            $("#dialog-confirmDeletetabreferral").html("Are you sure you want to delete this message?");

            // Define the Dialog and its properties.
            $("#dialog-confirmDeletetabreferral").dialog({
                resizable: false,
                modal: true,
                title: "Confirm",
                height: 140,
                width: 500,
                buttons: {
                    "Yes": function () {
                        $(this).dialog('close');
                        DeleleReferrallRecord();
                    },
                    "No": function () {
                        $(this).dialog('close');
                        //callback(false);
                    }
                }
            });

        }

        function DeleleReferrallRecord() {
            var mesgType = "ReferrallDeleteMessage";
            var sList = "";
            if (mesgType == "ReferrallDeleteMessage") {
                //   alert('Sent');
                $('input[name="chkReferal[]"]').each(function () {
                    if (this.checked) {
                        sList += $(this).attr('class') + ",";
                    }

                });
            }


            if (sList == '') {
                alert("first select message before deleting ");
            }
            else {
                //alert(sList);
                //ajax call start for deleting inbox grid
                ShowLoader();
                try {
                    var requestData = {
                        DeletedMessageIDs: sList,
                        FacilityId: $.trim($('#cmbAppointmentFacility  option:selected').val()),
                        ProviderId_To: $.trim($('#cmbAppointmentDoctor  option:selected').val()),
                        MessageTypeId: $.trim($('#cmbMessageType  option:selected').val()),
                        MessageUrgencyId: $.trim($('#cmbMessageUrgency  option:selected').val()),
                        MessageType: mesgType

                    };

                    $.ajax({
                        type: 'POST',
                        url: 'inboxs-delete',
                        data: JSON.stringify(requestData),
                        dataType: 'json',
                        contentType: 'application/json; charset=utf-8',
                        success: function (data) {
                            // if success
                            // alert("Success : " + data);


                            $('#tabs-4 div:first').html(data.html);
                            $('#tabs-6 div:first').html(data.htmldelete);

                            // $("#MessageSentHeaderGrid").html(data);
                            //   $("#tbl-MessageSent").fixedHeaderTable();
                            $("#detail-Referral-Request").html("");
                            $("#tbl-MessageReferral").fixedHeaderTable();
                            $("#tbl-MessageDelete").fixedHeaderTable();

                            


                            //  $("#MessageHeaderGrid").html(data);
                            //  $("#tbl-messageInbox").fixedHeaderTable();

                            HideLoader();

                        },
                        error: function (xhr, ajaxOptions, thrownError) {
                            //if error
                            var myCookie = getCookie(".Patient");

                            if (myCookie == null) {
                                // do cookie doesn't exist stuff;
                                window.location = '/Login'
                                //xhr.getResponseHeader('Location');
                            }
                            else {

                                alert('Error : ' + xhr.message);
                            }
                            HideLoader();
                        },
                        complete: function (data) {
                            // if completed
                            HideLoader();

                        },
                        async: true,
                        processData: false
                    });

                } catch (err) {
        
                    if (err && err !== "") {
                        alert(err.message);
                        HideLoader();
                    }
                }


                //ajax call end for deleting inbox 


            }
        }
        function DeleleRefillRecord()
        {
            var mesgType = "RefillDeleteMessage";
            var sList = "";
            if (mesgType == "RefillDeleteMessage") {
                //   alert('Sent');
                $('input[name="chkR[]"]').each(function () {
                    if (this.checked) {
                        sList += $(this).attr('class') + ",";
                    }

                });
            }


            if (sList == '') {
                alert("first select message before deleting ");
            }
            else {
                //alert(sList);
                //ajax call start for deleting inbox grid
                ShowLoader();
                try {
                    var requestData = {
                        DeletedMessageIDs: sList,
                      //  FacilityId: $.trim($('#cmbAppointmentFacility  option:selected').val()),
                      //  ProviderId_To: $.trim($('#cmbAppointmentDoctor  option:selected').val()),
                     //   MessageTypeId: $.trim($('#cmbMessageType  option:selected').val()),
                      //  MessageUrgencyId: $.trim($('#cmbMessageUrgency  option:selected').val()),
                        MessageType: mesgType

                    };

                    $.ajax({
                        type: 'POST',
                        url: 'inboxs-delete',
                        data: JSON.stringify(requestData),
                        dataType: 'json',
                        contentType: 'application/json; charset=utf-8',
                        success: function (data) {
                            // if success
                            // alert("Success : " + data);


                            $('#tabs-3 div:first').html(data.html);

                           // $("#MessageSentHeaderGrid").html(data);
                            //   $("#tbl-MessageSent").fixedHeaderTable();
                            $("#detail-refill-request").html("");
                            $("#tbl-MessageRefill").fixedHeaderTable();

                            $('#tabs-6 div:first').html(data.htmldelete);

                            $("#tbl-MessageDelete").fixedHeaderTable();


                            //  $("#MessageHeaderGrid").html(data);
                            //  $("#tbl-messageInbox").fixedHeaderTable();

                            HideLoader();

                        },
                        error: function (xhr, ajaxOptions, thrownError) {
                            //if error
                            var myCookie = getCookie(".Patient");

                            if (myCookie == null) {
                                // do cookie doesn't exist stuff;
                                window.location = '/Login'
                                //xhr.getResponseHeader('Location');
                            }
                            else {

                                alert('Error : ' + xhr.message);
                            }
                            HideLoader();
                        },
                        complete: function (data) {
                            // if completed
                            HideLoader();

                        },
                        async: true,
                        processData: false
                    });

                } catch (err) {

                    if (err && err !== "") {
                        alert(err.message);
                        HideLoader();
                    }
                }


                //ajax call end for deleting inbox 


            }
        }
            function deleteInboxRecord()
            {


                //e.preventDefault();
                //var par = $(e.target).parent();
                //alert(e.target.id);
                //var mesgType = e.target.id;
                //var sList = "";
                //if (e.target.id == "SentDeleteMessage") {
                //    alert('Sent');
                //    $('input[name="chkS[]"]').each(function () {
                //        if (this.checked) {
                //            sList += $(this).attr('class') + ",";
                //        }

                //    });
                //}
                //else {
                //    alert('Inbox');
                //    $('input[name="chk[]"]').each(function () {
                //        if (this.checked) {
                //            sList += $(this).attr('class') + ",";
                //        }

                //    });
                //}

         
                var mesgType = "";
                var sList = "";
                $('input[name="chk[]"]').each(function () {
                    if (this.checked) {
                        sList += $(this).attr('class') + ",";
                    }

                });
                if (sList == '') {
                    alert("first select message before deleting ");
                }
                else {
                    //alert(sList);
                    //ajax call start for deleting inbox grid
                    ShowLoader();
                    try {
                        var requestData = {
                            DeletedMessageIDs: sList,
                            FacilityId: $.trim($('#cmbAppointmentFacility  option:selected').val()),
                            ProviderId_To: $.trim($('#cmbAppointmentDoctor  option:selected').val()),
                            MessageTypeId: $.trim($('#cmbMessageType  option:selected').val()),
                            MessageUrgencyId: $.trim($('#cmbMessageUrgency  option:selected').val()),
                            MessageType: mesgType

                        };

                        $.ajax({
                            type: 'POST',
                            url: 'inboxs-delete',
                            data: JSON.stringify(requestData),
                            dataType: 'json',
                            contentType: 'application/json; charset=utf-8',
                            success: function (data) {
                                // if success
                                // alert("Success : " + data);


                                //if (mesgType == "SentDeleteMessage") {
                                //    $("#MessageSentHeaderGrid").html(data);
                                //    $("#tbl-MessageSent").fixedHeaderTable();
                                //}
                           
                                // $("#MessageHeaderGrid").html(data);
                                $('#tabs-1 div:first').html(data.html);

                                $("#detail-inbox-request").html("");
                                $("#tbl-messageInbox").fixedHeaderTable();
                                $('#tabs-6 div:first').html(data.htmldelete);

                                $("#tbl-MessageDelete").fixedHeaderTable();

                           
                                HideLoader();

                            },
                            error: function (xhr, ajaxOptions, thrownError) {
                                //if error
                                var myCookie = getCookie(".Patient");

                                if (myCookie == null) {
                                    // do cookie doesn't exist stuff;
                                    alert('Not logged in. Please log in to continue');
                                    window.location = '/Login'
                                    //xhr.getResponseHeader('Location');
                                }
                                else {

                                    alert('Error : ' + xhr.message);
                                }
                                HideLoader();
                            },
                            complete: function (data) {
                                // if completed
                                HideLoader();

                            },
                            async: true,
                            processData: false
                        });

                    } catch (err) {

                        if (err && err !== "") {
                            alert(err.message);
                            HideLoader();
                        }
                    }


                    //ajax call end for deleting inbox 


                }
            }

            function deleteSentRecord()
            {


       
                var mesgType = "SentDeleteMessage";
                var sList = "";
                if (mesgType == "SentDeleteMessage") {
                 //   alert('Sent');
                    $('input[name="chkS[]"]').each(function () {
                        if (this.checked) {
                            sList += $(this).attr('class') + ",";
                        }

                    });
                }
        

                if (sList == '') {
                    alert("first select message before deleting ");
                }
                else {
                    //alert(sList);
                    //ajax call start for deleting inbox grid
                    ShowLoader();
                    try {
                        var requestData = {
                            DeletedMessageIDs: sList,
                            FacilityId: $.trim($('#cmbAppointmentFacility  option:selected').val()),
                            ProviderId_To: $.trim($('#cmbAppointmentDoctor  option:selected').val()),
                            MessageTypeId: $.trim($('#cmbMessageType  option:selected').val()),
                            MessageUrgencyId: $.trim($('#cmbMessageUrgency  option:selected').val()),
                            MessageType: mesgType

                        };

                        $.ajax({
                            type: 'POST',
                            url: 'inboxs-delete',
                            data: JSON.stringify(requestData),
                            dataType: 'json',
                            contentType: 'application/json; charset=utf-8',
                            success: function (data) {
                                // if success
                                // alert("Success : " + data);


                               
                                    $("#MessageSentHeaderGrid").html(data);
                                    $("#tbl-MessageSent").fixedHeaderTable();
                                
                           
                                //  $("#MessageHeaderGrid").html(data);
                                //  $("#tbl-messageInbox").fixedHeaderTable();
                           
                                HideLoader();

                            },
                            error: function (xhr, ajaxOptions, thrownError) {
                                //if error
                                var myCookie = getCookie(".Patient");

                                if (myCookie == null) {
                                    // do cookie doesn't exist stuff;
                                    alert('Not logged in. Please log in to continue');
                                    window.location = '/Login'
                                    //xhr.getResponseHeader('Location');
                                }
                                else {

                                    alert('Error : ' + xhr.message);
                                }
                                HideLoader();
                            },
                            complete: function (data) {
                                // if completed
                                HideLoader();

                            },
                            async: true,
                            processData: false
                        });

                    } catch (err) {

                        if (err && err !== "") {
                            alert(err.message);
                            HideLoader();
                        }
                    }


                    //ajax call end for deleting inbox 


                }
            }
            //$(".DeleteMessage123").click(function (e) {
            //    e.preventDefault();
            //    var par = $(e.target).parent();
            //    alert(e.target.id);
            //    var mesgType=e.target.id;
            //    var sList = "";
            //    if (e.target.id == "SentDeleteMessage") {
            //        alert('Sent');
            //        $('input[name="chkS[]"]').each(function () {
            //            if (this.checked) {
            //                sList += $(this).attr('class') + ",";
            //            }
                
            //        });
            //    }
            //    else {
            //        alert('Inbox');
            //    $('input[name="chk[]"]').each(function () {
            //        if (this.checked) {
            //            sList += $(this).attr('class') + ",";
            //        }

            //    });
            //    }
            
            //    if (sList == '') {
            //        alert("first select message before deleting ");
            //    }
            //    else {
            //        //alert(sList);
            //        //ajax call start for deleting inbox grid
            //        ShowLoader();
            //        try {
            //            var requestData = {
            //                DeletedMessageIDs: sList,
            //             FacilityId: $.trim($('#cmbAppointmentFacility  option:selected').val()),
            //             ProviderId_To: $.trim($('#cmbAppointmentDoctor  option:selected').val()),
            //             MessageTypeId: $.trim($('#cmbMessageType  option:selected').val()),
            //             MessageUrgencyId: $.trim($('#cmbMessageUrgency  option:selected').val()),
            //             MessageType: mesgType

            //         };

            //            $.ajax({
            //                type: 'POST',
            //                url: 'inboxs-delete',
            //                data: JSON.stringify(requestData),
            //                dataType: 'json',
            //                contentType: 'application/json; charset=utf-8',
            //                success: function (data) {
            //                    // if success
            //                    // alert("Success : " + data);
                          
                            
            //                    if (mesgType == "SentDeleteMessage") {
            //                        $("#MessageSentHeaderGrid").html(data);
            //                        $("#tbl-MessageSent").fixedHeaderTable();
            //                    }
            //                    else {
            //                    $("#MessageHeaderGrid").html(data);
            //                        $("#tbl-messageInbox").fixedHeaderTable();
            //                    }

            //                    HideLoader();

            //                },
            //                error: function (xhr, ajaxOptions, thrownError) {
            //                    //if error

            //                    alert('Error : ' + xhr.message);
            //                    HideLoader();
            //                },
            //                complete: function (data) {
            //                    // if completed
            //                    HideLoader();

            //                },
            //                async: true,
            //                processData: false
            //            });

            //        } catch (err) {

            //            if (err && err !== "") {
            //                alert(err.message);
            //                HideLoader();
            //            }
            //        }


            //        //ajax call end for deleting inbox 


            //    }





            //}



            function CancelApp()
            {
                var sList = "";
                $('input[name="chk3[]"]').each(function () {
                    if (this.checked) {
                        sList += $(this).attr('class') + ",";
                    }

                });
                if (sList == '') {
                    alert("first select message before deleting ");
                }
                else {
                    //alert(sList);
                    //ajax call start for deleting inbox grid
                    ShowLoader();
                    try {

                        var requestData = {
                            DeletedMessageIDs: sList


                        };

                        $.ajax({
                            type: 'POST',
                            url: 'Appointment-Cancel',
                            data: JSON.stringify(requestData),
                            dataType: 'json',
                            contentType: 'application/json; charset=utf-8',
                            success: function (data) {
                                // if success
                                // alert("Success : " + data);
                                $('#tabs-2 div:first').html(data.html1);
                               
                                $("#detail-Appointment-Request").html("");
                                AppintmentDetailGrid
                                $('#tbl-MessageAppointment').fixedHeaderTable();

                                HideLoader();

                            },
                            error: function (xhr, ajaxOptions, thrownError) {
                                //if error
                                var myCookie = getCookie(".Patient");

                                if (myCookie == null) {
                                    // do cookie doesn't exist stuff;
                                    alert('Not logged in. Please log in to continue');
                                    window.location = '/Login'
                                    //xhr.getResponseHeader('Location');
                                }
                                else {

                                    alert('Error : ' + xhr.message);
                                }
                                HideLoader();
                            },
                            complete: function (data) {
                                // if completed
                                HideLoader();

                            },
                            async: true,
                            processData: false
                        });

                    } catch (err) {

                        if (err && err !== "") {
                            alert(err.message);
                            HideLoader();
                        }
                    }


                    //ajax call end for deleting inbox 


                }
            }

            //$("#btnCancel").click(function (e) {
            //    e.preventDefault();
            //    var sList = "";
            //    $('input[name="chk3[]"]').each(function () {
            //        if (this.checked) {
            //            sList += $(this).attr('class') + ",";
            //        }

            //    });
            //    if (sList == '') {
            //        alert("first select message before deleting ");
            //    }
            //    else {
            //        //alert(sList);
            //        //ajax call start for deleting inbox grid
            //        ShowLoader();
            //        try {
                    
            //            var requestData = {
            //                DeletedMessageIDs: sList
                        
                       
            //            };

            //            $.ajax({
            //                type: 'POST',
            //                url: 'Appointment-Cancel',
            //                data: JSON.stringify(requestData),
            //                dataType: 'json',
            //                contentType: 'application/json; charset=utf-8',
            //                success: function (data) {
            //                    // if success
            //                    // alert("Success : " + data);
            //                    $('#tabs-4 div:first').html(data);
            //                    $('#tbl-MessageAppointment').fixedHeaderTable();

            //                    HideLoader();

            //                },
            //                error: function (xhr, ajaxOptions, thrownError) {
            //                    //if error

            //                    alert('Error : ' + xhr.message);
            //                    HideLoader();
            //                },
            //                complete: function (data) {
            //                    // if completed
            //                    HideLoader();

            //                },
            //                async: true,
            //                processData: false
            //            });

            //        } catch (err) {

            //            if (err && err !== "") {
            //                alert(err.message);
            //                HideLoader();
            //            }
            //        }


            //        //ajax call end for deleting inbox 


            //    }





            //}



      //     );


            function OpenPharmacyDialoge() {
                //$("#PharmAddress").html("");
                $("#txtPhone").val(""); clearPharmacyDialog();
              //  alert("hi");
                $("#dialog-pharmacy").dialog("open");
            }
         
            function clearPharmacyDialog() {
                $('#txtPharmID').val('');
                $('#txtPharmacyName').val('');
                $('#txtPharmAddress1').val('');
                $('#txtPharmAddress2').val('');
                $('#txtPharmCity').val('');
                //  $('#txtPharmState').val('');
                $('#txtPharmZipCode').val('');
                $('#chkPref').prop('checked', false);
                $('#txtPhone').val('');
                $('#txtWebsite').val('');
            }
       </script>


@Scripts.Render("~/MsgIndex/jquery")