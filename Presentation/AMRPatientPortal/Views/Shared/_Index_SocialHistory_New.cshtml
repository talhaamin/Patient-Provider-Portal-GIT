@model AMR.Models.HomeViewModel
@using System.Web.Script.Serialization;
<div id="socialhistwidg" class="portlet ui-widget ui-widget-content ui-helper-clearfix ui-corner-all">
            <div class="portlet-header ui-widget-header ui-corner-all">
               <span id="SocailMove" class="anc_home" onclick="social_move(true);">   Social History </span>
                 @*<div onclick="socialhistwidg(); " onmousemove="removing_class();" onmouseover="removing_class(); " onmousedown="removing_class1();" onclick="removing_class1(); " onmouseout="removing_class1();" onmouseup="removing_class1();" onfocus="removing_class1();" style="cursor: pointer; float: right; width: auto; height: 20px;">
                    <img src="Content/img/hide.png" />
                    <span class="anc" style="padding-right: 2px;">Hide</span>
                </div>*@
                <span id="App-SocialHistory">
                    @if(AMR.Core.Utilities.RequestHelper.MyGlobalVar.PremiumFlag == true)
                    {
                <div id="App-ShareHideSocialHistory" style="cursor: pointer; float: right; width: auto; height: 20px;" onclick='@((Model.PatientShare.SocialHistory) ? "ShareHide_Socialhistory(false)" : "ShareHide_Socialhistory(true)")';>
                <span class="anc" style="padding-right: 2px; font-weight: normal;" ><img src='@((Model.PatientShare.SocialHistory)? "Content/img/share.png" : "Content/img/share.png" )'/>  @((Model.PatientShare.SocialHistory) ? "UnShare" : "Share") </span>
                     </div> 
                    }
                    </span> 
                <!-- third ICON -->
                @*<div id="createaddsocial" onclick="clearFields();" onmousemove="removing_class();" onmouseover="removing_class(); " onmousedown="removing_class();" onclick="removing_class(); " onmouseout="removing_class();" onmouseup="removing_class();" onfocus="removing_class();" style="cursor: pointer; float: right; width: auto; height: 20px;">
                    <img src="Content/img/add.png" />
                    <span class="anc" style="padding-right: 10px;">Add</span>
                </div>*@
                <!-- end of third icon-->

                <!-- end of icons -->

            </div>
            <div id="social-portlet" class="portlet-content disabled" style="height: 190px; overflow-x: auto;">
                <table class="box-table-a" id="tbl-SocialHistory" summary="SocialHistory">
                    <thead>
                        <tr>
                            <th scope="col" style="vertical-align:middle"><span style="margin-left:2px;">Description</span></th>                            
                            <th scope="col" style="vertical-align:middle">Start Date</th>
                            <th scope="col" style="vertical-align:middle">End Date</th>
                            
                        </tr>
                    </thead>
                    <tbody>
                        @if (Model.SocialHistories != null && Model.SocialHistories.Count() > 0)
                        {
                            int counter = 0;
                            foreach (var item in Model.SocialHistories)
                            {
                                var jsonStr = new JavaScriptSerializer().Serialize(item);
                                <tr class="@((counter % 2 == 0) ? "r1" : "r0")" onclick="OpenSocialHistRecord(@item.PatSocialHistCntr);">


                                    <td style="vertical-align:middle"><input type="hidden" id="hdSocialHist@(item.PatSocialHistCntr)" value="@jsonStr" />@item.Description</td>
                                    @{
                                            DateTime dtBDate;
                                            if (item.BeginDate.Length == 8 && DateTime.TryParseExact(item.BeginDate, "yyyyMMdd", System.Globalization.CultureInfo.InvariantCulture, System.Globalization.DateTimeStyles.None, out dtBDate))
                                            {
                                                DateTime dtOcc = DateTime.ParseExact(item.BeginDate, "yyyyMMdd", null);
                                                string s = dtOcc.ToString("MM/dd/yyyy");

                                                <td style="vertical-align:middle">@s</td>
                                            }
                                            else if ((item.BeginDate).Trim().Length == 6)
                                            {
                                                string strYear = item.BeginDate.Substring(0, 4);
                                                string strMonth = item.BeginDate.Substring(4, 2);
                                                string strBDate = strMonth + "/" + strYear;
                                                <td style="vertical-align:middle">@strBDate</td>
                                            }
                                            else
                                            {
                                                <td style="vertical-align:middle">@item.BeginDate</td>
                                            }      
                                          }
                                         
                                         @{
                                            DateTime dtEDate;
                                            if (item.EndDate.Length == 8 && DateTime.TryParseExact(item.EndDate, "yyyyMMdd", System.Globalization.CultureInfo.InvariantCulture, System.Globalization.DateTimeStyles.None, out dtEDate))
                                                {
                                                    DateTime dtEndDate = DateTime.ParseExact(item.EndDate, "yyyyMMdd", null);
                                                    string s = dtEndDate.ToString("MM/dd/yyyy");

                                                    <td style="vertical-align:middle">@s</td>
                                                }
                                                else if ((item.EndDate).Trim().Length == 6)
                                                {
                                                    string strYear = item.EndDate.Substring(0, 4);
                                                    string strMonth = item.EndDate.Substring(4, 2);
                                                    string strEDate = strMonth + "/" + strYear;
                                                    <td style="vertical-align:middle">@strEDate</td>
                                                }
                                                else
                                                {
                                                    <td style="vertical-align:middle">@item.EndDate</td>
                                                }
                            
                                                   
                                         }
                                         
                                </tr>
                            
                                counter++;
                            }
                        }
                        else
                        {
                             <tr>
                                <td style="vertical-align:middle" width="200px;">No Information Available.</td>
                            </tr>
                        }
                    </tbody>
                </table>
               
            </div>
        </div>